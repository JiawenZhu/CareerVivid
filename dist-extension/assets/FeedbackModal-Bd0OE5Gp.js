import{u as w,r as a,j as e,L as N,v as S,m as E,f as C,g as L}from"./main-BEc7sVU2.js";import{X as F}from"./x-CgpMcjbW.js";import{C as z}from"./check-circle-DqYJ7obf.js";import{S as T}from"./star-D73ZxPTB.js";const P=({isOpen:s,onClose:n,onSubmitted:m,onCancel:i,source:h,context:k})=>{const{currentUser:l}=w(),[d,u]=a.useState(0),[x,f]=a.useState(""),[o,c]=a.useState(!1),[p,b]=a.useState(!1),[y,r]=a.useState("");a.useEffect(()=>{s&&(u(0),f(""),c(!1),b(!1),r(""))},[s]),a.useEffect(()=>{if(!s)return;const t=v=>{v.key==="Escape"&&g()};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[s,i,n]);const j=async()=>{if(d===0){r("Please select a rating before sending.");return}if(!l){r("You must be logged in to send feedback.");return}r(""),c(!0);try{await S(E(C,"feedback"),{userId:l.uid,userEmail:l.email||"N/A",rating:d,comment:x,createdAt:L(),status:"New",source:h,context:k}),b(!0),m&&m(),setTimeout(()=>{n()},2500)}catch(t){console.error("Error saving feedback:",t),r("Sorry, something went wrong. Please try again later.")}finally{c(!1)}},g=()=>{i&&i(),n()};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md shadow-xl relative",children:[e.jsx("button",{onClick:g,className:"absolute top-3 right-3 p-1 rounded-full text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(F,{size:20})}),p?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(z,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Thank you!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Your feedback helps us improve."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-bold mb-2 text-gray-900 dark:text-white",children:"How was your experience?"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Your feedback is valuable to us."}),e.jsx("div",{className:"flex justify-center items-center gap-2 mb-4",children:[1,2,3,4,5].map(t=>e.jsx("button",{onClick:()=>u(t),className:"focus:outline-none",children:e.jsx(T,{size:36,className:`transition-colors ${t<=d?"text-yellow-400 fill-yellow-400":"text-gray-300 dark:text-gray-600"}`})},t))}),e.jsx("textarea",{value:x,onChange:t=>f(t.target.value),placeholder:"Tell us more about your experience (optional)...",rows:4,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary-500 focus:outline-none"}),y&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:y}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:g,disabled:o,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 font-semibold text-sm",children:"Cancel"}),e.jsxs("button",{onClick:j,disabled:o,className:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/50 dark:text-indigo-300 font-semibold py-2 px-4 rounded-lg hover:bg-indigo-200 dark:hover:bg-indigo-900/80 transition-colors flex items-center gap-2 disabled:opacity-50",children:[o&&e.jsx(N,{size:16,className:"animate-spin"}),o?"Sending...":"Send Feedback"]})]})]})]})}):null};export{P as F};
