import{u as w,r as s,n as i,g as c,q as m,A as E,v as T,x as J,h as d,f as b,B as D,D as C,o as S,G as R}from"./main-D7bwdUQx.js";const x=()=>{const{currentUser:r}=w(),[f,u]=s.useState([]),[h,n]=s.useState(!0);s.useEffect(()=>{if(!r){u([]),n(!1);return}n(!0);const t=i(c,"users",r.uid,"jobTracker"),e=m(t,E("updatedAt","desc")),o=T(e,a=>{const y=a.docs.map(l=>{const p=l.data();return{id:l.id,...p,section:p.section||"jobTracker"}});u(y),n(!1)},a=>{console.error("Error fetching job applications:",a),n(!1)});return()=>o()},[r]);const k=s.useCallback(async t=>{if(!r)throw new Error("User not logged in");try{return(await J(i(c,"users",r.uid,"jobTracker"),{...t,userId:r.uid,section:"jobTracker",createdAt:d(),updatedAt:d()})).id}catch(e){throw console.error("Error adding job application:",e),e}},[r]),j=s.useCallback(async(t,e)=>{if(r)try{const o=JSON.parse(JSON.stringify(e));delete o.id;const a=b(c,"users",r.uid,"jobTracker",t);await D(a,{...o,updatedAt:d()})}catch(o){console.error("Error updating job application:",o)}},[r]),A=s.useCallback(async t=>{if(r)try{const e=b(c,"users",r.uid,"jobTracker",t);await C(e)}catch(e){console.error("Error deleting job application:",e)}},[r]),g=s.useCallback(async()=>{if(r)try{const t=i(c,"users",r.uid,"jobTracker"),e=await S(t);if(e.empty)return;const o=R(c);e.docs.forEach(a=>{o.delete(a.ref)}),await o.commit()}catch(t){throw console.error("Error deleting all job applications:",t),t}},[r]);return{jobApplications:f,isLoading:h,addJobApplication:k,updateJobApplication:j,deleteJobApplication:A,deleteAllJobApplications:g}};export{x as u};
