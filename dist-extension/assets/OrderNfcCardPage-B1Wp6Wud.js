import{u as Q,r as i,j as e,o as k,R as D,L as I,H as U,I as E}from"./main-BEc7sVU2.js";import{u as M}from"./storageService-DclJIdxx.js";import{u as B}from"./useTranslation-CNH1DPc_.js";import{A as G}from"./arrow-left-jQ4_17tq.js";import{X as H}from"./x-CgpMcjbW.js";import{U as W}from"./upload-ph_HrLW-.js";import{I as _}from"./info-D00vMt1z.js";const ee=()=>{const{t:z}=B(),{currentUser:h}=Q(),[b,p]=i.useState(!1),[r,j]=i.useState("custom"),[n,y]=i.useState("black"),[o,C]=i.useState(1),[N,S]=i.useState(""),[c,m]=i.useState(null),[w,x]=i.useState(null),u=i.useRef(null),[a,g]=i.useState({matchLogo:!1,includeQR:!0,metalSurface:!1,iosAppClip:!1}),d={custom:{id:"price_1So67jRJNflGxv32TKsC7AbX",price:12.9,label:"Custom"},standard:{id:"price_1So6AtRJNflGxv32qHMPnhwz",price:9.89,label:"Standard"}},f=.5,$=()=>{let s=d[r].price;return a.metalSurface&&(s+=f),(s*o).toFixed(2)},R=s=>{if(s.target.files&&s.target.files[0]){const t=s.target.files[0];if(t.size>5*1024*1024){alert("File is too large. Please upload an image under 5MB.");return}m(t);const l=new FileReader;l.onloadend=()=>{x(l.result)},l.readAsDataURL(t)}},A=s=>{if(s.preventDefault(),s.dataTransfer.files&&s.dataTransfer.files[0]){const t=s.dataTransfer.files[0];if(t.type.startsWith("image/")){if(t.size>5*1024*1024){alert("File is too large. Please upload an image under 5MB.");return}m(t);const l=new FileReader;l.onloadend=()=>{x(l.result)},l.readAsDataURL(t)}}},L=s=>{s.stopPropagation(),m(null),x(null),u.current&&(u.current.value="")},P=async()=>{if(!h){k("/signin?redirect=/order-nfc-card");return}if(r==="custom"&&!c){alert("Please upload a logo for your custom card.");return}p(!0);try{let s="";if(r==="custom"&&c){const F=Date.now(),T=`orders/${h.uid}/${F}_${c.name}`;try{s=await M(c,T)}catch(O){console.error("Logo upload failed:",O),alert("Failed to upload logo image. Please try again."),p(!1);return}}const l=await U(E,"createCheckoutSession")({priceId:d[r].id,quantity:o,successUrl:`${window.location.origin}/#/order-nfc-card?success=true`,cancelUrl:`${window.location.origin}/#/order-nfc-card`,metadata:{type:r,color:n,location:N,includeQR:a.includeQR?"yes":"no",metalSurface:a.metalSurface?"yes":"no",matchLogo:a.matchLogo?"yes":"no",iosAppClip:a.iosAppClip?"yes":"no",logoUrl:s,userId:h.uid}});l.data.url?window.location.href=l.data.url:(console.error("No URL returned from checkout session creation"),alert("Something went wrong initiating checkout. Please try again."))}catch(s){console.error("Checkout error:",s),alert("Failed to start checkout. Please try again.")}finally{p(!1)}},v=[{number:1,label:"Design",active:!0},{number:2,label:"Shipping",active:!1},{number:3,label:"Confirmation",active:!1},{number:4,label:"Tap Tag Actions",active:!1}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>k("/business-card"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{children:"Back to Business Card"})]}),e.jsx("div",{className:"font-semibold text-gray-900",children:"Order NFC Card"}),e.jsx("div",{className:"w-24"})," "]})}),e.jsxs("div",{className:"max-w-6xl mx-auto py-12 px-6 md:px-12",children:[e.jsx("div",{className:"flex items-center justify-center gap-4 mb-12 overflow-x-auto pb-4",children:v.map((s,t)=>e.jsxs(D.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ${s.active?"bg-indigo-600 text-white":"bg-gray-200 text-gray-500"}`,children:s.number}),e.jsx("span",{className:`text-sm font-medium ${s.active?"text-indigo-600":"text-gray-400"}`,children:s.label})]}),t<v.length-1&&e.jsx("div",{className:"w-16 h-px bg-gray-300 min-w-[40px]"})]},s.number))}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Select Your Tap Tags"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>j("custom"),className:`p-6 rounded-xl border-2 text-left transition-all ${r==="custom"?"border-indigo-600 bg-indigo-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsx("div",{className:"w-16 h-16 bg-gray-900 rounded-full mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"LOGO"})}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Custom"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",d.custom.price.toFixed(2)," ea."]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"A custom, 4-inch tap tag with your logo, and an optional QR code that ships in 5-7 weeks."})]}),e.jsxs("button",{onClick:()=>{j("standard"),m(null),x(null)},className:`p-6 rounded-xl border-2 text-left transition-all relative ${r==="standard"?"border-indigo-600 bg-indigo-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsx("span",{className:"absolute top-4 right-4 px-2 py-1 bg-indigo-600 text-white text-xs font-semibold rounded-full",children:"Ships Fast"}),e.jsx("div",{className:"w-16 h-16 bg-gray-400 rounded-full mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"TAP"})}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Standard"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",d.standard.price.toFixed(2)," ea."]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"An unbranded, 3-inch tap tag that ships in 3-5 business days."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Color"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>y("black"),className:`px-4 py-2 rounded-lg border-2 flex items-center gap-2 ${n==="black"?"border-indigo-600 bg-indigo-50":"border-gray-200"}`,children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-gray-900"}),e.jsx("span",{className:"text-sm font-medium",children:"Black"})]}),e.jsxs("button",{onClick:()=>y("white"),className:`px-4 py-2 rounded-lg border-2 flex items-center gap-2 ${n==="white"?"border-indigo-600 bg-indigo-50":"border-gray-200"}`,children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-white border border-gray-300"}),e.jsx("span",{className:"text-sm font-medium",children:"White"})]})]})]}),r==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Logo"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-indigo-400 transition-colors cursor-pointer bg-white",onClick:()=>u.current?.click(),onDragOver:s=>s.preventDefault(),onDrop:A,children:[e.jsx("input",{type:"file",ref:u,onChange:R,accept:"image/png,image/jpeg,image/svg+xml",className:"hidden"}),w?e.jsxs("div",{className:"relative inline-block",onClick:s=>s.stopPropagation(),children:[e.jsx("img",{src:w,alt:"Logo Preview",className:"h-32 object-contain mx-auto"}),e.jsx("button",{onClick:L,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-sm text-indigo-600 mt-2 font-medium",children:c?.name})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-8 h-8 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-600",children:"Drop a PNG logo here or click to upload"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"We recommend a black or white PNG logo with a transparent background."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>g(s=>({...s,matchLogo:!s.matchLogo})),className:`w-12 h-6 rounded-full relative transition-colors flex-shrink-0 ${a.matchLogo?"bg-indigo-600":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${a.matchLogo?"left-7":"left-1"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Match logo to tap tag color"}),e.jsx("p",{className:"text-sm text-gray-500",children:"We'll try to automatically match your logo to the tap tag color."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>g(s=>({...s,includeQR:!s.includeQR})),className:`w-12 h-6 rounded-full relative transition-colors flex-shrink-0 ${a.includeQR?"bg-indigo-600":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${a.includeQR?"left-7":"left-1"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Include QR code"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Adds a custom QR code to the tap tag that people can scan in addition to tapping."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>g(s=>({...s,metalSurface:!s.metalSurface})),className:`w-12 h-6 rounded-full relative transition-colors flex-shrink-0 ${a.metalSurface?"bg-indigo-600":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${a.metalSurface?"left-7":"left-1"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Works with metal surfaces"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Allows your tap tags to work when attached to metal. Adds $",f.toFixed(2)," per tag."]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>g(s=>({...s,iosAppClip:!s.iosAppClip})),className:`w-12 h-6 rounded-full relative transition-colors flex-shrink-0 ${a.iosAppClip?"bg-indigo-600":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${a.iosAppClip?"left-7":"left-1"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Enable app clip iOS experience"}),e.jsx("p",{className:"text-sm text-gray-500",children:"iPhone users receive a branded app clip pop-up."})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"How Many Tap Tags Do You Need?"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Order one batch or create multiple batches for different locations."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Install location *"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",value:N,onChange:s=>S(s.target.value),placeholder:"e.g., Office Lobby",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity *"}),e.jsx("input",{type:"number",min:1,value:o,onChange:s=>C(Math.max(1,parseInt(s.target.value)||1)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white border border-gray-200 rounded-xl shadow-sm",children:[e.jsx(_,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You will customize the tap tag action after you complete your order."})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-8 space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-4",children:"Preview"}),e.jsx("div",{className:`w-32 h-32 mx-auto rounded-full flex items-center justify-center shadow-xl transition-all ${n==="black"?"bg-gray-900":"bg-white border-8 border-gray-100"}`,children:e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:`text-xs font-bold leading-tight ${n==="black"?"text-white":"text-gray-900"}`,children:["TAP",e.jsx("br",{}),"YOUR",e.jsx("br",{}),"PHONE",e.jsx("br",{}),"HERE"]})})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500",children:[r==="custom"?"Custom":"Standard"," Tags"]}),e.jsxs("span",{className:"font-medium",children:["$",d[r].price.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Quantity"}),e.jsx("span",{className:"font-medium",children:o})]}),a.metalSurface&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Metal Surface Add-on"}),e.jsxs("span",{className:"font-medium",children:["+$",(f*o).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Sales Tax"}),e.jsx("span",{className:"font-medium",children:"$0.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Shipping"}),e.jsx("span",{className:"font-medium text-green-600",children:"Free"})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["$",$()]})]})]}),e.jsx("button",{onClick:P,disabled:b,className:"w-full mt-6 px-6 py-4 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):"Next"})]})]})})]})]})]})};export{ee as default};
