import{r as t,m as D,q as O,z as B,p as U,f as T,j as e,L as F,H as Ne,I as Se,e as R,B as $,u as re,g as te,v as Q,C as le}from"./main-BEc7sVU2.js";import{A as pe}from"./AlertModal-DHZrFFpO.js";import{C as Ce}from"./chevron-up-DzRpdu-v.js";import{C as Ee}from"./chevron-down-Eiq7K4ut.js";import{X as ue}from"./x-CgpMcjbW.js";import{A as Z,a as ge}from"./AIImprovementPanel-DpI3U-fW.js";import Te from"./AIImageEditModal-C20ok1Se.js";import{d as Ae,u as Pe}from"./storageService-DclJIdxx.js";import{W as ee}from"./wand-2-BNdNGVzL.js";import{I as Ie}from"./image-DpFBMrjV.js";import{U as _e}from"./upload-cloud-Bz-Uhqq1.js";import{B as Le,C as Me}from"./code-DFGvkwP7.js";import{T as H}from"./trash-2-9UIW2m7q.js";import{L as Fe}from"./link-fr0uO6pY.js";import{C as De}from"./check-BXDTBbZe.js";import{P as Re}from"./pen-CDP9jQDD.js";import{U as Ue}from"./unlink-BN-ijyOT.js";import{E as de}from"./external-link-B-pRlJeA.js";import{P as ze}from"./plus-BybH-_bu.js";import{E as Oe}from"./eye-DBT7NYFb.js";import{P as Be,a as We}from"./pen-tool-CPcodvGT.js";import{S as $e}from"./star-D73ZxPTB.js";import{S as Ge}from"./send-BU04lBHk.js";import{U as ce}from"./users-CW7lwuWe.js";import{U as he}from"./user-z_w8hJb6.js";import{C as ye}from"./check-circle-DqYJ7obf.js";import{A as be}from"./alert-circle-gw7bsKwP.js";import{S as fe}from"./save-DuHFw_gZ.js";import{F as je}from"./file-text-D4qk8Tzm.js";import{M as oe}from"./mail-C8AWi2yh.js";import{G as Ve}from"./graduation-cap-CWgYxLce.js";import{B as qe}from"./building-2-BttomyIW.js";import{s as He,D as Ye,u as Je}from"./systemSettingsService-D8eZe6-g.js";import{S as Ke}from"./shield-DouoAU4I.js";import{B as Xe}from"./bar-chart-DqtOAY8p.js";import{M as Qe}from"./message-square-Rf8MUyuS.js";import{A as Ze}from"./alert-triangle-BabHdlci.js";import"./index-Bgwdp8d1.js";import"./geminiService-BsYmV8kM.js";import"./sparkles-Br3FZYhV.js";import"./upload-ph_HrLW-.js";import"./download-BBBdX7JV.js";const ve=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0);return t.useEffect(()=>{const a=D(T,"users"),l=O(a,B("createdAt","desc")),m=U(l,o=>{const x=o.docs.map(f=>({...f.data(),uid:f.id}));y(x),h(!1)},o=>{console.error("Error fetching users:",o),h(!1)});return()=>m()},[]),{users:i,loading:b,setUsers:y}},we=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0);return t.useEffect(()=>{const a=D(T,"usage_logs"),l=O(a,B("timestamp","desc")),m=U(l,o=>{const x=o.docs.map(f=>({...f.data(),id:f.id}));y(x),h(!1)},o=>{console.error("Error fetching usage logs:",o),h(!1)});return()=>m()},[]),{logs:i,loading:b}},X=875e-8,z=875e-9,et=.0013,tt=4e-4,ie={resume_parse_text:{perToken:X},resume_parse_file:{perToken:X},resume_generate_prompt:{perToken:X},interview_analysis:{perToken:X,perSecond:tt},resume_suggestion:{perToken:z},ai_assistant_query:{perToken:z},question_generation:{perToken:z},job_parse_description:{perToken:z},job_prep_generation:{perToken:z},job_prep_regeneration:{perToken:z},portfolio_generation:{perToken:z},portfolio_refinement:{perToken:z},image_generation:{perEvent:et},sign_in:{},sign_out:{},interview_start:{},resume_download:{},checkout_session_start:{}},Y=({currentPage:i,totalPages:y,onPageChange:b})=>{if(y<=1)return null;const h=()=>{const a=[];if(y<=7)for(let l=1;l<=y;l++)a.push(l);else{a.push(1),i>3&&a.push("...");const l=Math.max(2,i-1),m=Math.min(y-1,i+1);for(let o=l;o<=m;o++)a.push(o);i<y-2&&a.push("..."),a.push(y)}return a};return e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-6",children:[h().map((a,l)=>typeof a=="number"?e.jsx("button",{onClick:()=>b(a),className:`w-8 h-8 flex items-center justify-center rounded-full text-sm font-medium transition-colors ${i===a?"bg-[#6d4c85] text-white shadow-md":"border border-gray-600/30 text-gray-400 hover:text-white hover:border-gray-400"}`,children:a},l):e.jsx("span",{className:"text-gray-500 w-8 text-center",children:"..."},l)),e.jsx("button",{disabled:i===y,onClick:()=>b(i+1),className:"px-6 py-1.5 rounded-full border border-gray-600/30 text-sm font-medium text-gray-300 hover:text-white hover:border-gray-400 disabled:opacity-30 disabled:cursor-not-allowed ml-4 transition-colors",children:"Next >"})]})},rt=({logs:i,users:y,loading:b})=>{const[h,a]=t.useState(""),[l,m]=t.useState("createdAt"),[o,x]=t.useState("desc"),[f,j]=t.useState({isOpen:!1,title:"",message:""}),{userTokenStats:r,userCostStats:n}=t.useMemo(()=>{const g={},s={};return i.forEach(p=>{if(!p.userId)return;g[p.userId]||(g[p.userId]={total:0,byCategory:{}}),s[p.userId]||(s[p.userId]={total:0,byCategory:{}});const N=typeof p.tokenUsage=="number"?p.tokenUsage:0;g[p.userId].total+=N;const A=p.eventType;g[p.userId].byCategory[A]=(g[p.userId].byCategory[A]||0)+N;const L=ie[A];let M=0;L&&(L.perToken&&N>0&&(M+=N*L.perToken),L.perEvent&&(M+=L.perEvent),L.perSecond&&typeof p.durationInSeconds=="number"&&p.durationInSeconds>0&&(M+=p.durationInSeconds*L.perSecond)),s[p.userId].total+=M,s[p.userId].byCategory[A]=(s[p.userId].byCategory[A]||0)+M}),{userTokenStats:g,userCostStats:s}},[i]),d=async(g,s)=>{const p=R(T,"users",g);await $(p,s)},w=t.useMemo(()=>y.filter(s=>(s.email||"").toLowerCase().includes(h.toLowerCase())).sort((s,p)=>{let N,A;switch(l){case"email":N=(s.email||"").toLowerCase(),A=(p.email||"").toLowerCase();break;case"createdAt":N=s.createdAt?.toMillis()||0,A=p.createdAt?.toMillis()||0;break;case"tokens":N=r[s.uid]?.total||0,A=r[p.uid]?.total||0;break;case"cost":N=n[s.uid]?.total||0,A=n[p.uid]?.total||0;break;default:return 0}return N<A?o==="asc"?-1:1:N>A?o==="asc"?1:-1:0}),[y,h,l,o,r,n]),S=g=>{l===g?x(s=>s==="asc"?"desc":"asc"):(m(g),x("desc"))},c=({column:g})=>l!==g?null:o==="asc"?e.jsx(Ce,{size:14}):e.jsx(Ee,{size:14}),[k,C]=t.useState(1),v=10;t.useEffect(()=>{C(1)},[h,l,o]);const P=t.useMemo(()=>{const g=(k-1)*v;return w.slice(g,g+v)},[w,k]),[u,E]=t.useState({isOpen:!1,user:null}),[_]=t.useState([1,3,6,8,12,"Custom"]),[I,G]=t.useState(12),[V,J]=t.useState(12),se=g=>{G(12),J(12),E({isOpen:!0,user:g})},ae=async()=>{if(!u.user)return;const g=I==="Custom"?V:I;if(typeof g!="number"||g<=0){alert("Please enter a valid duration in months.");return}try{await Ne(Se,"grantAcademicPartnerRole")({targetUserId:u.user.uid,durationInMonths:g}),alert(`Success! ${u.user.email} is now an Academic Partner for ${g} months.`),d(u.user.uid,{role:"academic_partner"}),E({isOpen:!1,user:null})}catch(s){alert("Error: "+s.message)}},K=Math.ceil(w.length/v);return b?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(F,{className:"animate-spin w-8 h-8"})}):e.jsxs("div",{children:[u.isOpen&&u.user&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Promote to Academic Partner"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:["Select the duration of Premium access for ",e.jsx("strong",{children:u.user.email}),"."]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Duration (Months)"}),e.jsx("select",{value:I,onChange:g=>{const s=g.target.value;G(s==="Custom"?"Custom":Number(s))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500 mb-3",children:_.map(g=>e.jsx("option",{value:g,children:g==="Custom"?"Custom":`${g} Months`},g))}),I==="Custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Enter Months (Number)"}),e.jsx("input",{type:"number",min:"1",value:V,onChange:g=>J(Number(g.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>E({isOpen:!1,user:null}),className:"px-4 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:"Cancel"}),e.jsx("button",{onClick:ae,className:"px-4 py-2 text-sm text-white bg-primary-600 hover:bg-primary-700 rounded-md font-medium",children:"Confirm Promotion"})]})]})}),e.jsx(pe,{isOpen:f.isOpen,onClose:()=>j({...f,isOpen:!1}),title:f.title,message:f.message}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by user email...",value:h,onChange:g=>a(g.target.value),className:"w-full max-w-md px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"})}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{onClick:()=>S("email"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2",children:["User ",e.jsx(c,{column:"email"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Promotions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expires At"}),e.jsx("th",{onClick:()=>S("createdAt"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2",children:["Registered At ",e.jsx(c,{column:"createdAt"})]})}),e.jsx("th",{onClick:()=>S("tokens"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2",children:["Total Tokens ",e.jsx(c,{column:"tokens"})]})}),e.jsx("th",{onClick:()=>S("cost"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2",children:["Total Cost ",e.jsx(c,{column:"cost"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usage Breakdown"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:P.map(g=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:g.email}),e.jsx("div",{className:"text-sm text-gray-500",children:g.uid})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:g.status,onChange:s=>d(g.uid,{status:s.target.value}),className:`p-1 rounded text-xs ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:!!g.promotions?.isPremium,onChange:s=>{const p=s.target.checked,N={promotions:{...g.promotions,isPremium:p}};p?(N.expiresAt=null,N.plan="pro_monthly",N.stripeSubscriptionStatus="active",N.subscriptionStatus="active"):(N.expiresAt=null,N.plan="free",N.stripeSubscriptionStatus="canceled",N.subscriptionStatus="canceled"),d(g.uid,N)},className:"h-4 w-4 text-primary-600 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2",children:"Premium"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(()=>{const s=Date.now(),p=g.expiresAt?.toMillis?g.expiresAt.toMillis():null;if(!p)return g.promotions?.isPremium?e.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"Permanent"}):e.jsx("span",{className:"text-gray-400",children:"-"});const N=p<s,L=new Date(p).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:N?"text-red-600 dark:text-red-400 font-medium":"text-blue-600 dark:text-blue-400 font-medium",children:L}),N&&e.jsx("span",{className:"text-xs text-red-500",children:"Expired"}),!N&&e.jsxs("span",{className:"text-xs text-gray-500",children:[Math.ceil((p-s)/(1e3*60*60*24))," days left"]})]})})()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:g.createdAt?.toDate().toLocaleString()||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-white",children:r[g.uid]?.total.toLocaleString()||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-600 dark:text-green-400",children:["$",n[g.uid]?.total.toFixed(4)||"0.0000"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-xs",children:e.jsx("div",{className:"flex flex-wrap gap-1 max-w-xs",children:r[g.uid]&&Object.entries(r[g.uid].byCategory).sort(([,s],[,p])=>p-s).map(([s,p])=>e.jsxs("span",{className:"inline-block bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200 text-xs font-semibold px-2 py-0.5 rounded-full",children:[s,": ",s==="image_generation"?p:p.toLocaleString(),n[g.uid]?.byCategory[s]&&e.jsxs("span",{className:"text-green-700 dark:text-green-400",children:[" (~$",n[g.uid].byCategory[s].toFixed(4),")"]})]},s))})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{className:"text-red-600 hover:text-red-900 mr-4",onClick:()=>j({isOpen:!0,title:"Action Required",message:"User deletion must be handled via Firebase Console or backend functions for security."}),children:"Delete"}),!g.role||g.role==="user"?e.jsx("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>se(g),children:"Promote to Partner"}):e.jsx("span",{className:"text-xs font-semibold bg-purple-100 text-purple-800 px-2 py-1 rounded",children:g.role==="academic_partner"?"Partner":g.role})]})]},g.uid))})]})}),e.jsx(Y,{currentPage:k,totalPages:K,onPageChange:C})]})},st=()=>{const{logs:i,loading:y}=we(),[b,h]=t.useState(null),[a,l]=t.useState(!0);t.useEffect(()=>{const j=R(T,"analytics","demo_page_events"),r=U(j,n=>{n.exists()?h(n.data()):h({totalResumeGenerations:0,totalInterviewStarts:0,convertedResumeUsers:0,convertedInterviewUsers:0}),l(!1)},n=>{console.error("Error fetching demo stats:",n),l(!1)});return()=>r()},[]);const m=t.useMemo(()=>{if(!i.length)return{totalEvents:0,totalCost:0,sortedByType:[]};const j={};let r=0;i.forEach(d=>{const w=d.eventType;if(!ie[w])return;j[w]||(j[w]={count:0,tokens:0,cost:0}),j[w].count++;const S=typeof d.tokenUsage=="number"?d.tokenUsage:0;j[w].tokens+=S;const c=ie[w];let k=0;c?.perToken&&S>0&&(k+=S*c.perToken),c?.perEvent&&(k+=c.perEvent),c?.perSecond&&typeof d.durationInSeconds=="number"&&d.durationInSeconds>0&&(k+=d.durationInSeconds*c.perSecond),j[w].cost+=k,r+=k});const n=Object.entries(j).sort(([,d],[,w])=>w.cost-d.cost);return{totalEvents:i.length,totalCost:r,sortedByType:n}},[i]),o=b?.convertedResumeUsers||0,x=b?.totalResumeGenerations||0;b?.convertedInterviewUsers,b?.totalInterviewStarts;const f=x>0?o/x*100:0;return y||a?e.jsx(F,{className:"animate-spin"}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Total Events Logged"}),e.jsx("p",{className:"text-4xl font-extrabold text-primary-500",children:m.totalEvents.toLocaleString()})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg shadow border border-yellow-300 dark:border-yellow-700",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 text-yellow-800 dark:text-yellow-200",children:"Total Estimated Cost"}),e.jsxs("p",{className:"text-4xl font-extrabold text-yellow-600 dark:text-yellow-400",children:["$",m.totalCost.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Demo Users (Signed Up - Resume)"}),e.jsx("p",{className:"text-4xl font-extrabold text-indigo-500",children:o.toLocaleString()})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Total Demo Resume Generations"}),e.jsx("p",{className:"text-4xl font-extrabold text-indigo-500/70",children:x.toLocaleString()})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg shadow border border-green-300 dark:border-green-700",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 text-green-800 dark:text-green-200",children:"Demo Resume Conversion Rate"}),e.jsxs("p",{className:"text-4xl font-extrabold text-green-600 dark:text-green-400",children:[f.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Usage & Cost by Category"}),e.jsx("div",{className:"overflow-y-auto max-h-[40rem]",children:e.jsx("ul",{className:"text-sm space-y-1",children:m.sortedByType.map(([j,r])=>e.jsxs("li",{className:"grid grid-cols-3 items-center p-2 rounded hover:bg-gray-50 dark:hover:bg-gray-900/50",children:[e.jsx("span",{className:"font-semibold col-span-1",children:j}),e.jsxs("div",{className:"text-right text-gray-500 col-span-1",children:[r.count.toLocaleString()," events",r.tokens>0&&` / ${r.tokens.toLocaleString()} tokens`]}),e.jsxs("strong",{className:"text-right text-green-600 dark:text-green-400 col-span-1",children:["$",r.cost.toFixed(4)]})]},j))})})]})]})},at=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0),[a,l]=t.useState(null),[m,o]=t.useState(1),x=20,f=t.useMemo(()=>{const n=(m-1)*x;return i.slice(n,n+x)},[i,m]),j=Math.ceil(i.length/x);t.useEffect(()=>{const n=D(T,"contact_messages"),d=O(n,B("timestamp","desc")),w=U(d,S=>{const c=S.docs.map(k=>({id:k.id,...k.data()}));y(c),h(!1)},S=>{console.error("Error fetching messages:",S),h(!1)});return()=>w()},[]);const r=async n=>{const d=n.status==="read"?"unread":"read";await $(R(T,"contact_messages",n.id),{status:d})};return b?e.jsx(F,{className:"animate-spin mx-auto"}):e.jsxs("div",{children:[a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-xl shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.subject}),e.jsx("button",{onClick:()=>l(null),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(ue,{size:20})})]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-4 flex justify-between",children:[e.jsxs("span",{children:["From: ",a.name," (",a.email,")"]}),e.jsx("span",{children:a.timestamp?.toDate().toLocaleString()})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg text-gray-700 dark:text-gray-300 whitespace-pre-wrap mb-6",children:a.message}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>{r(a),l(null)},className:"px-4 py-2 bg-primary-600 text-white rounded-md font-medium text-sm",children:["Mark as ",a.status==="read"?"Unread":"Read"," & Close"]})})]})}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"From"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:f.map(n=>e.jsxs("tr",{className:n.status==="unread"?"bg-blue-50/50 dark:bg-blue-900/10":"",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.status==="unread"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:n.status})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:[n.name,e.jsx("br",{}),e.jsx("span",{className:"text-gray-500 font-normal",children:n.email})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300 max-w-xs truncate",children:n.subject}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.timestamp?.toDate().toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>l(n),className:"text-primary-600 hover:text-primary-900 mr-4",children:"View"})})]},n.id))})]})}),e.jsx(Y,{currentPage:m,totalPages:j,onPageChange:o})]})},ne=({title:i,children:y})=>e.jsxs("div",{className:"mb-8 p-6 bg-white dark:bg-gray-800/50 dark:border dark:border-gray-700 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2",children:i}),y]}),nt=({link:i,onUpdate:y,onUnlink:b,onRemove:h})=>{const[a,l]=t.useState(!1),[m,o]=t.useState(i.text),[x,f]=t.useState(i.url);t.useEffect(()=>{a||(o(i.text),f(i.url))},[i,a]);const j=()=>{y(m,x),l(!1)},r=()=>{o(i.text),f(i.url),l(!1)};return e.jsx("div",{className:"p-3 mb-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 shadow-sm",children:a?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Text"}),e.jsx("input",{className:"w-full p-1 text-sm border rounded dark:bg-gray-600 dark:border-gray-500",value:m,onChange:n=>o(n.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"URL"}),e.jsx("input",{className:"w-full p-1 text-sm border rounded dark:bg-gray-600 dark:border-gray-500",value:x,onChange:n=>f(n.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{onClick:r,className:"p-1 text-gray-500 hover:text-gray-700",children:e.jsx(ue,{size:14})}),e.jsx("button",{onClick:j,className:"p-1 text-green-500 hover:text-green-700",children:e.jsx(De,{size:14})})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-bold text-sm text-primary-600 dark:text-primary-400 truncate pr-2",title:i.text,children:i.text}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx("button",{onClick:()=>l(!0),className:"p-1 text-gray-400 hover:text-blue-500",title:"Edit",children:e.jsx(Re,{size:12})}),e.jsx("button",{onClick:b,className:"p-1 text-gray-400 hover:text-orange-500",title:"Unlink",children:e.jsx(Ue,{size:12})}),e.jsx("button",{onClick:h,className:"p-1 text-gray-400 hover:text-red-500",title:"Delete",children:e.jsx(H,{size:12})})]})]}),e.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 hover:underline truncate",children:[e.jsx(de,{size:10})," ",i.url]})]})})},ot=({content:i,onUpdateContent:y})=>{const b=t.useMemo(()=>{const m=/\[([^\]]+)\]\(([^)]+)\)/g,o=[];let x;for(;(x=m.exec(i))!==null;)o.push({index:x.index,fullMatch:x[0],text:x[1],url:x[2]});return o},[i]),h=(m,o,x)=>{const f=b[m],j=i.substring(0,f.index),r=i.substring(f.index+f.fullMatch.length);y(`${j}[${o}](${x})${r}`)},a=m=>{const o=b[m],x=i.substring(0,o.index),f=i.substring(o.index+o.fullMatch.length);y(`${x}${o.text}${f}`)},l=m=>{const o=b[m],x=i.substring(0,o.index),f=i.substring(o.index+o.fullMatch.length);y(`${x}${f}`)};return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border-l dark:border-gray-700 h-full flex flex-col",children:[e.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:e.jsxs("h3",{className:"font-bold text-sm uppercase tracking-wider text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(Fe,{size:16})," Link Inspector ",e.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full px-2 py-0.5 text-xs",children:b.length})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:b.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center italic mt-4",children:"No links found in content."}):b.map((m,o)=>e.jsx(nt,{link:m,onUpdate:(x,f)=>h(o,x,f),onUnlink:()=>a(o),onRemove:()=>l(o)},`${m.index}-${m.text}`))})]})},it=({post:i,onSave:y,onCancel:b})=>{const{currentUser:h}=re(),[a,l]=t.useState({title:"",category:"Career Advice",excerpt:"",content:"",coverImage:"",author:"CareerVivid Team"}),[m,o]=t.useState(null),[x,f]=t.useState(!1),[j,r]=t.useState({isOpen:!1,title:"",message:""}),[n,d]=t.useState(null),[w,S]=t.useState(!1),c=t.useRef(null);t.useEffect(()=>{i&&l(i)},[i]);const k=u=>{const E=u.target.files?.[0];if(!E)return;const _=new FileReader;_.onload=I=>{o(I.target?.result)},_.readAsDataURL(E)},C=async()=>{if(!a.title||!a.content){r({isOpen:!0,title:"Validation Error",message:"Title and Content are required."});return}f(!0);try{let u=a.coverImage;if(m&&h){const _=Ae(m);if(!_)throw new Error("Failed to process image.");const I=`public/blog_assets/blog_${Date.now()}_cover.png`;u=await Pe(_,I)}const E={...a,coverImage:u,updatedAt:te()};i?await $(R(T,"blog_posts",i.id),E):await Q(D(T,"blog_posts"),{...E,publishedAt:te()}),y()}catch(u){console.error("Error saving post:",u),r({isOpen:!0,title:"Save Failed",message:u.message})}finally{f(!1)}},v=u=>d(n===u?null:u),P=m||a.coverImage;return e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 min-h-screen pb-20",children:[e.jsx(pe,{isOpen:j.isOpen,title:j.title,message:j.message,onClose:()=>r({isOpen:!1,title:"",message:""})}),w&&P&&h&&e.jsx(Te,{userId:h.uid,currentPhoto:P,onClose:()=>S(!1),onSave:u=>{l({...a,coverImage:u}),o(null)},onUseTemp:u=>o(u),onError:(u,E)=>r({isOpen:!0,title:u,message:E}),savePath:`public/blog_assets/blog_${Date.now()}_edited.png`,promptOptions:["Modern tech workspace","Minimalist document layout","Professional writing desk","Bright office environment","Abstract career concept art","Soft lighting and clean background"]}),e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:i?"Edit Blog Post":"New Blog Post"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-md font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{onClick:C,disabled:x,className:"px-4 py-2 bg-primary-600 text-white rounded-md font-medium hover:bg-primary-700 flex items-center gap-2",children:[x&&e.jsx(F,{className:"animate-spin",size:18}),"Save & Publish"]})]})]}),e.jsx(ne,{title:"Post Details",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Title"}),e.jsx("input",{className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent",value:a.title,onChange:u=>l({...a,title:u.target.value})}),e.jsxs("button",{onClick:()=>v("title"),className:"mt-2 flex items-center gap-2 text-xs font-semibold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300",children:[e.jsx(ee,{size:14})," Improve Title with AI"]}),n==="title"&&h&&e.jsx(Z,{userId:h.uid,sectionName:"Blog Title",currentText:a.title||"",language:"English",onAccept:u=>{l({...a,title:u}),d(null)},onClose:()=>d(null),onError:(u,E)=>r({isOpen:!0,title:u,message:E}),contextType:"blog post"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Category"}),e.jsxs("select",{className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent",value:a.category,onChange:u=>l({...a,category:u.target.value}),children:[e.jsx("option",{children:"Career Advice"}),e.jsx("option",{children:"Resume Tips"}),e.jsx("option",{children:"Interview Prep"}),e.jsx("option",{children:"Tech Trends"}),e.jsx("option",{children:"Job Search Strategies"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Excerpt (Short Summary)"}),e.jsx("textarea",{className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,value:a.excerpt,onChange:u=>l({...a,excerpt:u.target.value})}),e.jsxs("button",{onClick:()=>v("excerpt"),className:"mt-2 flex items-center gap-2 text-xs font-semibold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300",children:[e.jsx(ee,{size:14})," Improve Excerpt with AI"]}),n==="excerpt"&&h&&e.jsx(Z,{userId:h.uid,sectionName:"Blog Excerpt",currentText:a.excerpt||"",language:"English",onAccept:u=>{l({...a,excerpt:u}),d(null)},onClose:()=>d(null),onError:(u,E)=>r({isOpen:!0,title:u,message:E}),contextType:"blog post"})]})]})}),e.jsx(ne,{title:"Media",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start gap-6",children:[e.jsx("div",{className:"w-full md:w-64 aspect-video bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden flex items-center justify-center border border-gray-300 dark:border-gray-600",children:P?e.jsx("img",{src:P,alt:"Cover",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-gray-400 flex flex-col items-center",children:[e.jsx(Ie,{size:32}),e.jsx("span",{className:"text-xs mt-2",children:"No Image"})]})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Cover Image"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:c,onChange:k}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>c.current?.click(),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center gap-2 text-sm font-medium",children:[e.jsx(_e,{size:16})," ",P?"Change Image":"Upload Image"]}),P&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300 rounded-md hover:bg-indigo-100 dark:hover:bg-indigo-900/40 flex items-center gap-2 text-sm font-medium",children:[e.jsx(Le,{size:16})," Edit with AI"]}),e.jsxs("button",{onClick:()=>{l({...a,coverImage:""}),o(null)},className:"px-4 py-2 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 rounded-md hover:bg-red-100 dark:hover:bg-red-900/40 flex items-center gap-2 text-sm font-medium",children:[e.jsx(H,{size:16})," Remove"]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Recommended size: 1200√ó630px. Supported formats: JPG, PNG."})]})]})}),e.jsx(ne,{title:"Content",children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Post Body (Markdown Supported)"}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-6 items-start",children:[e.jsxs("div",{className:"flex-grow w-full",children:[e.jsx(ge,{required:!0,className:"w-full p-4 border rounded-md dark:bg-gray-700 dark:border-gray-600 font-mono text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent shadow-sm",value:a.content||"",onChange:u=>l({...a,content:u.target.value}),placeholder:"# Introduction...",minHeight:500,maxHeight:800}),e.jsxs("button",{type:"button",onClick:()=>v("content"),className:"mt-3 flex items-center gap-2 text-sm font-semibold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors",children:[e.jsx(ee,{size:16})," Improve Content with AI"]}),n==="content"&&h&&e.jsx(Z,{userId:h.uid,sectionName:"Blog Content",currentText:a.content||"",language:"English",onAccept:u=>{l({...a,content:u}),d(null)},onClose:()=>d(null),onError:(u,E)=>r({isOpen:!0,title:u,message:E}),contextType:"blog post"})]}),e.jsx("div",{className:"w-full xl:w-80 flex-shrink-0 xl:sticky xl:top-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm",children:e.jsx(ot,{content:a.content||"",onUpdateContent:u=>l({...a,content:u})})})]})]})})]})]})},lt=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0),[a,l]=t.useState(void 0),[m,o]=t.useState(!1),[x,f]=t.useState(""),[j,r]=t.useState(""),[n,d]=t.useState(1),w=10;t.useEffect(()=>{const v=D(T,"blog_posts"),P=O(v,B("publishedAt","desc")),u=U(P,E=>{const _=E.docs.map(I=>({id:I.id,...I.data()}));y(_),h(!1)});return()=>u()},[]),t.useEffect(()=>{d(1)},[x,j]);const S=t.useMemo(()=>i.filter(v=>{const P=(v.title||"").toLowerCase().includes(x.toLowerCase());let u=!0;return j&&(u=v.publishedAt?.toDate().toISOString().split("T")[0]===j),P&&u}),[i,x,j]),c=t.useMemo(()=>{const v=(n-1)*w;return S.slice(v,v+w)},[S,n]),k=Math.ceil(S.length/w),C=async v=>{window.confirm("Delete this post?")&&await le(R(T,"blog_posts",v))};return m?e.jsx(it,{post:a,onSave:()=>o(!1),onCancel:()=>o(!1)}):b?e.jsx(F,{className:"animate-spin mx-auto"}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex gap-4 w-full md:w-auto",children:[e.jsx("input",{type:"text",placeholder:"Search by title...",value:x,onChange:v=>f(v.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 w-full md:w-64"}),e.jsx("input",{type:"date",value:j,onChange:v=>r(v.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"}),j&&e.jsx("button",{onClick:()=>r(""),className:"text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"Clear Date"})]}),e.jsxs("button",{onClick:()=>{l(void 0),o(!0)},className:"flex items-center gap-2 bg-primary-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-primary-700 whitespace-nowrap",children:[e.jsx(ze,{size:20})," New Post"]})]}),e.jsx("div",{className:"space-y-4",children:c.map(v=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow border border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:v.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[v.category," ‚Ä¢ ",v.publishedAt?.toDate().toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`#/blog/${v.id}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-500 hover:text-blue-600 transition-colors",title:"View Live Post",children:e.jsx(Oe,{size:18})}),e.jsx("button",{onClick:()=>{l(v),o(!0)},className:"p-2 text-gray-500 hover:text-primary-600",title:"Edit",children:e.jsx(Be,{size:18})}),e.jsx("button",{onClick:()=>C(v.id),className:"p-2 text-gray-500 hover:text-red-600",title:"Delete",children:e.jsx(H,{size:18})})]})]},v.id))}),e.jsx(Y,{currentPage:n,totalPages:k,onPageChange:d})]})},dt=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0),[a,l]=t.useState(""),[m,o]=t.useState("all"),[x,f]=t.useState(1),j=15;t.useEffect(()=>{const c=D(T,"feedback"),k=O(c,B("createdAt","desc")),C=U(k,v=>{const P=v.docs.map(u=>({...u.data(),id:u.id}));y(P),h(!1)},v=>{console.error("Error fetching feedback:",v),h(!1)});return()=>C()},[]),t.useEffect(()=>{f(1)},[a,m]);const r=t.useMemo(()=>i.filter(c=>{const k=(c.userEmail||"").toLowerCase().includes(a.toLowerCase()),C=m==="all"||c.rating===m;return k&&C}),[i,a,m]),n=t.useMemo(()=>{const c=(x-1)*j;return r.slice(c,c+j)},[r,x]),d=Math.ceil(r.length/j),w=async(c,k)=>{const C=R(T,"feedback",c);await $(C,{status:k})};if(b)return e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(F,{className:"animate-spin w-8 h-8"})});const S={New:"bg-blue-100 text-blue-800","In Progress":"bg-yellow-100 text-yellow-800",Resolved:"bg-green-100 text-green-800",Archived:"bg-gray-100 text-gray-800"};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by user email...",value:a,onChange:c=>l(c.target.value),className:"w-full max-w-md px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"}),e.jsxs("select",{value:m,onChange:c=>o(c.target.value==="all"?"all":Number(c.target.value)),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"All Ratings"}),e.jsx("option",{value:"5",children:"5 Stars"}),e.jsx("option",{value:"4",children:"4 Stars"}),e.jsx("option",{value:"3",children:"3 Stars"}),e.jsx("option",{value:"2",children:"2 Stars"}),e.jsx("option",{value:"1",children:"1 Star"})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comment"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:n.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:c.userEmail}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((k,C)=>e.jsx($e,{size:16,className:C<c.rating?"text-yellow-400 fill-yellow-400":"text-gray-300"},C))})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400 max-w-sm truncate",title:c.comment,children:c.comment||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:c.createdAt?.toDate().toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:c.status,onChange:k=>w(c.id,k.target.value),className:`p-1 rounded text-xs border-transparent focus:ring-2 focus:ring-primary-500 ${S[c.status]||"bg-gray-100"}`,children:[e.jsx("option",{value:"New",children:"New"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Archived",children:"Archived"})]})})]},c.id))})]})}),e.jsx(Y,{currentPage:x,totalPages:d,onPageChange:f})]})},ct=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0),[a,l]=t.useState(null),[m,o]=t.useState(""),[x,f]=t.useState(1),j=20;t.useEffect(()=>{const c=D(T,"error_reports"),k=O(c,B("timestamp","desc")),C=U(k,v=>{const P=v.docs.map(u=>({...u.data(),id:u.id}));y(P),h(!1)},v=>{console.error("Error fetching errors:",v),h(!1)});return()=>C()},[]),t.useEffect(()=>{f(1)},[m]);const r=t.useMemo(()=>i.filter(c=>{const k=m.toLowerCase(),C=(c.userEmail||"").toLowerCase().includes(k),v=(c.message||"").toLowerCase().includes(k);return C||v}),[i,m]),n=t.useMemo(()=>{const c=(x-1)*j;return r.slice(c,c+j)},[r,x]),d=Math.ceil(r.length/j),w=async(c,k)=>{const C=R(T,"error_reports",c);await $(C,{status:k})};if(b)return e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(F,{className:"animate-spin w-8 h-8"})});const S={New:"bg-red-100 text-red-800",Acknowledged:"bg-yellow-100 text-yellow-800",Resolved:"bg-green-100 text-green-800"};return e.jsxs("div",{children:[a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900 dark:text-white",children:"Error Details"}),e.jsxs("div",{className:"text-sm space-y-2 mb-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Message:"})," ",a.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:"User:"})," ",a.userEmail]}),e.jsxs("p",{children:[e.jsx("strong",{children:"URL:"})," ",a.url]})]}),e.jsx("h4",{className:"font-semibold mb-2",children:"Stack Trace:"}),e.jsx("pre",{className:"bg-gray-100 dark:bg-gray-900 p-3 rounded-md text-xs overflow-auto max-h-60",children:e.jsx("code",{children:a.stack||"No stack trace available."})}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>l(null),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 font-semibold text-sm",children:"Close"})})]})}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by user or error message...",value:m,onChange:c=>o(c.target.value),className:"w-full max-w-md px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"})}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Error"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"URL"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:n.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:c.userEmail||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-red-600 dark:text-red-400 max-w-md truncate",children:e.jsx("button",{onClick:()=>l(c),className:"hover:underline",children:c.message})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 max-w-xs truncate",children:c.url}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:c.timestamp?.toDate().toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:c.status,onChange:k=>w(c.id,k.target.value),className:`p-1 rounded text-xs border-transparent focus:ring-2 focus:ring-primary-500 ${S[c.status]||"bg-gray-100"}`,children:[e.jsx("option",{value:"New",children:"New"}),e.jsx("option",{value:"Acknowledged",children:"Acknowledged"}),e.jsx("option",{value:"Resolved",children:"Resolved"})]})})]},c.id))})]})}),e.jsx(Y,{currentPage:x,totalPages:d,onPageChange:f})]})},xe=[{id:"welcome_premium",name:"Welcome to Premium",subject:"Welcome to CareerVivid Premium! üöÄ",html:`<h2>Welcome to Premium!</h2>
<p>Hi there,</p>
<p>Thank you for upgrading to CareerVivid Premium. We are thrilled to have you on board!</p>
<p>You now have access to:</p>
<ul>
    <li>300 AI Credits per Month</li>
    <li>Unlimited Interview Practice</li>
    <li>Personalized Portfolio Website</li>
</ul>
<p>If you have any questions, feel free to reply to this email.</p>
<br>
<p>Best regards,</p>
<p>The CareerVivid Team</p>`},{id:"welcome_partner",name:"Welcome to Academic Partner Portal",subject:"Welcome to the Academic Partner Program! üéì",html:`<h2>Welcome, Partner!</h2>
<p>Dear Professor,</p>
<p>We are delighted to welcome you to the <strong>CareerVivid Academic Partner Program</strong>.</p>
<p>As a partner, you now have access to our exclusive portal where you can:</p>
<ul>
    <li>Monitor student progress</li>
    <li>Distribute premium access codes</li>
    <li>Access educational resources</li>
</ul>
<p>Your dedicated dashboard is ready for you to explore:</p><p><a href="https://careervivid.app/academic-partner" style="display:inline-block; padding:10px 20px; background-color:#4CAF50; color:white; text-decoration:none; border-radius:5px; font-weight:bold;">Launch Partner Portal</a></p><p>Thank you for your commitment to fostering the next generation of successful professionals.</p><p>Sincerely,</p><p>The CareerVivid Team</p>`},{id:"account_warning",name:"Account Warning",subject:"Action Required: Notice regarding your account",html:`<h2>Account Notice</h2>
<p>Hello,</p>
<p>We noticed some unusual activity on your account that violates our terms of service.</p>
<p>Please review our community guidelines. Continued violations may result in account suspension.</p>
<p>If you believe this is a mistake, please contact us immediately.</p>
<br>
<p>Best,</p>
<p>CareerVivid Security Team</p>`},{id:"feature_announcement",name:"New Feature Announcement",subject:"Introducing: AI Mock Interviews ü§ñ",html:`<h2>New Feature Alert!</h2>
<p>Hi,</p>
<p>We are excited to announce our newest feature: <strong>AI Mock Interviews</strong>.</p>
<p>You can now practice real-time conversations with our AI interviewer to prepare for your dream job.</p>
<p><a href="https://careervivid.app/interview">Try it now</a></p>
<br>
<p>Happy hunting!</p>
<p>CareerVivid Product Team</p>`},{id:"payment_failed",name:"Payment Failed (Manual)",subject:"Action Required: Payment Failed",html:`<h2>Payment Failed</h2>
<p>Hello,</p>
<p>We attempted to process your subscription renewal but the payment failed.</p>
<p>Please update your payment method to avoid service interruption.</p>
<p><a href="https://careervivid.app/subscription">Update Payment Method</a></p>
<br>
<p>Thank you,</p>
<p>CareerVivid Billing</p>`},{id:"generic_notification",name:"Generic Notification",subject:"Important Update from CareerVivid",html:`<p>Hello,</p>
<p>[Your message here]</p>
<br>
<p>Best regards,</p>
<p>The CareerVivid Team</p>`},{id:"welcome_business_general",name:"Welcome Business Partner (General)",subject:"Welcome to CareerVivid Business Partner Program! ü§ù",html:`
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin:0; padding:0; font-family: 'Arial Black', Arial, sans-serif; background-color:#FFE951;">
    <table width="100%" cellpadding="0" cellspacing="0" style="background-color:#FFE951; padding:40px 20px;">
        <tr>
            <td align="center">
                <table width="600" cellpadding="0" cellspacing="0" style="background-color:#000000; border:6px solid #000000; box-shadow: 12px 12px 0 rgba(0,0,0,1);">
                    <!-- Neo-Brutalist Header -->
                    <tr>
                        <td style="background-color:#FF6B6B; padding:40px 30px; text-align:center; border-bottom:6px solid #000000;">
                            <h1 style="color:#000000; margin:0; font-size:36px; font-weight:900; text-transform:uppercase; letter-spacing:2px;">WELCOME!</h1>
                            <p style="color:#000000; margin:10px 0 0 0; font-size:18px; font-weight:700;">Business Partner Program</p>
                        </td>
                    </tr>
                    
                    <!-- Main Content -->
                    <tr>
                        <td style="padding:40px 30px; background-color:#FFFFFF;">
                            <div style="background-color:#00D9FF; padding:20px; border:4px solid #000000; box-shadow: 6px 6px 0 rgba(0,0,0,1); margin-bottom:30px;">
                                <h2 style="color:#000000; font-size:24px; margin:0; font-weight:900; text-transform:uppercase;">CONGRATS!</h2>
                            </div>
                            
                            <p style="color:#000000; font-size:16px; line-height:1.6; margin:0 0 20px 0; font-weight:600;">
                                You're now part of the <strong style="background-color:#FFE951; padding:2px 6px;">CareerVivid Business Partner Program</strong>. Let's connect you with top talent! üöÄ
                            </p>
                            
                            <!-- Credentials Box - Neo-Brutalist Style -->
                            <div style="background-color:#B4F8C8; border:5px solid #000000; padding:24px; box-shadow: 8px 8px 0 rgba(0,0,0,1); margin:30px 0;">
                                <h3 style="color:#000000; font-size:20px; margin:0 0 20px 0; font-weight:900; text-transform:uppercase;">üîë LOGIN INFO</h3>
                                
                                <div style="background-color:#FFFFFF; border:3px solid #000000; padding:16px; margin-bottom:12px;">
                                    <strong style="color:#000000; font-size:12px; text-transform:uppercase; letter-spacing:1px; font-weight:900;">EMAIL:</strong>
                                    <p style="margin:8px 0 0 0; color:#000000; font-size:16px; font-weight:700; font-family:monospace;">[USER_EMAIL]</p>
                                </div>
                                
                                <div style="background-color:#FFFFFF; border:3px solid #000000; padding:16px;">
                                    <strong style="color:#000000; font-size:12px; text-transform:uppercase; letter-spacing:1px; font-weight:900;">PASSWORD:</strong>
                                    <p style="margin:8px 0 0 0; color:#000000; font-size:16px; font-family:monospace; font-weight:900;">careervivid123456</p>
                                </div>
                                
                                <div style="background-color:#FF6B6B; border:3px solid #000000; padding:12px; margin-top:16px;">
                                    <p style="color:#000000; font-size:13px; margin:0; font-weight:700;">
                                        ‚ö†Ô∏è CHANGE PASSWORD AFTER FIRST LOGIN!
                                    </p>
                                </div>
                            </div>
                            
                            <!-- Features List -->
                            <div style="background-color:#FFE951; border:4px solid #000000; padding:24px; box-shadow: 6px 6px 0 rgba(0,0,0,1); margin:30px 0;">
                                <h3 style="color:#000000; font-size:20px; margin:0 0 16px 0; font-weight:900; text-transform:uppercase;">WHAT YOU GET:</h3>
                                <ul style="color:#000000; font-size:15px; line-height:1.8; margin:0; padding-left:20px; font-weight:700;">
                                    <li>Post job opportunities</li>
                                    <li>Access talent pool</li>
                                    <li>Track applications</li>
                                    <li>Build employer brand</li>
                                    <li>Priority support</li>
                                </ul>
                            </div>
                            
                            <!-- CTA Button -->
                            <table width="100%" cellpadding="0" cellspacing="0" style="margin:30px 0;">
                                <tr>
                                    <td align="center">
                                        <a href="https://careervivid.app/business-partner/dashboard" style="display:inline-block; background-color:#00D9FF; color:#000000; text-decoration:none; padding:18px 40px; border:5px solid #000000; font-weight:900; font-size:18px; text-transform:uppercase; box-shadow: 6px 6px 0 rgba(0,0,0,1); letter-spacing:1px;">
                                            START NOW ‚Üí
                                        </a>
                                    </td>
                                </tr>
                            </table>
                            
                            <p style="color:#000000; font-size:15px; line-height:1.6; margin:30px 0 20px 0; font-weight:600;">
                                Need help? Just reply to this email. Our team is ready! üí™
                            </p>
                            
                            <p style="color:#000000; font-size:15px; line-height:1.6; margin:0; font-weight:600;">
                                Let's build the future together!
                            </p>
                        </td>
                    </tr>
                    
                    <!-- Footer -->
                    <tr>
                        <td style="background-color:#000000; padding:30px; text-align:center;">
                            <p style="color:#FFE951; font-size:16px; margin:0 0 12px 0; font-weight:900; text-transform:uppercase;">CareerVivid Team</p>
                            <p style="color:#FFFFFF; font-size:13px; margin:0; font-weight:700;">
                                <a href="https://careervivid.app/contact" style="color:#00D9FF; text-decoration:none; font-weight:900;">HELP CENTER</a>
                            </p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>`},{id:"welcome_business_hiring",name:"Welcome Business (Hiring Focus)",subject:"Let's find your next great hire! üöÄ",html:`<h2>Welcome to CareerVivid Hiring!</h2>
<p>Hello,</p>
<p>Thank you for joining us! We are excited to help you streamline your campus recruiting and find the best candidates for your open roles.</p>
<p>To get started, please share the job descriptions for the roles you are actively hiring for.</p>
<p>Our team will use our AI matching technology to shortlist the top candidates from our user base.</p>
<br>
<p>We look forward to helping you build your dream team.</p>
<p>Best,</p>
<p>CareerVivid Talent Solutions</p>`},{id:"welcome_business_branding",name:"Welcome Business (Branding/Events)",subject:"Boosting your Employer Brand with CareerVivid ‚ú®",html:`<h2>Welcome!</h2>
<p>Hello,</p>
<p>We are excited to partner with you on building a strong employer brand on campus.</p>
<p>Whether it's hosting a virtual hackathon, a resume workshop, or a webinar, we are here to support your initiatives.</p>
<p>Let's schedule a brainstorming session to plan your first event.</p>
<br>
<p>Cheers,</p>
<p>The CareerVivid Events Team</p>`},{id:"welcome_student_ambassador",name:"Welcome Student Ambassador",subject:"You're in! Welcome to the Ambassador Program üåü",html:`<h2>Welcome Aboard!</h2>
<p>Hi there,</p>
<p>Congratulations! You have been selected as a <strong>CareerVivid Student Ambassador</strong>.</p>
<p>We were impressed by your application and your passion for helping peers succeed.</p>
<p><strong>Your Next Steps:</strong></p>
<ol>
    <li>Join our exclusive Discord community (Link coming soon)</li>
    <li>Review the Ambassador Handbook attached</li>
    <li>Share your unique referral code: [CODE]</li>
</ol>
<p>Your dedicated dashboard is ready for you to explore:</p><p><a href="https://careervivid.app/partners/students" style="display:inline-block; padding:10px 20px; background-color:#4CAF50; color:white; text-decoration:none; border-radius:5px; font-weight:bold;">Launch Ambassador Portal</a></p><p>Thank you for your commitment to fostering the next generation of successful professionals.</p><p>Sincerely,</p><p>The CareerVivid Community Manager</p>`},{id:"welcome_student_club",name:"Welcome Student (Club Leader)",subject:"Partnership Confirmation for Your Club üöÄ",html:`<h2>Hello Club Leader!</h2>
<p>Hi,</p>
<p>We are excited to partner with your student organization!</p>
<p>As an official partner club, you now have access to:</p>
<ul>
    <li>Free Premium memberships for your executive board</li>
    <li>Exclusive workshop materials</li>
    <li>Sponsorship for your upcoming events</li>
</ul>
<p>Please reply with a list of your board members' emails so we can upgrade their accounts.</p>
<br>
<p>Keep up the great work!</p>
<p>The CareerVivid Team</p>`},{id:"generic_notification",name:"Generic Notification",subject:"Important Update from CareerVivid",html:`<p>Hello,</p>
<p>[Your message here]</p>
<br>
<p>Best regards,</p>
<p>The CareerVivid Team</p>`}];function mt(){const{currentUser:i}=re(),{users:y}=ve(),[b,h]=t.useState(""),[a,l]=t.useState(""),[m,o]=t.useState(""),[x,f]=t.useState(!1),[j,r]=t.useState(null),[n,d]=t.useState(!1),[w,S]=t.useState([]),[c,k]=t.useState(!0),[C,v]=t.useState(!1),[P,u]=t.useState(!1),[E,_]=t.useState(!1),[I,G]=t.useState({isOpen:!1,title:"",message:""});t.useEffect(()=>{const s=new URLSearchParams(window.location.search),p=s.get("to"),N=s.get("templateId");if(p)h(p);else{const M=localStorage.getItem("last_admin_email_to");M&&h(M)}const A=O(D(T,"email_templates"),B("createdAt","desc")),L=U(A,M=>{const me=M.docs.map(W=>({id:W.id,...W.data()}));if(S(me),k(!1),N){const W=xe.find(q=>q.id===N);if(W)l(W.subject),o(W.html);else{const q=me.find(ke=>ke.id===N);q&&(l(q.subject),o(q.html))}}},M=>{console.error("Error fetching templates:",M),k(!1)});return()=>L()},[]);const V=t.useMemo(()=>{if(!b||n)return[];const s=b.toLowerCase();return s===":all"?y:y.filter(p=>{const N=p.email&&typeof p.email=="string"&&p.email.toLowerCase().includes(s),A=p.displayName&&typeof p.displayName=="string"&&p.displayName.toLowerCase().includes(s);return N||A}).slice(0,5)},[b,y,n]),J=async s=>{if(s.preventDefault(),n){const p=y.length;if(!window.confirm(`Are you sure you want to send this email to ALL ${p} users?`))return}f(!0),r(null);try{const p={message:{subject:a,html:m.replace(/\n/g,"<br>").replace(/\[USER_EMAIL\]/g,b),text:m.replace(/\[USER_EMAIL\]/g,b)},createdAt:te()},N=D(T,"mail");if(n){const A=y.map(L=>Q(N,{...p,to:L.email}));await Promise.all(A),r({type:"success",msg:`Email queued for all ${y.length} users.`})}else await Q(N,{...p,to:b}),localStorage.setItem("last_admin_email_to",b),r({type:"success",msg:`Email queued for ${b}`});h("")}catch(p){console.error("Error sending email:",p),r({type:"error",msg:"Failed to queue email: "+p.message})}finally{f(!1)}},se=async()=>{if(!a||!m){alert("Please enter a subject and message to save as a template.");return}const s=prompt("Enter a name for this template:");if(s){v(!0);try{await Q(D(T,"email_templates"),{name:s,subject:a,html:m,createdAt:te()}),r({type:"success",msg:"Template saved successfully!"})}catch(p){console.error("Error saving template:",p),r({type:"error",msg:"Failed to save template."})}finally{v(!1)}}},ae=async(s,p)=>{if(p.stopPropagation(),!!window.confirm("Delete this template?"))try{await le(R(T,"email_templates",s))}catch(N){console.error("Error deleting template:",N)}},K=s=>{(a||m)&&!window.confirm("Replace current content with template?")||(l(s.subject),o(s.html))},g=()=>{if(!m)return;let s=m;s=s.replace(/(<(div|ul|ol|li|h[1-6]|p|blockquote|br|table|tr)[^>]*>)/gi,`
$1`),s=s.replace(/(<\/(div|ul|ol|li|h[1-6]|p|blockquote|table|tr)>)/gi,`$1
`),s=s.replace(/\n\s*\n/g,`
`),o(s.trim())};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6 max-w-4xl mx-auto",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2 border-b dark:border-gray-700 pb-4",children:[e.jsx(Ge,{className:"w-6 h-6 text-primary-600"}),"Send Custom Email"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Recipient"}),e.jsxs("div",{className:"mb-4 flex items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md border border-blue-100 dark:border-blue-800",children:[e.jsx("input",{type:"checkbox",id:"sendToAll",checked:n,onChange:s=>{d(s.target.checked),s.target.checked&&h("")},className:"w-4 h-4 text-primary-600 rounded border-gray-300 focus:ring-primary-500"}),e.jsxs("label",{htmlFor:"sendToAll",className:"text-sm font-medium text-gray-800 dark:text-gray-200 flex items-center gap-2 cursor-pointer select-none",children:[e.jsx(ce,{size:16})," Send to ALL Users (",y.length,")"]})]}),!n&&e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),e.jsx("input",{type:"email",required:!n,value:b,onChange:s=>{h(s.target.value),u(!0)},onFocus:()=>u(!0),onBlur:()=>setTimeout(()=>u(!1),200),placeholder:"Search user by email or name...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500"}),P&&b&&V.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:V.map(s=>e.jsxs("button",{type:"button",onClick:()=>{h(s.email),u(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:s.email}),s.displayName&&e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.displayName})]},s.uid))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),e.jsx("input",{type:"text",required:!0,value:a,onChange:s=>l(s.target.value),placeholder:"Subject line...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Message (HTML/Text)"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:g,className:"text-xs flex items-center gap-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium transition-colors",title:"Pretty format HTML",children:[e.jsx(Me,{size:12})," Format HTML"]}),e.jsxs("button",{type:"button",onClick:()=>_(!E),className:"text-xs flex items-center gap-1 text-primary-600 dark:text-primary-400 hover:text-primary-700 font-medium transition-colors",children:[e.jsx(ee,{size:12})," ",E?"Close AI":"Edit with AI"]})]})]}),e.jsx(ge,{required:!0,value:m,onChange:s=>o(s.target.value),placeholder:"Type your message here...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500 font-mono text-sm",minHeight:300}),E&&i&&e.jsx(Z,{userId:i.uid,sectionName:"Email Body",currentText:m,language:"English",onAccept:s=>{o(s),_(!1)},onClose:()=>_(!1),onError:(s,p)=>G({isOpen:!0,title:s,message:p}),contextType:"email"})]}),j&&e.jsxs("div",{className:`p-3 rounded-md flex items-center gap-2 text-sm ${j.type==="success"?"bg-green-50 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-300"}`,children:[j.type==="success"?e.jsx(ye,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"}),j.msg]}),e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsxs("button",{type:"button",onClick:se,disabled:C||!a||!m,className:"flex items-center gap-2 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md font-medium text-sm transition-colors disabled:opacity-50",children:[C?e.jsx(F,{className:"animate-spin w-4 h-4"}):e.jsx(fe,{size:16}),"Save as Template"]}),e.jsxs("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-md font-medium disabled:opacity-50 transition-colors shadow-sm",children:[x&&e.jsx(F,{className:"animate-spin w-4 h-4"}),"Send Email"]})]})]})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg border border-gray-200 dark:border-gray-700 h-fit max-h-[700px] overflow-y-auto",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2 sticky top-0 bg-gray-50 dark:bg-gray-700/30 pb-2 z-10",children:[e.jsx(je,{size:16})," Templates"]}),w.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 mb-2 uppercase",children:"Custom"}),e.jsx("div",{className:"space-y-2",children:w.map(s=>e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{type:"button",onClick:()=>K(s),className:"w-full text-left p-3 pr-8 bg-white dark:bg-gray-800 border border-purple-200 dark:border-purple-900 rounded-md hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-sm transition-all",children:[e.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-1",children:s.subject})]}),e.jsx("button",{onClick:p=>ae(s.id,p),className:"absolute right-2 top-3 p-1 text-gray-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",title:"Delete Template",children:e.jsx(H,{size:14})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 mb-2 uppercase",children:"System"}),e.jsx("div",{className:"space-y-2",children:xe.map(s=>e.jsxs("button",{type:"button",onClick:()=>K(s),className:"w-full text-left p-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-sm transition-all group",children:[e.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-200 group-hover:text-primary-600 dark:group-hover:text-primary-400 text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-1",children:s.subject})]},s.id))})]}),e.jsx("div",{className:"mt-4 text-xs text-gray-400 px-1",children:"Click a template to populate the form."})]})]}),I.isOpen&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg max-w-sm w-full shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold text-red-600 mb-2",children:I.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:I.message}),e.jsx("button",{onClick:()=>G({isOpen:!1,title:"",message:""}),className:"w-full py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-md",children:"Close"})]})})]})}const xt=()=>{const[i,y]=t.useState([]),[b,h]=t.useState(!0),[a,l]=t.useState(null);t.useEffect(()=>{const r=O(D(T,"partner_applications"),B("createdAt","desc")),n=U(r,d=>{const w=d.docs.map(S=>({id:S.id,...S.data()}));y(w),h(!1)});return()=>n()},[]);const m=async(r,n)=>{try{await $(R(T,"partner_applications",r),{status:n}),y(d=>d.map(w=>w.id===r?{...w,status:n}:w)),l(null)}catch(d){console.error("Error updating status:",d),alert("Failed to update status")}},o=async r=>{if(window.confirm("Are you sure you want to delete this application?"))try{await le(R(T,"partner_applications",r))}catch(n){console.error("Error deleting application:",n),alert("Failed to delete application")}},x=(r,n)=>{if(r==="academic")return"welcome_partner";if(r==="business"){const d=n.toLowerCase();return d.includes("hir")||d.includes("recruit")||d.includes("talent")?"welcome_business_hiring":d.includes("brand")||d.includes("hackathon")||d.includes("event")?"welcome_business_branding":"welcome_business_general"}if(r==="student"){const d=n.toLowerCase();return d.includes("club")||d.includes("organization")||d.includes("society")?"welcome_student_club":"welcome_student_ambassador"}return"generic_notification"},f=r=>{const n=x(r.type,r.message);window.location.href=`/admin?tab=tools&to=${encodeURIComponent(r.email)}&templateId=${n}`},j=r=>{switch(r){case"business":return e.jsx(qe,{size:16,className:"text-purple-500"});case"student":return e.jsx(ce,{size:16,className:"text-pink-500"});default:return e.jsx(Ve,{size:16,className:"text-blue-500"})}};return b?e.jsx("div",{className:"flex justify-center p-10",children:e.jsx(F,{className:"animate-spin text-primary-500"})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Partner Applications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Review and manage incoming partnership requests."})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900/50 text-xs uppercase text-gray-500 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Applicant"}),e.jsx("th",{className:"px-6 py-4",children:"Organization"}),e.jsx("th",{className:"px-6 py-4",children:"Type"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-gray-500",children:"No applications found."})}):i.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),e.jsx("div",{className:"text-sm text-gray-500",children:r.email}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1 max-w-xs truncate",title:r.message,children:['"',r.message,'"']})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:r.organization}),r.website&&e.jsxs("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:underline flex items-center gap-1 mt-1",children:["Visit Website ",e.jsx(de,{size:10})]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 capitalize text-sm",children:[j(r.type),r.type]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[a===r.id?e.jsxs("select",{value:r.status,onChange:n=>m(r.id,n.target.value),onBlur:()=>l(null),className:"text-xs p-1 px-2 border rounded bg-white dark:bg-gray-800 dark:border-gray-700",autoFocus:!0,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}):e.jsx("div",{onClick:()=>l(r.id),className:"cursor-pointer hover:opacity-80",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize
                                                        ${r.status==="approved"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":r.status==="rejected"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"}`,children:r.status})}),r.status==="approved"&&r.accountCreationMessage&&e.jsx("div",{className:"mt-1 text-xs",children:r.accountCreated?e.jsx("span",{className:"text-green-600 dark:text-green-400",children:r.accountCreationMessage}):e.jsx("span",{className:"text-red-600 dark:text-red-400",title:r.accountCreationMessage,children:r.accountCreationMessage})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>f(r),className:"p-1.5 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",title:"Send Welcome Email",children:e.jsx(oe,{size:16})}),e.jsx("button",{onClick:()=>o(r.id),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-gray-100 rounded-md transition-colors",title:"Delete",children:e.jsx(H,{size:16})})]})})]},r.id))})]})})]})},pt=()=>{const{currentUser:i}=re(),[y,b]=t.useState(""),[h,a]=t.useState(!0),[l,m]=t.useState(!1),[o,x]=t.useState(null),[f,j]=t.useState(null);t.useEffect(()=>{const d=He(w=>{b(w.featuredResumeSuffix||Ye.featuredResumeSuffix),j(w.updatedAt),a(!1)});return()=>d()},[]);const r=async()=>{if(!i)return;m(!0),x(null);let d=y.trim();d.startsWith("https://careervivid.app/")&&(d=d.replace("https://careervivid.app/","")),d.startsWith("/")&&(d=d.substring(1)),d.includes("/#/")&&(d=d.replace("/#/","/"));try{await Je({featuredResumeSuffix:d},i.uid),x({type:"success",text:"Landing page updated successfully!"}),b(d)}catch(w){console.error("Failed to update settings:",w),x({type:"error",text:"Failed to update settings. Please try again."})}finally{m(!1)}};if(h)return e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(F,{className:"animate-spin text-primary-500"})});const n=`https://careervivid.app/${y}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Landing Page Configuration"})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Featured Resume Link"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:["This controls the interactive resume preview shown on the public Landing Page. Enter the path suffix (e.g., ",e.jsx("code",{children:"shared/USER_ID/RESUME_ID"}),")."]}),e.jsxs("div",{className:"space-y-4 max-w-2xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Resume Path Suffix"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:y,onChange:d=>b(d.target.value),className:"flex-1 p-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 focus:ring-2 focus:ring-primary-500 font-mono text-sm",placeholder:"shared/..."}),e.jsxs("button",{onClick:r,disabled:l,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 flex items-center gap-2",children:[l?e.jsx(F,{size:16,className:"animate-spin"}):e.jsx(fe,{size:16}),"Save"]})]})]}),o&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 text-sm ${o.type==="success"?"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-300"}`,children:[o.type==="success"?e.jsx(ye,{size:16}):e.jsx(be,{size:16}),o.text]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-100 dark:border-gray-800",children:[e.jsx("h4",{className:"text-xs font-semibold uppercase text-gray-500 mb-2",children:"Preview"}),e.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline flex items-center gap-1 text-sm break-all",children:[n," ",e.jsx(de,{size:12})]}),f&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Last updated: ",f?.toDate?f.toDate().toLocaleString():"Just now"]})]})]})]})]})},rr=()=>{const{logOut:i}=re(),{users:y,loading:b}=ve(),{logs:h,loading:a}=we(),[l,m]=t.useState(()=>new URLSearchParams(window.location.search).get("tab")||"feedback"),o=()=>{switch(l){case"users":return e.jsx(rt,{users:y,logs:h,loading:b||a});case"analytics":return e.jsx(st,{});case"messages":return e.jsx(at,{});case"blog":return e.jsx(lt,{});case"feedback":return e.jsx(dt,{});case"error_reports":return e.jsx(ct,{});case"tools":return e.jsx(mt,{});case"partners":return e.jsx(xt,{});case"landing":return e.jsx(pt,{});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-100",children:[e.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:[e.jsxs("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ke,{className:"h-8 w-8 text-primary-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"})]}),e.jsx("button",{onClick:i,className:"text-sm font-semibold text-gray-600 dark:text-gray-300 hover:text-primary-500",children:"Sign Out"})]}),e.jsx("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex gap-4 border-b border-gray-200 dark:border-gray-700 overflow-x-auto",children:[{id:"users",label:"Users",icon:he},{id:"analytics",label:"Analytics",icon:Xe},{id:"messages",label:"Messages",icon:oe},{id:"blog",label:"Blog",icon:je},{id:"feedback",label:"Feedback",icon:Qe},{id:"error_reports",label:"Errors",icon:Ze},{id:"tools",label:"Tools",icon:oe},{id:"partners",label:"Partners",icon:ce},{id:"landing",label:"Landing Page",icon:We}].map(x=>e.jsxs("button",{onClick:()=>{m(x.id);const f=new URL(window.location.href);f.searchParams.set("tab",x.id),window.history.pushState({},"",f)},className:`py-3 px-1 text-sm font-semibold flex items-center gap-2 whitespace-nowrap ${l===x.id?"border-b-2 border-primary-500 text-primary-600":"text-gray-500"}`,children:[e.jsx(x.icon,{size:16}),x.label]},x.id))})]}),e.jsx("main",{className:"py-10",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:o()})})]})};export{rr as default};
