import{r as o,j as e,L as H,s as V,b as f,t as b,c as J,d as K,T as R,e as D,f as A,g as j,h as I,i as Q,k as X,l as Y,m as Z,q as $,n as ee,w as U,o as ae}from"./main-D7bwdUQx.js";import{L as re}from"./Logo-DPBmgvCf.js";import{u as te}from"./useTranslation-DTfaX8qA.js";import{A as se}from"./arrow-left-Cw-deXTS.js";import{M as oe}from"./mail-DgfX-KG1.js";import{L as ie}from"./lock-DcpO_n2u.js";import{E as ne}from"./eye-off-C3BEQmJh.js";import{E as le}from"./eye-DEr-hoMY.js";import{C as de}from"./chevron-right-PWzp5mFn.js";const ye=()=>{const{t:a}=te(),[n,z]=o.useState(!0),[h,M]=o.useState(""),[y,T]=o.useState(""),[w,q]=o.useState(!1),[k,s]=o.useState(""),[N,x]=o.useState(""),[g,m]=o.useState(!1),[_,S]=o.useState(0),C=[a("auth.loading_secure"),a("auth.loading_process"),a("auth.loading_ready"),a("auth.loading_moment")];o.useEffect(()=>{let t;return g&&(S(0),t=window.setInterval(()=>{S(r=>r>=C.length-1?r:r+1)},1800)),()=>clearInterval(t)},[g]);const v=t=>{switch(t.code){case"auth/invalid-credential":case"auth/user-not-found":case"auth/wrong-password":s(a("auth.error_invalid"));break;case"auth/email-already-in-use":s(a("auth.error_exists"));break;case"auth/weak-password":s(a("auth.error_weak"));break;case"auth/popup-closed-by-user":break;case"auth/account-exists-with-different-credential":s(a("auth.error_diff_cred"));break;default:s(t.message.replace("Firebase: ",""));break}};o.useEffect(()=>{const r=new URLSearchParams(window.location.search).get("ref");r&&localStorage.setItem("careervivid_referral",r)},[]);const L=()=>localStorage.getItem("careervivid_referral")||void 0,E=async t=>{try{const r=$(ee(j,"users"),U("referralCode","==",t),U("role","==","academic_partner")),l=await ae(r);if(!l.empty)return l.docs[0].id}catch(r){console.error("Error looking up referral code:",r)}return null},B=async t=>{t.preventDefault(),m(!0),s(""),x("");try{if(n){const d=await V(f,h,y);b(d.user.uid,"sign_in")}else{const d=await J(f,h,y),P={url:window.location.href.split("#")[0]};await K(d.user,P);const u=L();let i,c=!1;u&&(i=await E(u),i&&(c=!0));const p=c?R.fromDate(new Date(Date.now()+720*60*60*1e3)):void 0;await D(A(j,"users",d.user.uid),{uid:d.user.uid,email:d.user.email,createdAt:I(),promotions:{},status:"active",...u?{referredBy:u}:{},...i?{academicPartnerId:i}:{},...c?{plan:"pro_sprint",expiresAt:p}:{}}),b(d.user.uid,"sign_in",{signup:!0})}const l=new URLSearchParams(window.location.search).get("redirect");l&&(window.location.href=decodeURIComponent(l))}catch(r){v(r),m(!1)}},F=async()=>{m(!0),s(""),x("");try{const r=(await X(f,Y)).user,l=A(j,"users",r.uid);if((await Z(l)).exists())b(r.uid,"sign_in",{provider:"google"});else{const i=L();let c,p=!1;i&&(c=await E(i),c&&(p=!0));const G=p?R.fromDate(new Date(Date.now()+720*60*60*1e3)):void 0;await D(l,{uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,createdAt:I(),promotions:{},status:"active",...i?{referredBy:i}:{},...c?{academicPartnerId:c}:{},...p?{plan:"pro_sprint",expiresAt:G}:{}}),b(r.uid,"sign_in",{signup:!0,provider:"google"})}const u=new URLSearchParams(window.location.search).get("redirect");u&&(window.location.href=decodeURIComponent(u))}catch(t){v(t),m(!1)}},W=async()=>{if(!h){s(a("auth.enter_email_reset"));return}m(!0),s(""),x("");try{await Q(f,h),x(a("auth.reset_sent"))}catch(t){v(t)}m(!1)},O=()=>e.jsxs("div",{className:"fixed inset-0 bg-white/80 dark:bg-gray-950/80 backdrop-blur-sm z-50 flex flex-col items-center justify-center text-center p-4 animate-fade-in",children:[e.jsx(H,{className:"w-16 h-16 text-primary-600 animate-spin mx-auto"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-6",children:a("auth.please_wait")}),e.jsx("div",{className:"h-6 mt-2",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400 animate-fade-in font-medium",children:C[_]},_)})]});return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-950 px-4 relative overflow-hidden font-sans",children:[e.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full max-w-7xl pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-96 h-96 bg-primary-400/20 rounded-full blur-3xl mix-blend-multiply dark:mix-blend-screen opacity-50"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-purple-400/20 rounded-full blur-3xl mix-blend-multiply dark:mix-blend-screen opacity-50"})]}),g&&e.jsx(O,{}),e.jsxs("a",{href:"/",className:"absolute top-8 left-8 z-20 flex items-center gap-2 text-sm font-semibold text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors",children:[e.jsx(se,{size:18}),a("auth.back_home")]}),e.jsx("div",{className:"w-full max-w-md relative z-10",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl shadow-2xl shadow-gray-200/50 dark:shadow-none border border-gray-100 dark:border-gray-800 p-8 sm:p-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx(re,{className:"h-10 w-10 mx-auto mb-6"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:a(n?"auth.welcome_back":"auth.create_account")}),e.jsx("p",{className:"mt-3 text-gray-500 dark:text-gray-400",children:a(n?"auth.enter_details":"auth.start_building")})]}),e.jsxs("form",{className:"space-y-5",onSubmit:B,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:a("auth.email_label")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(oe,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"block w-full pl-11 pr-4 py-3.5 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all text-sm font-medium",placeholder:a("auth.email_placeholder"),value:h,onChange:t=>M(t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:a("auth.password_label")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(ie,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:w?"text":"password",required:!0,className:"block w-full pl-11 pr-11 py-3.5 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all text-sm font-medium",placeholder:a("auth.password_placeholder"),value:y,onChange:t=>T(t.target.value)}),e.jsx("button",{type:"button",onClick:()=>q(!w),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:w?e.jsx(ne,{size:20}):e.jsx(le,{size:20})})]})]}),n&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{type:"button",onClick:W,className:"text-sm font-semibold text-primary-600 hover:text-primary-500 transition-colors",children:a("auth.forgot_password")})}),k&&e.jsx("div",{className:"p-3 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center font-medium",children:k})}),N&&e.jsx("div",{className:"p-3 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-100 dark:border-green-800",children:e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 text-center font-medium",children:N})}),e.jsx("button",{type:"submit",disabled:g,className:"w-full flex justify-center py-3.5 px-4 border border-transparent rounded-xl shadow-lg shadow-primary-500/20 text-sm font-bold text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-70 disabled:cursor-not-allowed transition-all transform hover:-translate-y-0.5",children:a(n?"auth.sign_in":"auth.create_account_btn")})]}),e.jsxs("div",{className:"my-8 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:e.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-800"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-white dark:bg-gray-900 text-gray-500 font-medium",children:a("auth.or_continue_with")})})]}),e.jsxs("button",{onClick:F,disabled:g,className:"w-full flex items-center justify-center gap-3 py-3.5 px-4 border border-gray-200 dark:border-gray-700 rounded-xl shadow-sm bg-white dark:bg-gray-800 text-sm font-bold text-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-all",children:[e.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 381.5 512 244 512 111.8 512 0 398.2 0 256S111.8 0 244 0c71.2 0 130.9 27.8 176.9 72.9l-63.1 61.3C294.3 93.6 270.3 80 244 80 158.4 80 90 148.2 90 233.9s68.4 153.9 154 153.9c75.5 0 120.9-42.3 124.9-97.9H244v-77.3h236.1c2.4 12.7 3.9 26.1 3.9 40.2z"})}),a("auth.google")]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a(n?"auth.dont_have_account":"auth.already_have_account")," ",e.jsxs("button",{onClick:()=>{z(!n),s(""),x("")},className:"font-bold text-primary-600 hover:text-primary-700 transition-colors inline-flex items-center gap-1",children:[a(n?"auth.sign_up_free":"auth.log_in")," ",e.jsx(de,{size:14})]})]})})]})})]})};export{ye as default};
