import{u as m,r as s,m as i,f as c,q as w,z as E,p as T,v as J,g as d,e as b,B as C,C as D,n as S,D as R}from"./main-BEc7sVU2.js";const B=()=>{const{currentUser:r}=m(),[f,u]=s.useState([]),[h,n]=s.useState(!0);s.useEffect(()=>{if(!r){u([]),n(!1);return}n(!0);const t=i(c,"users",r.uid,"jobTracker"),e=w(t,E("updatedAt","desc")),o=T(e,a=>{const A=a.docs.map(l=>{const p=l.data();return{id:l.id,...p,section:p.section||"jobTracker"}});u(A),n(!1)},a=>{console.error("Error fetching job applications:",a),n(!1)});return()=>o()},[r]);const k=s.useCallback(async t=>{if(!r)throw new Error("User not logged in");try{return(await J(i(c,"users",r.uid,"jobTracker"),{...t,userId:r.uid,section:"jobTracker",createdAt:d(),updatedAt:d()})).id}catch(e){throw console.error("Error adding job application:",e),e}},[r]),j=s.useCallback(async(t,e)=>{if(r)try{const o=JSON.parse(JSON.stringify(e));delete o.id;const a=b(c,"users",r.uid,"jobTracker",t);await C(a,{...o,updatedAt:d()})}catch(o){console.error("Error updating job application:",o)}},[r]),g=s.useCallback(async t=>{if(r)try{const e=b(c,"users",r.uid,"jobTracker",t);await D(e)}catch(e){console.error("Error deleting job application:",e)}},[r]),y=s.useCallback(async()=>{if(r)try{const t=i(c,"users",r.uid,"jobTracker"),e=await S(t);if(e.empty)return;const o=R(c);e.docs.forEach(a=>{o.delete(a.ref)}),await o.commit()}catch(t){throw console.error("Error deleting all job applications:",t),t}},[r]);return{jobApplications:f,isLoading:h,addJobApplication:k,updateJobApplication:j,deleteJobApplication:g,deleteAllJobApplications:y}};export{B as u};
