import{u as T,r as c,j as e,p as C,E as S,m as z,f as j,g as v,B as E,$ as d,F as D}from"./main-D7bwdUQx.js";import{F as I}from"./Footer-CxHvxPO8.js";import{L as F}from"./Logo-DPBmgvCf.js";import{V as x}from"./video-DKmnxiHe.js";import{C as u}from"./check-circle-Y3w2FutP.js";import{U}from"./users-C9F5B6QA.js";import{H as L,F as N,M as R}from"./music-WNGOgNMw.js";import{R as $}from"./refresh-cw-DTA__X86.js";import{L as M}from"./lock-DcpO_n2u.js";import{C as P}from"./calendar-BnGCRrKy.js";const V=[{id:"calendar",name:"Calendar Booking",icon:e.jsx(P,{size:24}),connected:!1,desc:"Allow visitors to book calls directly."},{id:"spotify",name:"Spotify Embed",icon:e.jsx(R,{size:24}),connected:!0,desc:"Showcase your latest tracks or playlists."},{id:"resume",name:"Resume Download",icon:e.jsx(D,{size:24}),connected:!1,desc:"Let recruiters download your CV."}],g=t=>t==null?"â€”":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString(),ee=()=>{const{currentUser:t}=T(),[l,p]=c.useState(!1),[k,n]=c.useState(!1),[a,b]=c.useState(null),[A,w]=c.useState(!0);c.useEffect(()=>{(async()=>{if(t){w(!0);try{const o=await z(j(v,"users",t.uid,"integrations","tiktok"));if(o.exists()){const i=o.data();i.connected&&(p(!0),b({...i.profile,videos:i.videos||[]}))}}catch(o){console.error("Error fetching TikTok data:",o)}finally{w(!1)}}})()},[t]);const y=async()=>{if(!(!t||!confirm("Are you sure you want to disconnect TikTok? This will remove your Media Kit from your page.")))try{const s=j(v,"users",t.uid,"integrations","tiktok");await E(s,{connected:!1,profile:d(),videos:d(),accessToken:d(),refreshToken:d()}),p(!1),b(null)}catch(s){console.error("Error disconnecting TikTok:",s),alert("Failed to disconnect. Please try again.")}},_=()=>{n(!0);const s=Math.random().toString(36).substring(7);localStorage.setItem("tiktok_csrf_state",s);const o="aw1crl350g7yvps2",i=`${window.location.origin}/dashboard/integrations`,f=`https://www.tiktok.com/v2/auth/authorize/?client_key=${o}&response_type=code&scope=user.info.basic,user.info.profile,user.info.stats,video.list&redirect_uri=${encodeURIComponent(i)}&state=${s}`;window.location.href=f};return c.useEffect(()=>{const s=new URLSearchParams(window.location.search),o=s.get("code"),i=s.get("state"),m=s.get("error");if(o&&!l){const f=localStorage.getItem("tiktok_csrf_state");if(i!==f){console.error("CSRF State Mismatch");return}n(!0),t&&(async()=>{try{const h=await t?.getIdToken(),r=await(await fetch("https://us-west1-jastalk-firebase.cloudfunctions.net/connectTikTok",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({code:o,redirectUri:`${window.location.origin}/dashboard/integrations`})})).json();r.success?(p(!0),r.profile&&b({displayName:r.profile.display_name||r.profile.displayName||"TikTok User",avatarUrl:r.profile.avatar_url||r.profile.avatarUrl||null,followerCount:r.profile.follower_count??r.profile.followerCount??null,likesCount:r.profile.likes_count??r.profile.likesCount??null,videoCount:r.profile.video_count??r.profile.videoCount??null,isVerified:r.profile.is_verified||!1,videos:[]}),window.history.replaceState({},document.title,window.location.pathname),setTimeout(()=>{window.location.reload()},2e3)):(console.error("Integrations Error:",r.error),alert("Failed to connect TikTok: "+r.error))}catch(h){console.error("Network Error:",h)}finally{n(!1),localStorage.removeItem("tiktok_csrf_state")}})()}else m&&(console.error("TikTok Auth Error:",m),n(!1))},[t,l]),e.jsxs("div",{className:"bg-[#f0f0f0] min-h-screen flex flex-col font-sans",style:{backgroundImage:"radial-gradient(#cbd5e1 1px, transparent 1px)",backgroundSize:"20px 20px"},children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/90 backdrop-blur-md border-b-4 border-black shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("a",{href:"/dashboard",className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-8 w-8"}),e.jsx("span",{className:"text-xl font-black text-black",children:"CareerVivid"})]}),e.jsx("button",{onClick:()=>C("/dashboard"),className:"px-4 py-2 bg-black text-white font-bold text-sm border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] transition-all",children:"Back to Dashboard"})]})})}),e.jsxs("main",{className:"flex-grow pt-32 pb-20 flex flex-col lg:flex-row max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 gap-12",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-black text-black mb-8 uppercase tracking-tighter",children:e.jsx("span",{className:"bg-white px-4 py-2 border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] inline-block",children:"Integrations"})}),e.jsx("p",{className:"text-xl font-bold text-gray-700 mb-12 font-mono",children:"Power up your Bio-Link with third-party widgets."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:`p-8 border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] transition-all ${l?"bg-[#dcfce7]":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:`p-4 rounded-none border-4 border-black ${l?"bg-green-500 text-white":"bg-black text-white"}`,children:e.jsx(x,{size:32})}),l&&e.jsx("div",{className:"px-3 py-1 bg-green-500 text-white font-black text-xs uppercase border-2 border-black",children:"Active"})]}),e.jsx("h3",{className:"text-2xl font-black uppercase mb-2",children:"TikTok"}),e.jsx("p",{className:"font-mono text-sm text-gray-600 mb-8 border-b-2 border-black pb-4",children:"Display your latest videos and public stats automatically."}),l?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{className:"w-full py-3 bg-white text-black font-black uppercase border-4 border-black cursor-default flex items-center justify-center gap-2",children:[e.jsx(u,{size:20,className:"text-green-600"})," Connected"]}),e.jsx("button",{onClick:y,className:"w-full text-xs text-red-500 font-bold hover:underline uppercase tracking-wider",children:"Disconnect"})]}):e.jsxs("button",{onClick:_,disabled:k,className:"w-full py-4 bg-[#fe2c55] text-white font-black uppercase border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] transition-all flex items-center justify-center gap-2",children:[k?"Connecting...":"Connect TikTok"," ",e.jsx(S,{size:18})]})]}),l&&a&&e.jsxs("div",{className:"md:col-span-2 p-8 bg-gradient-to-br from-[#fe2c55] to-[#ff6b8a] border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-black text-white uppercase flex items-center gap-2",children:[e.jsx(x,{size:28})," Your Media Kit"]}),e.jsx("span",{className:"px-3 py-1 bg-white text-[#fe2c55] font-black text-xs uppercase border-2 border-black",children:"Live Data"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8 bg-white/10 p-4 border-2 border-white/30 backdrop-blur-sm",children:[a.avatarUrl?e.jsx("img",{src:a.avatarUrl,alt:a.displayName,className:"w-16 h-16 rounded-full border-4 border-white object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-white bg-black/20 flex items-center justify-center",children:e.jsx(x,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-white font-black text-xl flex items-center gap-2",children:["@",a.displayName,a.isVerified&&e.jsx(u,{size:20,className:"text-blue-400 fill-current"})]}),e.jsx("p",{className:"text-white/70 font-mono text-sm",children:"TikTok Creator"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 border-4 border-black text-center shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]",children:[e.jsx(U,{size:24,className:"mx-auto mb-2 text-[#fe2c55]"}),e.jsx("p",{className:"text-3xl font-black text-black",children:g(a.followerCount)}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Followers"})]}),e.jsxs("div",{className:"bg-white p-6 border-4 border-black text-center shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]",children:[e.jsx(L,{size:24,className:"mx-auto mb-2 text-[#fe2c55]"}),e.jsx("p",{className:"text-3xl font-black text-black",children:g(a.likesCount)}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Likes"})]}),e.jsxs("div",{className:"bg-white p-6 border-4 border-black text-center shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]",children:[e.jsx(N,{size:24,className:"mx-auto mb-2 text-[#fe2c55]"}),e.jsx("p",{className:"text-3xl font-black text-black",children:g(a.videoCount)}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Videos"})]})]}),a.videos&&a.videos.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-white font-black uppercase mb-4 flex items-center gap-2",children:[e.jsx(N,{size:18})," Recent Content"]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:a.videos.map((s,o)=>e.jsx("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"block aspect-[9/16] bg-black/20 border-2 border-white/50 hover:border-white transition-all rounded-lg overflow-hidden group",children:e.jsx("img",{src:s.coverUrl,alt:s.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"})},o))})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2 text-white/70 text-xs font-mono",children:[e.jsx($,{size:12}),"Stats auto-update when you connect"]})]}),V.map(s=>e.jsxs("div",{className:"p-6 bg-white border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] opacity-75 hover:opacity-100 transition-opacity",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-gray-100 border-4 border-black text-black",children:s.icon}),s.connected&&e.jsx(u,{size:20,className:"text-green-600"})]}),e.jsx("h3",{className:"text-xl font-black uppercase mb-2",children:s.name}),e.jsx("p",{className:"font-mono text-xs text-gray-600 mb-6",children:s.desc}),e.jsx("button",{className:"w-full py-2 bg-gray-200 text-gray-500 font-bold uppercase border-2 border-gray-400 cursor-not-allowed text-xs",children:s.connected?"Manage":"Coming Soon"})]},s.id))]}),e.jsxs("div",{className:"mt-16 bg-[#fffbeb] border-4 border-black p-8 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]",children:[e.jsxs("h3",{className:"text-xl font-black uppercase mb-4 flex items-center gap-2",children:[e.jsx(M,{size:24})," TikTok Verification Guide"]}),e.jsx("div",{className:"aspect-video bg-black/10 border-4 border-black border-dashed flex items-center justify-center",children:e.jsx("p",{className:"font-mono text-gray-500 font-bold",children:"[VIDEO_EMBED_HERE]"})}),e.jsx("p",{className:"mt-4 font-mono text-sm",children:"Need help? Watch this quick guide on how to verify your account."})]})]}),e.jsx("div",{className:"w-full lg:w-[400px] flex-shrink-0 relative",children:e.jsx("div",{className:"sticky top-32",children:e.jsxs("div",{className:"bg-black rounded-[3rem] p-4 border-8 border-gray-900 shadow-2xl h-[750px] w-full max-w-[360px] mx-auto relative overflow-hidden bg-white",children:[e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-32 h-6 bg-black rounded-b-xl z-20"}),e.jsxs("div",{className:"h-full w-full bg-[#f3f4f6] overflow-y-auto no-scrollbar pt-12 pb-8 px-4 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-300 rounded-full border-4 border-black mb-4"}),e.jsx("div",{className:"w-32 h-6 bg-gray-300 rounded mb-2"}),e.jsx("div",{className:"w-48 h-4 bg-gray-200 rounded mb-8"}),e.jsxs("div",{className:"w-full space-y-3 mb-8",children:[e.jsx("div",{className:"w-full h-12 bg-white border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] rounded-lg"}),e.jsx("div",{className:"w-full h-12 bg-white border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] rounded-lg"}),e.jsx("div",{className:"w-full h-12 bg-white border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] rounded-lg"})]}),l?e.jsxs("div",{className:"w-full bg-black rounded-xl overflow-hidden shadow-lg border-2 border-black animate-scale-in",children:[e.jsxs("div",{className:"bg-[#fe2c55] px-3 py-2 flex justify-between items-center",children:[e.jsxs("span",{className:"text-white font-bold text-xs flex items-center gap-1",children:[e.jsx(x,{size:12})," TikTok"]}),e.jsx("span",{className:"text-white text-[10px] opacity-80",children:"@careervivid"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-0.5 bg-black p-0.5 h-32",children:[e.jsx("div",{className:"bg-gray-800 animate-pulse"}),e.jsx("div",{className:"bg-gray-800 animate-pulse delay-75"}),e.jsx("div",{className:"bg-gray-800 animate-pulse delay-150"})]})]}):e.jsx("div",{className:"w-full h-32 border-2 border-dashed border-gray-400 rounded-xl flex items-center justify-center p-4",children:e.jsx("p",{className:"text-xs text-gray-400 text-center",children:"TikTok Widget will appear here once connected."})})]})]})})})]}),e.jsx(I,{variant:"brutalist"})]})};export{ee as default};
