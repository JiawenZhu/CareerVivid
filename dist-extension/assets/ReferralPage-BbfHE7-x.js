import{l as g,e as n,f as c,d as N,g as E,u as T,r as o,o as w,j as e}from"./main-BEc7sVU2.js";import{u as z}from"./useTranslation-CNH1DPc_.js";import{G as v}from"./gift-CgF2-90B.js";import{C as i}from"./check-BXDTBbZe.js";import{C}from"./copy-BbzbJe7R.js";import{U as R}from"./users-CW7lwuWe.js";import{C as F}from"./calendar-BlywvGr0.js";function U(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let r="";for(let t=0;t<8;t++)r+=s.charAt(Math.floor(Math.random()*s.length));return r}async function G(s){let r=U(),t=0;const d=10;for(;t<d;){if(!(await g(n(c,"referralCodes",r))).exists())return await N(n(c,"referralCodes",r),{code:r,userId:s,createdAt:E(),usedCount:0,maxUses:5,referredUsers:[]}),await N(n(c,"users",s),{referralCode:r,referralStats:{totalReferred:0,maxReferrals:5,referredUsers:[]}},{merge:!0}),r;r=U(),t++}throw new Error("Failed to generate unique referral code")}async function Y(s){const t=(await g(n(c,"users",s))).data();return t?.referralCode?t.referralCode:await G(s)}async function M(s){const t=(await g(n(c,"users",s))).data(),d=t?.referralCode||"",x=t?.referralStats||{totalReferred:0,maxReferrals:5};let m=[];if(d){const p=await g(n(c,"referralCodes",d));p.exists()&&(m=p.data().referredUsers||[])}return{code:d,totalReferred:x.totalReferred||0,maxReferrals:x.maxReferrals||5,referredUsers:m}}const O=()=>{const{t:s}=z(),{currentUser:r,isPremium:t}=T(),[d,x]=o.useState(""),[m,p]=o.useState(""),[l,D]=o.useState({totalReferred:0,maxReferrals:5,referredUsers:[]}),[S,u]=o.useState(!0),[h,b]=o.useState(!1),[j,y]=o.useState(!1);o.useEffect(()=>{if(!r){w("/signin");return}if(!t){w("/pricing");return}P()},[r,t]);const P=async()=>{if(r)try{u(!0);const a=await Y(r.uid),f=await M(r.uid);x(a),p(`${window.location.origin}/referral?ref=${a}`),D(f)}catch(a){console.error("Error loading referral data:",a)}finally{u(!1)}},k=async(a,f)=>{try{await navigator.clipboard.writeText(a),f==="code"?(b(!0),setTimeout(()=>b(!1),2e3)):(y(!0),setTimeout(()=>y(!1),2e3))}catch(A){console.error("Failed to copy:",A)}},L=l.totalReferred/l.maxReferrals*100;return S?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-pink-50 dark:from-gray-950 dark:via-gray-900 dark:to-purple-950 py-12 px-4 font-sans",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-full mb-6",children:[e.jsx(v,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e.jsx("span",{className:"text-sm font-semibold text-purple-800 dark:text-purple-300",children:"Premium Referral Program"})]}),e.jsxs("h1",{className:"text-3xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-4 leading-tight",children:["Refer Friends & ",e.jsx("span",{className:"bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Earn Premium"})]}),e.jsx("p",{className:"text-lg md:text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto px-2",children:"Share CareerVivid with your friends and both of you get rewarded!"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6 md:p-8 mb-6 md:mb-8",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Your Referral Code"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex-1 bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-xl p-4 border-2 border-purple-200 dark:border-purple-800",children:e.jsx("p",{className:"text-2xl md:text-3xl font-mono font-bold text-center text-purple-900 dark:text-purple-100 tracking-wider break-all",children:d})}),e.jsxs("button",{onClick:()=>k(d,"code"),className:"flex items-center justify-center gap-2 px-6 py-4 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors font-semibold grow md:grow-0",children:[h?e.jsx(i,{size:20}):e.jsx(C,{size:20}),h?"Copied!":"Copy"]})]}),e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Referral Link"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-50 dark:bg-gray-900 rounded-xl p-4 border border-gray-200 dark:border-gray-700 min-w-0",children:e.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 break-all md:truncate",children:m})}),e.jsxs("button",{onClick:()=>k(m,"link"),className:"flex items-center justify-center gap-2 px-6 py-4 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors font-semibold grow md:grow-0",children:[j?e.jsx(i,{size:20}):e.jsx(C,{size:20}),j?"Copied!":"Copy"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6 md:p-8 mb-6 md:mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Referrals Used"}),e.jsxs("span",{className:"text-xl md:text-2xl font-bold text-purple-600 dark:text-purple-400",children:[l.totalReferred,"/",l.maxReferrals]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-pink-600 transition-all duration-500 rounded-full",style:{width:`${L}%`}})}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:[l.maxReferrals-l.totalReferred," referrals remaining"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-2xl p-6 border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(v,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Your Friends Get"})]}),e.jsxs("ul",{className:"space-y-3 text-gray-700 dark:text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-blue-600 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm md:text-base",children:"2 months free Premium"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-blue-600 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm md:text-base",children:"300 AI credits/month"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-blue-600 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm md:text-base",children:"All premium templates"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-2xl p-6 border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(R,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"You Get"})]}),e.jsxs("ul",{className:"space-y-3 text-gray-700 dark:text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-purple-600 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm md:text-base",children:"1 month free Premium"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-purple-600 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm md:text-base",children:"Per successful referral"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-purple-600 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm md:text-base",children:"Up to 5 months total"})]})]})]})]}),l.referredUsers.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6 md:p-8",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6",children:"Referred Users"}),e.jsx("div",{className:"space-y-3",children:l.referredUsers.map((a,f)=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 bg-gray-50 dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold shrink-0",children:f+1}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:a.email}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(F,{size:14}),e.jsx("span",{children:a.signupDate?.toDate?.()?.toLocaleDateString()||"Recently"})]})]})]}),e.jsx("div",{className:"flex sm:justify-end",children:e.jsx("span",{className:"px-3 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full text-sm font-medium",children:"Active"})})]},a.uid))})]}),l.referredUsers.length===0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-12 text-center",children:[e.jsx(R,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"No referrals yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Share your referral code with friends to get started!"})]})]})})};export{O as default};
