import{j as e,E as $,L as A,M as Pe,n as Je,g as pe,q as Ie,A as $e,aa as Me,o as Ee,f as Ue,D as Re,u as He,a as ze,r as l,p as C,U as ge,F as De,X as Fe,J as qe}from"./main-D7bwdUQx.js";import{b as Ge,s as W,i as Be}from"./jobService-C3o-FnLN.js";import{u as Oe}from"./useJobTracker-CXIl5ZRq.js";import{u as _e}from"./useJobHistory-nblYb8Un.js";import{u as We}from"./useAICreditCheck-C1GxJsBq.js";import{a as Xe,b as Ke}from"./applicationService-CzJ0cDEU.js";import{X as Q}from"./x-DMbiC8dp.js";import{T as Qe}from"./trash-2-CQCik4ER.js";import{B as ue}from"./building-2-Cq7l4Mzs.js";import{M as V}from"./map-pin-D8GAobV5.js";import{D as he}from"./dollar-sign-DcpZw4Zw.js";import{C as be}from"./clock-CcciH6c9.js";import{C as me}from"./check-circle-2-DpEuKBG_.js";import{P as Y}from"./plus-circle-B1zjzhT0.js";import{u as Ve}from"./useTranslation-DTfaX8qA.js";import{S as X}from"./search-DcLQ5dqo.js";import{R as Ye}from"./refresh-cw-DTA__X86.js";import{L as xe}from"./layout-dashboard-O5a-GZ1E.js";import{H as Ze}from"./help-circle-Z6uxOdU-.js";import{S as er}from"./send-UNE_Yrxr.js";import"./zap-DWwtH8Bb.js";import"./check-CW4K69vK.js";const rr=[{regex:/\$[\d,]+(k)?(\/yr|\/year|\/mo|\/month|\/hr|\/hour)?(\s?-\s?\$[\d,]+(k)?(\/yr|\/year|\/mo|\/month|\/hr|\/hour)?)?/gi,className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-1 rounded font-medium"},{regex:/\b(\d{2,3}k\s?-\s?\d{2,3}k|competitive salary|negotiable|doe|depending on experience)\b/gi,className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-1 rounded font-medium"},{regex:/\b(401\(?k\)?|health insurance|medical insurance|life insurance|pto|paid time off|paid vacation|sick leave|parental leave|maternity leave|paternity leave|equity|stock options|rsu|espp|dental|vision|wellness|gym membership|commuter benefits|tuition reimbursement|professional development|learning budget|signing bonus|annual bonus|performance bonus|relocation assistance|retirement|pension|profit sharing|employee discount|free meals|catered lunches|childcare|continuing education)\b/gi,className:"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 px-1 rounded font-medium"},{regex:/\b(remote|fully remote|remote-friendly|hybrid|on-site|onsite|in-office|work from anywhere|distributed team|flexible location|telecommute|virtual|field-based)\b/gi,className:"bg-teal-100 dark:bg-teal-900/30 text-teal-800 dark:text-teal-300 px-1 rounded font-medium"},{regex:/\b(\d+\+?\s?(years?|yrs?)\s?(of)?\s?(experience|exp)?|\d+\s?-\s?\d+\s?(years?|yrs?)|entry[- ]level|mid[- ]level|senior[- ]level|staff[- ]level|principal|lead|junior|senior|experienced|intern|internship|new grad|associate|manager|director|executive|vp|vice president|c-level|ceo|cfo|cto|coo)\b/gi,className:"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-300 px-1 rounded font-medium"},{regex:/\b(bachelor'?s?|master'?s?|phd|doctorate|mba|bs|ba|ms|ma|md|jd|dds|dmd|pharmd|dnp|msn|bsn|degree|diploma|certification|certified|license|licensed|board certified|cpa|cfa|cfp|pmp|shrm|aws certified|google certified|microsoft certified|scrum master|six sigma|osha|hipaa compliant|acls|bls|cpr certified|emt|paramedic|lpn|rn|np|pa-c|lcsw|lpc|lmft)\b/gi,className:"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 px-1 rounded font-medium"},{regex:/\b(javascript|typescript|python|java|c\+\+|c#|ruby|go|golang|rust|swift|kotlin|scala|php|perl|sql|nosql|html|css|sass|excel|word|powerpoint|outlook|quickbooks|sap|oracle|epic|cerner|meditech|autocad|solidworks|revit|photoshop|illustrator|indesign|premiere|final cut|logic pro|pro tools|ableton)\b/gi,className:"bg-rose-100 dark:bg-rose-900/30 text-rose-800 dark:text-rose-300 px-1 rounded font-medium"},{regex:/\b(react|angular|vue|node\.?js|express|django|flask|spring|\.net|rails|laravel|next\.?js|docker|kubernetes|aws|azure|gcp|terraform|jenkins|git|github|gitlab|jira|confluence|figma|tableau|power bi|salesforce|hubspot|mongodb|postgresql|mysql|redis|elasticsearch|graphql|rest api|microservices|ci\/cd|agile|scrum|kanban|lean|waterfall|seo|google analytics|mailchimp|hootsuite|buffer|slack|teams|zoom|asana|trello|monday\.com|notion|ai|artificial intelligence|ml|machine learning|deep learning|nlp|natural language processing|llm|large language model|generative ai|genai|computer vision|robotics|blockchain|iot|internet of things|cloud computing|big data|data science|saas|paas|iaas|algorithm|data structure|scalability|security|encryption|cybersecurity)\b/gi,className:"bg-cyan-100 dark:bg-cyan-900/30 text-cyan-800 dark:text-cyan-300 px-1 rounded font-medium"},{regex:/\b(communication skills|leadership|team player|problem[- ]solving|critical thinking|collaboration|cross[- ]functional|stakeholder management|project management|time management|self[- ]starter|detail[- ]oriented|analytical|creative|innovative|innovation|adaptable|fast[- ]paced|entrepreneurial|customer service|client facing|patient care|bedside manner|interpersonal|negotiation|presentation skills|public speaking|conflict resolution|emotional intelligence|multitasking|organizational skills|bilingual|multilingual|fluent in)\b/gi,className:"bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-300 px-1 rounded font-medium"},{regex:/\b(hiring immediately|urgent|asap|start immediately|immediate start|now hiring|actively hiring|fast[- ]track|priority hire|multiple openings|growing team|expanding|new position)\b/gi,className:"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 px-1 rounded font-medium"},{regex:/\b(diversity|inclusion|dei|equal opportunity|inclusive|work[- ]life balance|culture|values-driven|mission-driven|growth mindset|transparent|collaborative environment|supportive team|mentorship|career growth|promotion opportunities|family-owned|startup|fortune 500|non-profit|sustainability|green|eco-friendly)\b/gi,className:"bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 px-1 rounded font-medium"},{regex:/\b(patient care|clinical|icu|er|emergency room|operating room|surgery|outpatient|inpatient|acute care|long-term care|hospice|home health|telemedicine|telehealth|ehr|emr|electronic health records|hipaa|jcaho|cms|medicaid|medicare|insurance verification|prior authorization|medical billing|medical coding|icd-10|cpt|phlebotomy|vitals|medication administration|wound care|iv therapy|dialysis|oncology|pediatrics|geriatrics|obstetrics|cardiology|neurology|orthopedics|radiology|laboratory)\b/gi,className:"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-300 px-1 rounded font-medium"},{regex:/\b(financial analysis|budgeting|forecasting|gaap|ifrs|audit|tax|compliance|risk management|portfolio management|asset management|investment|trading|underwriting|due diligence|m&a|mergers and acquisitions|ipo|venture capital|private equity|hedge fund|mutual fund|securities|derivatives|fixed income|equities|commodities|forex|bloomberg|reuters|finra|sec|regulatory|anti-money laundering|aml|kyc|know your customer|sox|sarbanes-oxley)\b/gi,className:"bg-lime-100 dark:bg-lime-900/30 text-lime-800 dark:text-lime-300 px-1 rounded font-medium"},{regex:/\b(brand|branding|creative direction|art direction|copywriting|content creation|content marketing|social media marketing|digital marketing|email marketing|marketing automation|lead generation|conversion|roi|kpi|analytics|a\/b testing|ux|ui|user experience|user interface|wireframe|prototype|design system|typography|color theory|photography|videography|video editing|motion graphics|animation|storyboard|campaign|advertising|media buying|pr|public relations|influencer|brand ambassador)\b/gi,className:"bg-fuchsia-100 dark:bg-fuchsia-900/30 text-fuchsia-800 dark:text-fuchsia-300 px-1 rounded font-medium"},{regex:/\b(curriculum|lesson plan|classroom management|student engagement|differentiated instruction|iep|individualized education|special education|sped|esl|english as a second language|k-12|higher education|online learning|e-learning|lms|learning management|blackboard|canvas|moodle|tutoring|teaching assistant|ta|research assistant|ra|tenure|tenure-track|adjunct|professor|lecturer|department chair|academic advisor|student affairs|admissions|registrar|accreditation)\b/gi,className:"bg-sky-100 dark:bg-sky-900/30 text-sky-800 dark:text-sky-300 px-1 rounded font-medium"},{regex:/\b(journeyman|apprentice|master|licensed electrician|licensed plumber|hvac|refrigeration|carpentry|woodworking|welding|machining|cnc|blueprint|schematic|electrical code|nec|building code|osha|safety|ppe|hand tools|power tools|installation|maintenance|repair|troubleshooting|preventive maintenance|commercial|residential|industrial|construction|renovation|remodel|blueprint reading|estimating|bid|permit|inspection|foreman|superintendent|site manager|crew lead)\b/gi,className:"bg-stone-200 dark:bg-stone-800/50 text-stone-800 dark:text-stone-200 px-1 rounded font-medium"},{regex:/\b[\w\.-]+@[\w\.-]+\.\w{2,4}\b/gi,className:"text-indigo-600 dark:text-indigo-400 hover:underline font-medium cursor-pointer",type:"email"},{regex:/(https?:\/\/[^\s]+)/gi,className:"text-indigo-600 dark:text-indigo-400 hover:underline inline-flex items-center gap-0.5",type:"link"}],tr=[{color:"bg-green-100 dark:bg-green-900/30",label:"Salary & Compensation",examples:"$120k, $80k-100k/yr, Competitive Salary"},{color:"bg-blue-100 dark:bg-blue-900/30",label:"Benefits & Perks",examples:"401k, Health Insurance, Stock Options, PTO, Signing Bonus"},{color:"bg-teal-100 dark:bg-teal-900/30",label:"Work Arrangement",examples:"Remote, Hybrid, On-site, Work from Anywhere"},{color:"bg-orange-100 dark:bg-orange-900/30",label:"Experience Level",examples:"5+ years, Senior, Entry-level, Manager, Director"},{color:"bg-purple-100 dark:bg-purple-900/30",label:"Education & Certifications",examples:"Bachelor's, MBA, PhD, CPA, PMP, RN, Licensed"},{color:"bg-rose-100 dark:bg-rose-900/30",label:"Programming & Software",examples:"Python, JavaScript, Excel, AutoCAD, Photoshop"},{color:"bg-cyan-100 dark:bg-cyan-900/30",label:"Frameworks, Tools & AI",examples:"React, AWS, AI, Machine Learning, Jira"},{color:"bg-amber-100 dark:bg-amber-900/30",label:"Soft Skills",examples:"Leadership, Problem-solving, Communication, Bilingual"},{color:"bg-red-100 dark:bg-red-900/30",label:"Urgency Keywords",examples:"Hiring Immediately, ASAP, Now Hiring"},{color:"bg-indigo-100 dark:bg-indigo-900/30",label:"Company Culture",examples:"Diversity, Work-life Balance, Mentorship, Growth"},{color:"bg-emerald-100 dark:bg-emerald-900/30",label:"Healthcare Industry",examples:"Patient Care, ICU, HIPAA, EHR, Nursing"},{color:"bg-lime-100 dark:bg-lime-900/30",label:"Finance Industry",examples:"GAAP, Audit, Compliance, Risk, Investment"},{color:"bg-fuchsia-100 dark:bg-fuchsia-900/30",label:"Creative & Marketing",examples:"Branding, UX/UI, Content Marketing, SEO"},{color:"bg-sky-100 dark:bg-sky-900/30",label:"Education Industry",examples:"Curriculum, IEP, K-12, Tenure, LMS"},{color:"bg-stone-200 dark:bg-stone-800/50",label:"Trades & Services",examples:"Journeyman, HVAC, Electrician, OSHA, Blueprint"}],ar=({text:a})=>{const x=a.split(`
`),g=u=>{let m=[{text:u}];return rr.forEach(n=>{const c=[];m.forEach(h=>{if(h.type){c.push(h);return}const b=new RegExp(n.regex);let k=0,p;const d=h.text;for(b.lastIndex=0;(p=b.exec(d))!==null;)p.index===b.lastIndex&&b.lastIndex++,p.index>k&&c.push({text:d.substring(k,p.index)}),c.push({text:p[0],type:n.type||"highlight",className:n.className,match:p[0]}),k=p.index+p[0].length;k<d.length&&c.push({text:d.substring(k)})}),m=c}),m.map((n,c)=>n.type==="link"?e.jsxs("a",{href:n.text,target:"_blank",rel:"noopener noreferrer",className:n.className,onClick:h=>h.stopPropagation(),children:[n.text," ",e.jsx($,{size:10})]},c):n.type==="email"?e.jsx("a",{href:`mailto:${n.text}`,className:n.className,onClick:h=>h.stopPropagation(),children:n.text},c):n.type==="highlight"?e.jsx("span",{className:n.className,children:n.text},c):e.jsx("span",{children:n.text},c))};return e.jsx("div",{className:"space-y-4",children:x.map((u,m)=>u.trim()?e.jsx("p",{className:"leading-relaxed text-gray-600 dark:text-gray-300",children:g(u)},m):e.jsx("div",{className:"h-2"},m))})},sr=({isOpen:a,onClose:x})=>a?e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:x,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800 z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Smart Highlight Guide"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Important keywords are automatically highlighted to help you scan faster."})]}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:e.jsx(Q,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[tr.map((g,u)=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-6 h-6 rounded flex-shrink-0 mt-0.5 ${g.color}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:g.label}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:g.examples})]})]},u)),e.jsxs("div",{className:"flex items-start gap-4 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"w-6 h-6 flex-shrink-0 mt-0.5 flex items-center justify-center text-indigo-600",children:e.jsx($,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:"Links & Emails"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Clickable URLs and email addresses"})]})]})]})]})}):null,K=({job:a,onSelect:x,onAddToTracker:g,onApply:u,onMockInterview:m,onDelete:n,isAdding:c,isAdded:h,isApplied:b,formatSalary:k,getTimeAgo:p})=>e.jsxs("div",{onClick:()=>x(a),className:`group relative bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow cursor-pointer ${a.source!=="google"?"border-indigo-100 dark:border-indigo-900 ring-1 ring-indigo-500/10":""}`,children:[n&&e.jsx("button",{onClick:d=>{d.stopPropagation(),n(a.id||"",d)},className:"absolute top-2 left-2 p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all opacity-0 group-hover:opacity-100",title:"Remove from results",children:e.jsx(Qe,{size:14})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white group-hover:text-indigo-600 transition-colors",children:a.jobTitle}),a.source!=="google"&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300",children:"Partner"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-gray-600 dark:text-gray-300 font-medium",children:[e.jsx(ue,{className:"w-4 h-4"}),a.companyName]})]}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 capitalize",children:a.employmentType||"Full-time"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-y-2 gap-x-6 mt-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsxs("span",{children:[a.location," (",a.locationType,")"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{children:k(a.salaryMin,a.salaryMax,a.salaryCurrency)})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(be,{className:"w-4 h-4"}),e.jsxs("span",{children:["Posted ",p(a.publishedAt||a.createdAt)]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 line-clamp-2",children:a.description})})]}),e.jsxs("div",{className:"flex md:flex-col gap-3 justify-center min-w-[160px]",children:[e.jsx("button",{onClick:d=>g(a,d),disabled:c||h,className:`flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg border font-medium transition-all ${h?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-700 dark:text-green-400 cursor-default":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:c?e.jsx(A,{className:"w-4 h-4 animate-spin"}):h?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-4 h-4"}),"Added"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4"}),"Add to Tracker"]})}),a.applyUrl?e.jsxs("a",{href:a.applyUrl,target:"_blank",rel:"noopener noreferrer",onClick:d=>d.stopPropagation(),className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium transition-colors shadow-sm",children:["Apply Externally",e.jsx($,{className:"w-4 h-4"})]}):e.jsx("button",{onClick:d=>u(a,d),className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium transition-colors shadow-sm",children:b?"Reapply":"Apply Now"}),e.jsxs("button",{onClick:d=>m(a,d),className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 font-medium transition-colors shadow-sm",title:"Start a mock interview for this job",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Mock Interview"]}),b&&e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-green-600 font-medium",children:[e.jsx(me,{size:12})," Applied"]})]})]})]}),ir=async a=>{try{const x=Je(pe,"users",a,"jobSearchHistory"),g=Ie(x,$e("createdAt","desc"),Me(50));return(await Ee(g)).docs.map(m=>{const n=m.data();return{id:m.id,jobTitle:n.title||n.jobTitle||"Untitled Position",companyName:n.company||n.companyName||"Company Not Specified",location:n.location||"Remote / Unspecified",description:n.description||"",url:n.url||"",source:"google",hrUserId:"",department:"",locationType:"remote",employmentType:"full-time",responsibilities:[],requirements:[],niceToHave:[],salaryCurrency:"USD",benefits:[],status:"published",viewCount:0,applicationCount:0,createdAt:n.createdAt||new Date().toISOString(),updatedAt:n.updatedAt||new Date().toISOString(),...n}})}catch(x){return console.error("[getUserJobHistory] Error:",x),[]}},nr=async(a,x)=>{try{const g=Ue(pe,"users",a,"jobSearchHistory",x);return await Re(g),console.log(`[deleteUserJob] Deleted job ${x} from user ${a} history`),!0}catch(g){return console.error("[deleteUserJob] Error:",g),!1}},Lr=()=>{const{currentUser:a}=He(),{t:x}=Ve(),{addJobApplication:g,jobApplications:u}=Oe(),{resumes:m}=ze(),{addJob:n}=_e(),{checkCredit:c,CreditLimitModal:h}=We(),[b,k]=l.useState([]),[p,d]=l.useState([]),[M,T]=l.useState([]),[F,Z]=l.useState([]),[E,ye]=l.useState(10),[fe,ke]=l.useState(!0),[w,U]=l.useState(!1),[ve,ee]=l.useState(!1),[f,re]=l.useState({term:"",location:""}),[q,L]=l.useState(void 0),[te,we]=l.useState(!1),[G,ae]=l.useState(null),[R,se]=l.useState(new Set),[B,ie]=l.useState(new Set),[je,ne]=l.useState(!1),[o,P]=l.useState(null),[N,H]=l.useState(null),[S,oe]=l.useState(""),[le,Ne]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const t=await Ge();k(t),d(t)}catch(t){console.error("Error fetching jobs:",t)}finally{ke(!1)}})()},[]),l.useEffect(()=>{if(u.length>0){const r=new Set;u.forEach(t=>{if(t.jobPostURL&&t.jobPostURL.includes("id=")){const s=t.jobPostURL.split("id=")[1];s&&r.add(s)}else t.jobPostingId&&r.add(t.jobPostingId)}),se(t=>{const s=new Set(t);return r.forEach(i=>s.add(i)),s})}},[u]),l.useEffect(()=>{(async()=>{if(a)try{const t=await Xe(a.uid),s=new Set(t.map(i=>i.jobPostingId));ie(s)}catch(t){console.error("Error fetching user applications:",t)}})()},[a]),l.useEffect(()=>{(async()=>{if(a)try{const t=await ir(a.uid);Z(t),console.log(`Loaded ${t.length} saved jobs for user`)}catch(t){console.error("Error loading job history:",t)}})()},[a]);const de=async(r,t)=>{if(t.stopPropagation(),!!a)try{await nr(a.uid,r)&&(Z(i=>i.filter(y=>y.id!==r)),console.log(`Job ${r} deleted successfully`))}catch(s){console.error("Failed to delete job",s)}},Se=async r=>{if(r?.preventDefault(),!c()){console.warn("Insufficient AI credits for search");return}const t=f.term.trim(),s=f.location.trim();if(!t&&!s)d(b);else{const i=t.toLowerCase(),y=s.toLowerCase(),v=b.filter(j=>{const I=!t||j.jobTitle.toLowerCase().includes(i)||j.companyName.toLowerCase().includes(i)||j.description.toLowerCase().includes(i),ce=!s||j.location.toLowerCase().includes(y);return I&&ce});d(v)}U(!0),T([]),L(void 0),we(!0);try{const i=await W(t,s,E);i.jobs&&(T(i.jobs),L(i.nextPageToken))}catch(i){console.error("Google Job Search Failed",i);const y=i?.message||"Failed to search jobs. Please try again.";alert(`Search Error: ${y}`)}finally{U(!1)}},Ce=async()=>{if(!(!q||ve||!c())){ee(!0);try{const r=await W(f.term,f.location,E,q);r.jobs&&(T(t=>[...t,...r.jobs]),L(r.nextPageToken))}catch(r){console.error("Load More Failed",r)}finally{ee(!1)}}},Ae=async()=>{if(w||!c())return;const r=f.term.trim(),t=f.location.trim();if(!r&&!t)d(b);else{const s=r.toLowerCase(),i=t.toLowerCase(),y=b.filter(v=>{const j=!r||v.jobTitle.toLowerCase().includes(s)||v.companyName.toLowerCase().includes(s)||v.description.toLowerCase().includes(s),I=!t||v.location.toLowerCase().includes(i);return j&&I});d(y)}U(!0),T([]),L(void 0);try{const s=await W(r,t,E,void 0,!0);s.jobs&&(T(s.jobs),L(s.nextPageToken))}catch(s){console.error("Refresh Search Failed",s)}finally{U(!1)}},J=async(r,t)=>{if(t?.stopPropagation(),!a){C("/signin");return}ae(r.id);try{let s="";r.salaryMin&&r.salaryMax?s=`${r.salaryCurrency||"$"}${r.salaryMin.toLocaleString()} - ${r.salaryMax.toLocaleString()}`:r.salaryMin&&(s=`${r.salaryCurrency||"$"}${r.salaryMin.toLocaleString()}+`);let i="On-site";r.locationType==="remote"?i="Remote":r.locationType==="hybrid"&&(i="Hybrid");const y={jobTitle:r.jobTitle,companyName:r.companyName,location:r.location,jobPostURL:r.source==="google"?r.applyUrl||"":`${window.location.origin}/job-market?id=${r.id}`,jobDescription:r.description,applicationStatus:"To Apply",workModel:i,salaryRange:s,prep_RoleOverview:`Generated from job posting: ${r.jobTitle} at ${r.companyName}`};r.source!=="google"&&(y.jobPostingId=r.id),await g(y),r.source!=="google"&&Be(r.id),se(v=>new Set(v).add(r.id))}catch(s){console.error("Error adding to tracker:",s),alert("Failed to add to tracker.")}finally{ae(null)}},z=(r,t)=>{if(t?.stopPropagation(),r.source==="google"&&r.applyUrl){window.open(r.applyUrl,"_blank");return}if(!a){C("/signin");return}H(r),m.length>0&&oe(m[0].id)},Te=async()=>{if(!(!a||!N||!S)){Ne(!0);try{await Ke(N.id,a.uid,S),alert("Application submitted successfully!"),H(null),P(null),N&&ie(r=>new Set(r).add(N.id))}catch(r){console.error("Error submitting application:",r),alert("Failed to submit application. Please try again.")}}},O=async(r,t)=>{if(t?.stopPropagation(),!a){C("/signin");return}if(c())try{const s={title:r.jobTitle,company:r.companyName,location:r.location,description:r.description?.substring(0,500)||r.jobTitle,url:r.applyUrl||""},i=await n(s,[]),y=Fe(void 0,"us-west1"),j=await qe(y,"getInterviewAuthToken")(),{token:I}=j.data,Le=`https://careervivid-371634100960.us-west1.run.app/#/interview-studio/${i}?token=${I}`;window.open(Le,"_blank")}catch(s){console.error("Error starting mock interview:",s),alert("Failed to start mock interview. Please try again.")}},D=(r,t,s)=>{if(!r&&!t)return"Competitive";const i=s||"$";return r&&t?`${i}${r.toLocaleString()} - ${t.toLocaleString()}`:r?`${i}${r.toLocaleString()}+`:"Competitive"},_=r=>{if(!r)return"";const t=new Date,s=r instanceof Date?r:new Date(r);if(isNaN(s.getTime()))return"";const i=Math.floor((t.getTime()-s.getTime())/1e3);return i<60?"Just now":i<3600?`${Math.floor(i/60)}m ago`:i<86400?`${Math.floor(i/3600)}h ago`:i<604800?`${Math.floor(i/86400)}d ago`:s.toLocaleDateString()};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 font-sans",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"flex flex-col gap-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white tracking-tight hidden md:block",children:"Job Market"}),e.jsx("form",{onSubmit:Se,className:"flex-1 w-full md:max-w-4xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden flex items-center shadow-sm focus-within:ring-2 focus-within:ring-indigo-500 transition-shadow",children:[e.jsx("div",{className:"pl-4 text-gray-500",children:e.jsx(X,{size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[10px] font-semibold uppercase text-gray-500 dark:text-gray-400 px-3 pt-1.5",children:"What"}),e.jsx("input",{type:"text",placeholder:"Job title, keywords, or company",className:"w-full px-3 pb-1.5 text-sm bg-transparent border-none focus:ring-0 text-gray-900 dark:text-white placeholder-gray-400",value:f.term,onChange:r=>re({...f,term:r.target.value})})]})]}),e.jsxs("div",{className:"flex-1 bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden flex items-center shadow-sm focus-within:ring-2 focus-within:ring-indigo-500 transition-shadow",children:[e.jsx("div",{className:"pl-4 text-gray-500",children:e.jsx(V,{size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[10px] font-semibold uppercase text-gray-500 dark:text-gray-400 px-3 pt-1.5",children:"Where"}),e.jsx("input",{type:"text",placeholder:"City, state, or zip code",className:"w-full px-3 pb-1.5 text-sm bg-transparent border-none focus:ring-0 text-gray-900 dark:text-white placeholder-gray-400",value:f.location,onChange:r=>re({...f,location:r.target.value})})]})]}),e.jsxs("div",{className:"flex bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden items-center shadow-sm focus-within:ring-2 focus-within:ring-indigo-500 transition-shadow px-3",children:[e.jsx("div",{className:"text-[10px] font-semibold uppercase text-gray-500 dark:text-gray-400 mr-2",children:"Results"}),e.jsxs("select",{value:E,onChange:r=>ye(Number(r.target.value)),className:"bg-transparent border-none text-sm font-medium text-gray-900 dark:text-white focus:ring-0 py-2",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"})]})]}),e.jsx("button",{type:"submit",disabled:w,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-all active:scale-95 whitespace-nowrap flex items-center gap-2",children:w?e.jsx(A,{size:18,className:"animate-spin"}):"Find Jobs"})]})}),e.jsxs("div",{className:"flex gap-2 hidden md:flex",children:[e.jsx("button",{onClick:Ae,disabled:w,className:"p-2.5 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh Search",children:e.jsx(Ye,{className:`w-6 h-6 ${w?"animate-spin":""}`})}),e.jsx("button",{onClick:()=>C("/dashboard"),className:"p-2.5 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Dashboard",children:e.jsx(xe,{className:"w-6 h-6"})})]})]})})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:fe?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(A,{className:"w-10 h-10 text-indigo-600 animate-spin"})}):e.jsxs("div",{className:"space-y-10",children:[w?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-3",children:[e.jsx(A,{className:"w-8 h-8 text-indigo-600 animate-spin"}),e.jsx("p",{className:"text-gray-500",children:"Searching across the web..."})]}):M.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(X,{size:20,className:"text-indigo-600"})," New Search Results"]}),e.jsx("div",{className:"grid gap-4",children:M.map((r,t)=>e.jsx(K,{job:r,onSelect:P,onAddToTracker:J,onApply:z,onMockInterview:O,onDelete:de,isAdding:G===r.id,isAdded:R.has(r.id),isApplied:!1,formatSalary:D,getTimeAgo:_},`google-${r.id}-${t}`))}),q&&e.jsx("div",{className:"flex justify-center pt-8",children:e.jsx("button",{onClick:Ce,disabled:w,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):"Load More"})})]}):null,F.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2 border-t border-gray-200 dark:border-gray-700 pt-8",children:[e.jsx(be,{size:20,className:"text-indigo-600"})," Your Saved Search History"]}),e.jsx("div",{className:"grid gap-4",children:F.map(r=>e.jsx(K,{job:r,onSelect:P,onAddToTracker:J,onApply:z,onMockInterview:O,onDelete:de,isAdding:G===r.id,isAdded:R.has(r.id),isApplied:B.has(r.id),formatSalary:D,getTimeAgo:_},`saved-${r.id}`))})]}),p.length>0&&e.jsxs("div",{className:"space-y-4",children:[(M.length>0||te||F.length>0)&&e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2 border-t border-gray-200 dark:border-gray-700 pt-8",children:[e.jsx(ge,{size:20,className:"text-indigo-600"})," Featured Opportunities"]}),e.jsx("div",{className:"grid gap-4",children:p.map(r=>e.jsx(K,{job:r,onSelect:P,onAddToTracker:J,onApply:z,onMockInterview:O,isAdding:G===r.id,isAdded:R.has(r.id),isApplied:B.has(r.id),formatSalary:D,getTimeAgo:_},r.id))})]}),te&&p.length===0&&M.length===0&&e.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(X,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"No jobs found"}),e.jsx("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Try adjusting your search criteria."})]})]})}),o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800 z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.jobTitle}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-gray-600 dark:text-gray-300",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:o.companyName})]})]}),e.jsx("button",{onClick:()=>P(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(Q,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-full font-medium",children:[e.jsx(V,{className:"w-5 h-5 text-gray-500"}),o.location," (",o.locationType,")"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-full font-medium",children:[e.jsx(he,{className:"w-5 h-5 text-gray-500"}),D(o.salaryMin,o.salaryMax,o.salaryCurrency)]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-full capitalize font-medium",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-500"}),o.employmentType]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"About the Role"}),e.jsxs("button",{onClick:()=>ne(!0),className:"flex items-center gap-1 text-xs text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-400 transition-colors",children:[e.jsx(Ze,{size:14}),"Highlight Guide"]})]}),e.jsx(ar,{text:o.description})]}),o.source==="google"&&o.applyUrl&&e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-indigo-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-indigo-900 dark:text-indigo-200",children:"External Application"}),e.jsx("p",{className:"text-sm text-indigo-700 dark:text-indigo-300 mt-1",children:'This job is hosted on an external site. Click "Apply Externally" to proceed.'}),e.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-2",children:["AI search can make mistakes, so double-check it."," ",e.jsx("a",{href:"https://careervivid.app/policy#privacy",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-indigo-800 dark:hover:text-indigo-200",children:"Your privacy & careervivid"})]})]})]}),o.responsibilities&&o.responsibilities.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Responsibilities"}),e.jsx("ul",{className:"list-disc list-inside space-y-2 text-gray-600 dark:text-gray-300",children:o.responsibilities.map((r,t)=>e.jsx("li",{children:r},t))})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3 sticky bottom-0 bg-white dark:bg-gray-800",children:[R.has(o.id)?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:r=>J(o,r),className:"px-5 py-2.5 rounded-lg border border-gray-300 hover:bg-gray-50 text-gray-700 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 font-medium transition-colors flex items-center gap-2",children:[e.jsx(Y,{size:16}),"Add Again"]}),e.jsxs("button",{onClick:()=>C("/tracker"),className:"px-5 py-2.5 rounded-lg border border-gray-300 hover:bg-gray-50 text-gray-700 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 font-medium transition-colors flex items-center gap-2",children:[e.jsx(xe,{size:16}),"Go to Tracker"]})]}):e.jsxs("button",{onClick:r=>J(o,r),className:"px-5 py-2.5 rounded-lg border border-gray-300 hover:bg-gray-50 text-gray-700 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 font-medium transition-colors flex items-center gap-2",children:[e.jsx(Y,{size:16}),"Add to Tracker"]}),o.source==="google"&&o.applyUrl?e.jsxs("a",{href:o.applyUrl,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors flex items-center gap-2",children:["Apply Externally ",e.jsx($,{size:16})]}):e.jsx("button",{onClick:r=>z(o,r),className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors flex items-center gap-2",children:B.has(o.id)?"Reapply":"Apply Now"})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-lg shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Apply to ",N.companyName]}),e.jsx("button",{onClick:()=>H(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:e.jsx(Q,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Applying for"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:N.jobTitle})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Select Resume"}),m.length===0?e.jsxs("div",{className:"text-center py-6 bg-gray-50 dark:bg-gray-900 rounded-lg border border-dashed border-gray-300 dark:border-gray-700",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-3",children:"No resumes found."}),e.jsx("button",{onClick:()=>C("/newresume"),className:"text-indigo-600 font-medium hover:underline text-sm",children:"Create a resume first"})]}):e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:m.map(r=>e.jsxs("label",{className:`flex items-center gap-3 p-4 rounded-xl border cursor-pointer transition-all ${S===r.id?"border-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 ring-1 ring-indigo-600":"border-gray-200 dark:border-gray-700 hover:border-indigo-300"}`,children:[e.jsx("input",{type:"radio",name:"resume",value:r.id,checked:S===r.id,onChange:t=>oe(t.target.value),className:"w-4 h-4 text-indigo-600 focus:ring-indigo-500 border-gray-300"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:r.title}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["Last updated: ",new Date(r.updatedAt).toLocaleDateString()]})]}),e.jsx(De,{className:`w-5 h-5 ${S===r.id?"text-indigo-600":"text-gray-400"}`})]},r.id))})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>H(null),className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg font-medium",children:"Cancel"}),e.jsx("button",{onClick:Te,disabled:le||!S||m.length===0,className:"flex items-center gap-2 px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:le?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(er,{className:"w-4 h-4"}),"Submit Application"]})})]})]})}),e.jsx(sr,{isOpen:je,onClose:()=>ne(!1)}),e.jsx(h,{})]})};export{Lr as default};
