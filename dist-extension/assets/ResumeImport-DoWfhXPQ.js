import{r as d,j as e,L as P,F as V}from"./main-Bi0Ei0w3.js";import{u as I}from"./index-C5AMH0Ns.js";import{i as z,g as L,m as G,p as M,G as O}from"./pdf.worker.min-BQwZFW_Z.js";import{u as q}from"./useTranslation-B90S8UVY.js";import{A as F}from"./alert-circle-C27T-kzG.js";import{U as X}from"./upload-cloud-FT8IZRv8.js";O.workerSrc=M;const se=({onImport:c,onFileProcessed:x,value:y,onChange:n,placeholder:h,isReadOnly:o=!1,className:b,children:m,variant:k="modern"})=>{const{t:a}=q(),[s,v]=d.useState(!1),[p,g]=d.useState(null),[w,u]=d.useState(!1),[A,j]=d.useState(""),_=y!==void 0?y:A,N=r=>{const t=r.target.value;n?n(t):j(t)},E=async r=>{const t=await r.arrayBuffer(),i=await L({data:t}).promise;let C="";for(let f=1;f<=i.numPages;f++){const B=(await(await i.getPage(f)).getTextContent()).items.map(U=>U.str).join(" ");C+=B+`

`}return C},S=async r=>{const t=await r.arrayBuffer();return(await G.extractRawText({arrayBuffer:t})).value},$=async r=>{v(!0),g(null);let t="";try{if(r.type==="application/pdf")t=await E(r);else if(r.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||r.name.endsWith(".docx"))t=await S(r);else if(r.type==="text/plain"||r.type==="text/markdown"||r.name.endsWith(".txt")||r.name.endsWith(".md"))t=await r.text();else throw new Error(a("resume_form.unsupported_file_type","Unsupported file type. Please upload PDF, DOCX, or TXT."));if(!t.trim())throw new Error(a("resume_form.empty_file","Could not extract text from file."));n?n(t):j(t),x&&x(t),c&&await c(t)}catch(i){console.error("File processing error:",i),g(i.message||a("resume_form.import_error","Failed to process file."))}finally{v(!1)}},R=d.useCallback((r,t)=>{if(t.length>0){g(a("resume_form.invalid_file","Invalid file type. Please upload PDF, DOCX, or TXT."));return}r.length>0&&$(r[0])},[a,n,x,c]),{getRootProps:D,getInputProps:T,isDragActive:l,open:W}=I({onDrop:R,accept:{"application/pdf":[".pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"text/plain":[".txt",".md",".markdown"]},maxFiles:1,disabled:s||o,noClick:k==="modern",onDragEnter:()=>u(!0),onDragLeave:()=>u(!1),onDropAccepted:()=>u(!1)});return k==="modern"?e.jsxs("div",{className:`w-full ${b||""}`,children:[p&&e.jsxs("div",{className:"mb-3 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm flex items-start animate-in slide-in-from-top-2",children:[e.jsx(F,{size:16,className:"mt-0.5 mr-2 flex-shrink-0"}),e.jsx("span",{children:p})]}),e.jsxs("div",{...D(),className:`
                    relative flex items-end gap-2 p-2 rounded-xl border transition-all duration-300
                    ${l||w?"border-primary-500 bg-primary-50 dark:bg-primary-900/20 ring-2 ring-primary-500/20":"border-transparent bg-gray-100 dark:bg-gray-800 focus-within:ring-2 focus-within:ring-primary-500/20 focus-within:border-primary-500/50"}
                    ${o?"cursor-not-allowed opacity-60":""}
                `,children:[e.jsx("input",{...T()}),e.jsx("button",{type:"button",onClick:W,disabled:s||o,className:"flex-shrink-0 p-3 text-gray-500 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 transition-colors",children:s?e.jsx(P,{size:20,className:"animate-spin text-primary-500"}):e.jsx(X,{size:20})}),e.jsx("div",{className:"flex-grow relative min-h-[46px] flex items-center",children:e.jsx(z,{minRows:1,maxRows:8,placeholder:l?a("resume_form.drop_file_here","Drop file here..."):h||a("resume_form.paste_placeholder","Paste your resume content here..."),className:"w-full bg-transparent border-none text-gray-800 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 text-base resize-none focus:ring-0 focus:outline-none outline-none p-0 m-0 leading-relaxed",value:_,onChange:N,disabled:s||o,onPaste:r=>{}})}),m&&e.jsx("div",{className:"flex-shrink-0",children:m})]}),e.jsx("div",{className:"flex justify-between mt-2 px-1",children:e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:a("resume_form.supports_formats","Supports PDF, DOCX, TXT")})})]}):e.jsxs("div",{className:`w-full ${b||""}`,children:[e.jsxs("div",{...D(),className:`
                    relative group border-2 border-dashed rounded-xl p-6 transition-all duration-300
                    flex flex-col items-center justify-center text-center min-h-[160px]
                    ${l||w?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-300 dark:border-gray-600 bg-gray-50/50 dark:bg-gray-900/30 hover:border-primary-400 dark:hover:border-primary-500 hover:bg-white dark:hover:bg-gray-800"}
                    ${o?"cursor-not-allowed opacity-60":"cursor-pointer"}
                `,children:[e.jsx("input",{...T()}),s?e.jsxs("div",{className:"flex flex-col items-center animate-in fade-in duration-300",children:[e.jsx(P,{className:"w-10 h-10 text-primary-500 animate-spin mb-3"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:a("resume_form.analyzing_document","Analyzing document...")})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`
                            p-3 rounded-full mb-3 transition-colors duration-300
                            ${l?"bg-primary-100 text-primary-600 dark:bg-primary-900/50 dark:text-primary-400":"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400 group-hover:bg-primary-100 group-hover:text-primary-600 dark:group-hover:bg-primary-900/50 dark:group-hover:text-primary-400"}
                        `,children:e.jsx(X,{size:24})}),e.jsx("h3",{className:"text-sm font-bold text-gray-800 dark:text-gray-100 mb-1",children:l?a("resume_form.drop_file_here","Drop file here"):a("resume_form.click_upload_drag","Click to Upload or Drag & Drop")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:a("resume_form.supports_formats","Supports PDF, DOCX, TXT")})]}),!s&&e.jsxs("div",{className:"w-full flex items-center gap-4 my-2 px-8 opacity-60",children:[e.jsx("div",{className:"h-px bg-gray-300 dark:bg-gray-600 flex-1"}),e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:a("resume_form.or_paste_text","OR PASTE TEXT")}),e.jsx("div",{className:"h-px bg-gray-300 dark:bg-gray-600 flex-1"})]})]}),p&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm flex items-start animate-in slide-in-from-top-2",children:[e.jsx(F,{size:16,className:"mt-0.5 mr-2 flex-shrink-0"}),e.jsx("span",{children:p})]}),e.jsxs("div",{className:"mt-4 relative",children:[e.jsx(z,{minRows:3,maxRows:20,placeholder:h||a("resume_form.paste_placeholder","Paste your resume content here..."),className:"w-full p-4 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all shadow-sm resize-none",value:_,onChange:N,disabled:s||o}),e.jsx("div",{className:"absolute bottom-2 right-2 pointer-events-none",children:e.jsx(V,{size:14,className:"text-gray-300 dark:text-gray-600"})})]}),m&&e.jsx("div",{className:"mt-4 flex justify-end",children:m})]})};export{se as R};
