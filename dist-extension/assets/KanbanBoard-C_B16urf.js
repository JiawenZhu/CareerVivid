import{u as Ie,r as o,j as e,W as pe,Z as De,L as X,p as Te}from"./main-Bi0Ei0w3.js";import{A as ae,W as xe}from"./types-C3IBSKjb.js";import{u as ge}from"./useResumes-B7mK0cuD.js";import{r as Ee,b as Ae,j as $e}from"./geminiService-BYmLfnZm.js";import{C as Oe}from"./ConfirmationModal-B6wF7Rbq.js";import{u as ze}from"./useAICreditCheck-BMgBfCvH.js";import{u as z}from"./useTranslation-B90S8UVY.js";import{V as Me}from"./volume-2-CWjJsluY.js";import{R as Pe,M as Ve,S as Le}from"./square-C379bsky.js";import{T as Ue}from"./trash-2-DdUTv7KT.js";import{X as Fe}from"./x-BVB0Dpji.js";import{W as se}from"./wand-2-DAhyBf_Z.js";import{A as Ke}from"./arrow-right-6YPb1yqF.js";import{C as He}from"./check-circle-D957SXgC.js";import{X as We}from"./x-circle-CxMxRQAw.js";import{C as Je}from"./chevron-down-Ca9bpypi.js";import{P as Be}from"./play-DVOSIuGe.js";const I=({label:a,value:g,onChange:i,type:c="text",placeholder:l})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:a}),e.jsx("input",{type:c,value:g||"",onChange:u=>i(u.target.value),placeholder:l,className:"mt-1 block w-full bg-transparent border-b border-gray-300 dark:border-gray-600 focus:outline-none focus:border-primary-500 transition-colors"})]}),me=({label:a,value:g,onChange:i,options:c})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:a}),e.jsx("select",{value:g||"",onChange:l=>i(l.target.value),className:"mt-1 block w-full bg-transparent border-b border-gray-300 dark:border-gray-600 focus:outline-none focus:border-primary-500 transition-colors dark:bg-gray-800",children:c.map(l=>e.jsx("option",{value:l,children:l},l))})]}),F=({label:a,value:g,onChange:i,placeholder:c,onRegenerate:l,selectedVoice:u})=>{const{t:r}=z(),[p,d]=o.useState(!1),[h,s]=o.useState(g),[w,D]=o.useState(!1),[T,S]=o.useState(null),_=o.useRef(null);o.useEffect(()=>{s(g)},[g]),o.useEffect(()=>{p&&_.current&&(_.current.style.height="auto",_.current.style.height=`${_.current.scrollHeight}px`,_.current.focus())},[p,h]);const C=()=>{d(!1),h!==g&&i(h)},R=j=>{s(j.target.value),j.target.style.height="auto",j.target.style.height=`${j.target.scrollHeight}px`},M=j=>j.replace(/\*\*/g,""),Q=j=>{if(j.stopPropagation(),window.speechSynthesis.speaking&&w)window.speechSynthesis.cancel(),D(!1),S(null);else{window.speechSynthesis.cancel();const k=M(g||c||"No text available."),b=new SpeechSynthesisUtterance(k);u&&(b.voice=u),b.onboundary=f=>{f.name==="word"&&S({start:f.charIndex,end:f.charIndex+f.charLength})},b.onend=()=>{D(!1),S(null)},b.onerror=()=>{D(!1),S(null)},window.speechSynthesis.speak(b),D(!0)}},P=()=>{if(!g)return e.jsx("span",{className:"text-gray-400 italic",children:c});if(!w||!T)return g.split(/(\*\*.*?\*\*)/g).map((b,f)=>b.startsWith("**")&&b.endsWith("**")?e.jsx("strong",{children:b.slice(2,-2)},f):e.jsx("span",{children:b},f));const j=g.split(/(\*\*.*?\*\*)/g);let E=0;return j.map((k,b)=>{const f=k.startsWith("**")&&k.endsWith("**"),y=f?k.slice(2,-2):k,V=E,Y=E+y.length;if(E+=y.length,T.end>V&&T.start<Y){const K=Math.max(0,T.start-V),L=Math.min(y.length,T.end-V),H=y.substring(0,K),W=y.substring(K,L),A=y.substring(L),v=f?"strong":"span";return e.jsxs(v,{children:[H,e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900/50 rounded-sm px-0.5 transition-colors duration-75",children:W}),A]},b)}return f?e.jsx("strong",{children:y},b):e.jsx("span",{children:y},b)})};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Q,title:w?"Stop Reading":"Read Aloud",className:`p-1 transition-colors rounded-full ${w?"text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20":"text-indigo-600 hover:bg-indigo-50 dark:text-indigo-400 dark:hover:bg-indigo-900/20"}`,children:w?e.jsx(Le,{size:18,fill:"currentColor"}):e.jsx(Be,{size:18,fill:"currentColor"})}),e.jsx("button",{onClick:l,title:"Regenerate with AI",className:"text-primary-500 hover:text-primary-700 dark:hover:text-primary-300 p-1",children:e.jsx(se,{size:18})})]})]}),e.jsx("div",{className:"cursor-pointer group min-h-[60px] p-2 -ml-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>!p&&d(!0),children:p?e.jsx("textarea",{ref:_,value:h||"",onChange:R,onBlur:C,onKeyDown:j=>{j.key==="Escape"&&C()},className:"w-full p-2 border rounded focus:ring-2 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 resize-none overflow-hidden",placeholder:c,autoFocus:!0}):e.jsx("div",{className:"whitespace-pre-wrap text-gray-700 dark:text-gray-300",children:P()})})]})},Ge=({sectionName:a,onClose:g,onRegenerate:i})=>{const{t:c}=z(),[l,u]=o.useState(""),[r,p]=o.useState(!1),d=async()=>{p(!0),await i(l),p(!1),g()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:c("job_tracker.modal.regenerate_modal_title",{section:a})}),e.jsx("textarea",{value:l,onChange:h=>u(h.target.value),placeholder:c("job_tracker.modal.regenerate_placeholder"),className:"w-full p-2 border rounded-md mb-4 bg-white dark:bg-gray-700 dark:border-gray-600",rows:3}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-md",children:c("common.cancel")}),e.jsxs("button",{onClick:d,disabled:r,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:bg-primary-300 flex items-center gap-2",children:[r&&e.jsx(X,{size:16,className:"animate-spin"}),c(r?"job_tracker.modal.regenerating":"job_tracker.modal.regenerate")]})]})]})})},ft=({job:a,onClose:g,onUpdate:i,onDelete:c,highlightGenerateButton:l=!1})=>{const{currentUser:u}=Ie(),{t:r}=z(),{resumes:p}=ge(),{checkCredit:d,CreditLimitModal:h}=ze(),[s,w]=o.useState(a),[D,T]=o.useState(!1),[S,_]=o.useState(!1),[C,R]=o.useState(null),[M,Q]=o.useState(!1),[P,j]=o.useState(1),[E,k]=o.useState(!1),[b,f]=o.useState(!1),y=o.useRef(null),[V,Y]=o.useState(l),[K,L]=o.useState(!1),H=o.useRef(null),W=o.useRef(a.prep_RoleOverview),{resumes:A}=ge(),[v,ne]=o.useState(""),[N,J]=o.useState(null),[Z,oe]=o.useState(!1),[le,B]=o.useState("");o.useEffect(()=>{v&&s.matchAnalyses?J(s.matchAnalyses[v]||null):J(null)},[v,s.matchAnalyses]),o.useEffect(()=>{w(a)},[a]),o.useEffect(()=>{A.length>0&&!v&&ne(A[0].id)},[A,v]),o.useEffect(()=>{if(!W.current&&a.prep_RoleOverview){const t=setTimeout(()=>{H.current?.scrollIntoView({behavior:"smooth",block:"center"}),L(!0)},100),n=setTimeout(()=>{L(!1)},2100);return()=>{clearTimeout(t),clearTimeout(n)}}W.current=a.prep_RoleOverview},[a.prep_RoleOverview]);const ie=t=>{j(n=>t==="increase"?Math.min(2,n+1):Math.max(0,n-1))},he=["text-sm","text-base","text-lg"][P];o.useEffect(()=>{const t=n=>{n.key==="Escape"&&g()};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[g]),o.useEffect(()=>{b&&y.current&&(y.current.style.height="auto",y.current.style.height=`${y.current.scrollHeight} px`,y.current.focus())},[b,s.jobDescription]),o.useEffect(()=>{const t=setTimeout(()=>{JSON.stringify(s)!==JSON.stringify(a)&&i(s.id,s)},1e3);return()=>clearTimeout(t)},[s,i,a]);const x=(t,n)=>{w(m=>({...m,[t]:n}))},be=t=>{if(t){const n=new Date(t+"T00:00:00");x("dateApplied",n)}else x("dateApplied",null)},fe=t=>t?(t.toDate?t.toDate():new Date(t)).toISOString().split("T")[0]:"",ye=()=>{k(!0)},je=()=>{T(!0),c(a.id),k(!1),g()},ce=()=>{const t=p[0];if(!t)return"No resume available.";let n=`Name: ${t.personalDetails.firstName} ${t.personalDetails.lastName} 
`;return n+=`Job Title: ${t.personalDetails.jobTitle} 

SUMMARY: 
${t.professionalSummary} 

`,t.employmentHistory.length>0&&(n+=`EXPERIENCE: 
`,t.employmentHistory.forEach(m=>{n+=`- ${m.jobTitle} at ${m.employer} 
${m.description} 
`})),t.skills.length>0&&(n+=`
SKILLS: ${t.skills.map(m=>m.name).join(", ")} 
`),n},ve=async()=>{if(u&&d()){Y(!1),_(!0);try{const t=ce(),n=await $e(u.uid,s,t);i(s.id,{...s,...n})}catch(t){alert(t instanceof Error?t.message:"Failed to generate notes.")}finally{_(!1)}}},ke=async t=>{if(!u||!C||!d())return;const n=ce();try{const m=await Ee(u.uid,C.name,s,n,t);x(C.section,m)}catch(m){alert(m instanceof Error?m.message:"Failed to regenerate section.")}},we=t=>{let n=`Title: ${t.personalDetails.jobTitle} 

`;return n+=`Summary: ${t.professionalSummary} 

`,n+=`Skills: ${t.skills.map(m=>m.name).join(", ")} 

`,n+=`Experience:
`,t.employmentHistory.forEach(m=>{n+=`- ${m.jobTitle} at ${m.employer} 
${m.description} 
`}),n+=`
Education:
`,t.education.forEach(m=>{n+=`- ${m.degree} from ${m.school} 
`}),n},Ne=async()=>{if(!u||!v||!s.jobDescription){B("A resume must be selected and the job must have a description.");return}if(!d())return;const t=A.find(n=>n.id===v);if(!t){B("Could not find the selected resume.");return}oe(!0),J(null),B("");try{const n=we(t),m=await Ae(u.uid,n,s.jobDescription);J(m);const $={...s.matchAnalyses||{},[v]:m};x("matchAnalyses",$)}catch(n){B(n instanceof Error?n.message:"An unknown error occurred during analysis.")}finally{oe(!1)}},_e=()=>{sessionStorage.setItem("jobDescriptionForOptimization",a.jobDescription||""),sessionStorage.setItem("jobTitleForOptimization",a.jobTitle||""),N?sessionStorage.setItem("jobMatchAnalysis",JSON.stringify(N)):sessionStorage.removeItem("jobMatchAnalysis"),Te(`/ edit / ${v} `)},[de,Se]=o.useState([]),[O,U]=o.useState(null),[ee,te]=o.useState(!1);o.useEffect(()=>{const t=()=>{const n=Array.from(window.speechSynthesis.getVoices()),m=n.filter(G=>G.name.includes("Google")),$=m.length>0?m:n;if(Se($),$.length>0){const G=localStorage.getItem("preferredVoiceURI");if(G){const q=$.find(re=>re.voiceURI===G);q&&U(q)}else{const q=$.find(re=>re.name.includes("Google US English"))||$[0];U(q)}}};t(),window.speechSynthesis.onvoiceschanged=t},[]);const Ce=t=>{U(t),localStorage.setItem("preferredVoiceURI",t.voiceURI),te(!1)},Re=()=>{localStorage.removeItem("preferredVoiceURI");const t=window.speechSynthesis.getVoices();if(t.length>0){const n=t.find(m=>m.name.includes("Google US English"));U(n||t[0])}te(!1)};return e.jsxs("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",children:[e.jsx(h,{}),C&&e.jsx(Ge,{sectionName:C.name,onClose:()=>R(null),onRegenerate:ke}),E&&e.jsx(Oe,{isOpen:E,title:r("job_tracker.modal.delete_title"),message:r("job_tracker.modal.delete_confirm"),onConfirm:je,onCancel:()=>k(!1),confirmText:r("job_tracker.modal.delete_btn")}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-4xl h-[95vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center flex-shrink-0 relative",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-md flex items-center justify-center",children:e.jsx(pe,{size:22,className:"text-gray-500 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:s.jobTitle}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.companyName})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>te(!ee),className:`p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${ee?"bg-gray-100 dark:bg-gray-700 text-primary-600 dark:text-primary-400":"text-gray-500 dark:text-gray-400"}`,title:"Voice Settings",children:e.jsx(Me,{size:20})}),ee&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-72 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl z-50 p-2 max-h-80 overflow-y-auto flex flex-col gap-1",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase mb-1 px-2 mt-1",children:"Select Voice"}),e.jsxs("button",{onClick:Re,className:"w-full text-left px-2 py-1.5 text-xs font-medium text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md flex items-center gap-2 mb-2 border-b border-gray-100 dark:border-gray-700 pb-2",children:[e.jsx(Pe,{size:12})," Reset to Default"]}),de.map(t=>e.jsxs("button",{onClick:()=>Ce(t),className:`w-full text-left px-2 py-1.5 text-sm rounded-md truncate transition-colors flex justify-between items-center ${O?.voiceURI===t.voiceURI?"bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 font-medium":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:[e.jsx("span",{className:"truncate flex-1",children:t.name}),e.jsx("span",{className:"text-xs text-gray-400 ml-2 whitespace-nowrap",children:t.lang})]},t.voiceURI)),de.length===0&&e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"No voices found"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Your browser may not support voices without interaction."})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 mr-2 border-r pr-2 border-gray-300 dark:border-gray-600",children:[e.jsx("button",{onClick:()=>ie("decrease"),disabled:P===0,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Ve,{size:18})}),e.jsx("button",{onClick:()=>ie("increase"),disabled:P===2,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(De,{size:18})})]}),e.jsx("button",{onClick:ye,disabled:D,className:"p-2 text-gray-500 hover:text-red-500 hover:bg-red-100 dark:hover:bg-red-900/50 rounded-full",children:D?e.jsx(X,{className:"animate-spin"}):e.jsx(Ue,{})}),e.jsx("button",{onClick:g,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Fe,{})})]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6 sm:p-8 bg-gray-100 dark:bg-gray-900",children:[e.jsxs("div",{className:"p-6 mb-8 bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[e.jsx(I,{label:r("job_tracker.modal.job_title"),value:s.jobTitle,onChange:t=>x("jobTitle",t),placeholder:"e.g., Software Engineer"}),e.jsx(I,{label:r("job_tracker.modal.company"),value:s.companyName,onChange:t=>x("companyName",t),placeholder:"e.g., Google"}),e.jsx(I,{label:r("job_tracker.modal.location"),value:s.location||"",onChange:t=>x("location",t),placeholder:"e.g., San Francisco, CA"}),e.jsx(I,{label:r("job_tracker.modal.salary_range"),value:s.salaryRange||"",onChange:t=>x("salaryRange",t),placeholder:"e.g., $120k - $150k"}),e.jsx(me,{label:r("job_tracker.modal.status.label",{defaultValue:"Status"}),value:s.applicationStatus,onChange:t=>x("applicationStatus",t),options:ae}),e.jsx(me,{label:r("job_tracker.modal.work_model"),value:s.workModel||"",onChange:t=>x("workModel",t),options:xe}),e.jsx(I,{label:r("job_tracker.modal.interview_stage"),value:s.interviewStage||"",onChange:t=>x("interviewStage",t),placeholder:"e.g., Technical Screen"}),e.jsx(I,{label:r("job_tracker.modal.date_applied"),value:fe(s.dateApplied),onChange:be,type:"date"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(I,{label:r("job_tracker.modal.job_post_url"),value:s.jobPostURL,onChange:t=>x("jobPostURL",t)}),e.jsx(I,{label:r("job_tracker.modal.direct_app_url"),value:s.applicationURL||"",onChange:t=>x("applicationURL",t)})]})]}),e.jsxs("div",{className:"p-6 mb-8 bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-4",children:r("job_tracker.modal.resume_match")}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:r("job_tracker.modal.compare_resume")}),e.jsx("select",{value:v,onChange:t=>ne(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700",children:A.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))})]}),e.jsxs("button",{onClick:Ne,disabled:Z||!s.jobDescription,className:"w-full sm:w-auto mt-2 sm:mt-6 bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 disabled:bg-indigo-300",children:[Z?e.jsx(X,{className:"animate-spin"}):e.jsx(se,{}),r(Z?"job_tracker.modal.analyzing":"job_tracker.modal.analyze_match")]})]}),le&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:le}),N&&e.jsxs("div",{className:"mt-6 bg-blue-600/10 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsxs("span",{children:[N.matchedKeywords.length," of ",N.totalKeywords," keywords found"]}),e.jsxs("span",{className:"text-lg",children:[Math.round(N.matchPercentage),"% Match"]})]}),e.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2.5 mt-2",children:e.jsx("div",{className:"bg-blue-500 h-2.5 rounded-full",style:{width:`${N.matchPercentage}% `}})})]}),e.jsxs("button",{onClick:_e,className:"flex-shrink-0 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[r("job_tracker.modal.optimize_resume")," ",e.jsx(Ke,{size:18})]})]}),e.jsxs("div",{className:"mt-4 text-sm",children:[e.jsx("p",{className:"font-semibold mb-2",children:N.summary}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-green-700 dark:text-green-400 flex items-center gap-1",children:[e.jsx(He,{size:16})," ",r("job_tracker.modal.matched_keywords")]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:N.matchedKeywords.map(t=>e.jsx("span",{className:"bg-green-200/50 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs px-2 py-0.5 rounded-md",children:t},t))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-yellow-700 dark:text-yellow-400 flex items-center gap-1",children:[e.jsx(We,{size:16})," ",r("job_tracker.modal.missing_keywords")]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:N.missingKeywords.map(t=>e.jsx("span",{className:"bg-yellow-200/50 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300 text-xs px-2 py-0.5 rounded-md",children:t},t))})]})]})]})]})]}),s.jobDescription&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsxs("button",{onClick:()=>Q(!M),className:"w-full flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:r("job_tracker.modal.job_description")}),e.jsx(Je,{className:`transition - transform duration - 200 ${M?"rotate-180":""} `})]}),M&&e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-gray-700",children:b?e.jsx("textarea",{ref:y,value:s.jobDescription||"",onChange:t=>{x("jobDescription",t.target.value),t.target.style.height="auto",t.target.style.height=`${t.target.scrollHeight} px`},onBlur:()=>f(!1),onKeyDown:t=>t.key==="Escape"&&f(!1),className:"w-full p-2 text-inherit leading-relaxed bg-white dark:bg-gray-700/50 rounded-md border-2 border-primary-500 focus:outline-none resize-none overflow-hidden"}):e.jsx("div",{onClick:()=>f(!0),className:"w-full min-h-[40px] p-2 rounded-md border border-transparent hover:bg-gray-200/50 dark:hover:bg-gray-700/30 transition-colors cursor-pointer max-h-60 overflow-y-auto",children:e.jsx("p",{className:"text-inherit text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:s.jobDescription})})})]}),e.jsx("div",{className:"text-center mb-8",children:e.jsxs("button",{onClick:ve,disabled:S,className:`bg - primary - 600 text - white font - semibold py - 2 px - 6 rounded - lg shadow - md hover: bg - primary - 700 transition - colors flex items - center justify - center gap - 2 disabled: bg - primary - 300 mx - auto ${V?"animate-gentle-pulse":""} `,children:[S?e.jsx(X,{className:"animate-spin"}):e.jsx(se,{}),r(S?"job_tracker.modal.generating":"job_tracker.modal.generate_prep")]})}),e.jsxs("div",{className:`space - y - 10 ${he} transition - all duration - 300 ${K?"animate-highlight p-4 -m-4 rounded-xl":""} `,ref:H,children:[e.jsx(F,{label:r("job_tracker.modal.prep_sections.role_research"),value:s.prep_RoleOverview||"",onChange:t=>x("prep_RoleOverview",t),placeholder:r("job_tracker.modal.prep_sections.role_research_ph"),onRegenerate:()=>R({section:"prep_RoleOverview",name:r("job_tracker.modal.prep_sections.role_research")}),selectedVoice:O}),e.jsx(F,{label:r("job_tracker.modal.prep_sections.my_story"),value:s.prep_MyStory||"",onChange:t=>x("prep_MyStory",t),placeholder:r("job_tracker.modal.prep_sections.my_story_ph"),onRegenerate:()=>R({section:"prep_MyStory",name:r("job_tracker.modal.prep_sections.my_story")}),selectedVoice:O}),e.jsx(F,{label:r("job_tracker.modal.prep_sections.interview_prep"),value:s.prep_InterviewPrep||"",onChange:t=>x("prep_InterviewPrep",t),placeholder:r("job_tracker.modal.prep_sections.interview_prep_ph"),onRegenerate:()=>R({section:"prep_InterviewPrep",name:r("job_tracker.modal.prep_sections.interview_prep")}),selectedVoice:O}),e.jsx(F,{label:r("job_tracker.modal.prep_sections.questions_for_them"),value:s.prep_QuestionsForInterviewer||"",onChange:t=>x("prep_QuestionsForInterviewer",t),placeholder:r("job_tracker.modal.prep_sections.questions_for_them_ph"),onRegenerate:()=>R({section:"prep_QuestionsForInterviewer",name:r("job_tracker.modal.prep_sections.questions_for_them")}),selectedVoice:O}),e.jsx(F,{label:r("job_tracker.modal.prep_sections.general_notes"),value:s.notes||"",onChange:t=>x("notes",t),placeholder:r("job_tracker.modal.prep_sections.general_notes_ph"),onRegenerate:()=>R({section:"notes",name:r("job_tracker.modal.prep_sections.general_notes")}),selectedVoice:O})]})]})]})]})},qe={"To Apply":"bg-gray-400",Applied:"bg-blue-500",Interviewing:"bg-yellow-500",Offered:"bg-green-500",Rejected:"bg-red-500"},Xe={"To Apply":"stroke-gray-400",Applied:"stroke-blue-500",Interviewing:"stroke-yellow-500",Offered:"stroke-green-500",Rejected:"stroke-red-500"},Qe=({data:a})=>{const{t:g}=z(),i=150,c=20,l=(i-c)/2,u=2*Math.PI*l,r=a.reduce((d,h)=>d+h.value,0);let p=0;return e.jsxs("div",{className:"relative",style:{width:i,height:i},children:[e.jsxs("svg",{width:i,height:i,viewBox:`0 0 ${i} ${i}`,className:"-rotate-90",children:[e.jsx("circle",{className:"stroke-gray-200 dark:stroke-gray-700",strokeWidth:c,fill:"transparent",r:l,cx:i/2,cy:i/2}),a.map(d=>{if(d.value===0)return null;const h=u-d.value/r*u,s=`${u-h} ${h}`,w=p/r*360;return p+=d.value,e.jsx("circle",{className:`${Xe[d.name]} transition-all duration-500 ease-out`,strokeWidth:c,fill:"transparent",r:l,cx:i/2,cy:i/2,strokeDasharray:s,style:{transform:`rotate(${w}deg)`,transformOrigin:"50% 50%"},strokeLinecap:"butt"},d.name)})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-4xl font-bold text-gray-800 dark:text-gray-100",children:r}),e.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:g("job_tracker.total")})]})]})},yt=({applications:a})=>{const{t:g}=z(),i=o.useMemo(()=>{const c={"To Apply":0,Applied:0,Interviewing:0,Offered:0,Rejected:0};return a.forEach(l=>{c[l.applicationStatus]!==void 0&&c[l.applicationStatus]++}),ae.map(l=>({name:l,value:c[l]}))},[a]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:g("job_tracker.status_overview")}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[e.jsx(Qe,{data:i}),e.jsx("div",{className:"flex-grow grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 w-full",children:i.map(c=>e.jsxs("div",{className:"text-center p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c.name}),e.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mt-1",children:c.value}),e.jsx("div",{className:`h-1.5 w-12 mx-auto mt-2 rounded-full ${qe[c.name]}`})]},c.name))})]})]})},ue=({value:a,options:g,onSave:i,placeholder:c,className:l})=>{const[u,r]=o.useState(!1),p=o.useRef(null);return o.useEffect(()=>{u&&p.current?.focus()},[u]),u?e.jsxs("select",{ref:p,value:a||"",onChange:d=>{i(d.target.value),r(!1)},onBlur:()=>r(!1),className:`${l} cursor-pointer`,children:[e.jsx("option",{value:"",disabled:!0,children:c}),g.map(d=>e.jsx("option",{value:d,children:d},d))]}):e.jsx("span",{onClick:d=>{d.stopPropagation(),r(!0)},className:`${l} cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600`,children:a||c})},Ye=({job:a,onClick:g,onUpdate:i})=>{const c=l=>{l.dataTransfer.setData("application/job-id",a.id),l.stopPropagation()};return e.jsxs("div",{draggable:!0,onDragStart:c,onClick:g,className:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 hover:shadow-md hover:border-primary-400 dark:hover:border-primary-500 transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-200 dark:bg-gray-600 rounded-md flex items-center justify-center",children:e.jsx(pe,{size:18,className:"text-gray-500 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h4",{className:"font-bold text-md text-gray-900 dark:text-gray-100",children:a.jobTitle}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.companyName})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 text-xs",children:[e.jsx(ue,{value:a.workModel||"",options:xe,onSave:l=>i(a.id,{workModel:l}),placeholder:"Work Model",className:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300 px-2 py-1 rounded-md font-semibold"}),e.jsx(ue,{value:a.interviewStage||"",options:["Screening Call","Hiring Manager","Technical Round","Final Round"],onSave:l=>i(a.id,{interviewStage:l}),placeholder:"Interview Stage",className:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-300 px-2 py-1 rounded-md font-semibold"})]})]})},Ze={"To Apply":"bg-gray-500",Applied:"bg-blue-500",Interviewing:"bg-yellow-500",Offered:"bg-green-500",Rejected:"bg-red-500"},et=({status:a,applications:g,onCardClick:i,onUpdateApplication:c,onDragOver:l,onDrop:u,onDragLeave:r,isDragOver:p})=>e.jsxs("div",{className:`flex-1 min-w-[300px] bg-gray-100 dark:bg-gray-800/50 rounded-lg p-4 transition-colors ${p?"bg-primary-100 dark:bg-primary-900/30":""}`,onDragOver:l,onDrop:u,onDragLeave:r,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${Ze[a]}`}),e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-200",children:a}),e.jsx("span",{className:"text-sm font-semibold bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full px-2 py-0.5",children:g.length})]}),e.jsx("div",{className:"space-y-4",children:g.map(d=>e.jsx(Ye,{job:d,onClick:()=>i(d),onUpdate:(h,s)=>c(h,s)},d.id))})]}),jt=({applications:a,onCardClick:g,onUpdateApplication:i})=>{const{t:c}=z(),[l,u]=o.useState(null),r=(p,d)=>{p.preventDefault();const h=p.dataTransfer.getData("application/job-id");h&&i(h,{applicationStatus:d}),u(null)};return e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-4",children:ae.map(p=>e.jsx(et,{status:p,applications:a.filter(d=>d.applicationStatus===p),onCardClick:g,onUpdateApplication:i,onDragOver:d=>{d.preventDefault(),u(p)},onDrop:d=>r(d,p),onDragLeave:()=>u(null),isDragOver:l===p},p))})};export{ft as J,jt as K,yt as S};
