const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AIImageEditModal-DWNIAdtd.js","assets/main-Bi0Ei0w3.js","assets/index-DcFGchuU.js","assets/geminiService-BYmLfnZm.js","assets/storageService-aG5r1rUc.js","assets/sparkles-DKtVAHMK.js","assets/x-BVB0Dpji.js","assets/upload-B4M7IYxU.js","assets/check-B3yF-HgQ.js","assets/wand-2-DAhyBf_Z.js","assets/download-D6SFpw_f.js"])))=>i.map(i=>d[i]);
import{f as Y,g as Z,m as ee,e as te,T as re,r as h,j as e,Z as ae,R as $,O as B,P as L,Q as G,V as W,_ as se,U as ne,F as oe}from"./main-Bi0Ei0w3.js";import{D as q}from"./types-C3IBSKjb.js";import{S as K,a as ie,T as le,b as de}from"./thumbs-up-DIZO9jd_.js";import{X as ce}from"./x-BVB0Dpji.js";import{P as ge}from"./palette-CgeLfhC3.js";import{P as V}from"./pen-BDBs_6MJ.js";import{T as me}from"./trash-2-DdUTv7KT.js";import{U as H}from"./upload-B4M7IYxU.js";import{W as xe}from"./wand-2-DAhyBf_Z.js";import{M as pe}from"./more-vertical-5K-OMTGr.js";import{E as ue}from"./eye-Ks_VpovG.js";import{M as he}from"./mail-TURoK-Rd.js";import{C as be}from"./calendar-CutJ-oMs.js";import{C as fe}from"./clock-D1CHQ9zP.js";import{S as ye}from"./star-DKH07wdV.js";const P=async(d,x)=>{const b=Y(Z,"users",d,"pipelineSettings","default");await te(b,{...x,updatedAt:re.now()},{merge:!0})},ve=async d=>{const x=Y(Z,"users",d,"pipelineSettings","default"),b=await ee(x);return b.exists()?b.data():null},je=$.lazy(()=>se(()=>import("./AIImageEditModal-DWNIAdtd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),we=[{id:"none",name:"None",preview:null},{id:"gradient",name:"Gradient Waves",preview:"/backgrounds/pipeline_bg_gradient.png"},{id:"geometric",name:"Geometric",preview:"/backgrounds/pipeline_bg_geometric.png"},{id:"mountains",name:"Mountains",preview:"/backgrounds/pipeline_bg_mountains.png"},{id:"abstract",name:"Abstract Waves",preview:"/backgrounds/pipeline_bg_abstract.png"},{id:"particles",name:"Network",preview:"/backgrounds/pipeline_bg_particles.png"}],J=[{id:"blue",name:"Blue",header:"bg-blue-500"},{id:"purple",name:"Purple",header:"bg-purple-500"},{id:"indigo",name:"Indigo",header:"bg-indigo-500"},{id:"orange",name:"Orange",header:"bg-orange-500"},{id:"pink",name:"Pink",header:"bg-pink-500"},{id:"emerald",name:"Emerald",header:"bg-emerald-500"},{id:"green",name:"Green",header:"bg-green-500"},{id:"red",name:"Red",header:"bg-red-500"},{id:"yellow",name:"Yellow",header:"bg-yellow-500"},{id:"teal",name:"Teal",header:"bg-teal-500"},{id:"cyan",name:"Cyan",header:"bg-cyan-500"},{id:"gray",name:"Gray",header:"bg-gray-500"}],ke=({currentBackground:d,currentStages:x,currentTransparency:b,customBackgroundUrl:y,userId:u,onBackgroundChange:c,onStagesChange:k,onTransparencyChange:v,onCustomBackgroundChange:g,onClose:N})=>{const[j,S]=h.useState(x),[w,o]=h.useState(null),[m,C]=h.useState(""),[i,l]=h.useState(""),[T,D]=h.useState(b),[E,R]=h.useState(!1),[U,_]=h.useState(!1),A=()=>{const t={id:`custom_${Date.now()}`,name:"New Stage",order:j.length,color:"gray",isCustom:!0},n=[...j,t];S(n),k(n)},I=t=>{if(confirm('Remove this stage? Applications in this stage will move to "New".')){const n=j.filter(s=>s.id!==t);S(n),k(n)}},F=(t,n)=>{const s=j.map(f=>f.id===t?{...f,...n}:f);S(s),k(s)},O=()=>{w&&(F(w,{name:m,color:i}),o(null))},M=t=>{D(t),v(t)},a=async t=>{const n=t.target.files?.[0];if(n){R(!0);try{const s=B(L,`pipeline-backgrounds/${u}/${Date.now()}_${n.name}`);await G(s,n);const f=await W(s);g(f),c("custom")}catch(s){console.error("Failed to upload background:",s),alert("Failed to upload background. Please try again.")}finally{R(!1)}}},r=()=>{confirm("Remove custom background?")&&(g(null),c("none"))},p=async t=>{R(!0);try{const n=await fetch(t).then(z=>z.blob()),s=B(L,`pipeline-backgrounds/${u}/ai_edited_${Date.now()}.png`);await G(s,n);const f=await W(s);g(f),c("custom"),_(!1)}catch(n){console.error("Failed to save AI-edited background:",n),alert("Failed to save edited background.")}finally{R(!1)}};return e.jsxs("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(K,{className:"text-purple-600",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Pipeline Settings"})]}),e.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(ce,{size:24,className:"text-gray-500"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(ge,{size:20,className:"text-purple-600"}),"Background Theme"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:we.map(t=>e.jsxs("button",{onClick:()=>c(t.id),className:`relative rounded-lg overflow-hidden border-2 transition-all transform hover:scale-105 ${d===t.id?"border-purple-600 ring-4 ring-purple-200 dark:ring-purple-900/50":"border-gray-200 dark:border-gray-600 hover:border-purple-300"}`,children:[t.preview?e.jsx("img",{src:t.preview,alt:t.name,className:"w-full h-28 object-cover"}):e.jsx("div",{className:"w-full h-28 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No Background"})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent text-white text-sm py-2 px-3 font-medium",children:t.name}),d===t.id&&e.jsx("div",{className:"absolute top-2 right-2 bg-purple-600 text-white rounded-full p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},t.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(V,{size:20,className:"text-purple-600"}),"Pipeline Stages"]}),e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(ae,{size:18}),"Add Stage"]})]}),e.jsx("div",{className:"space-y-3",children:j.map((t,n)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-sm font-medium text-gray-600 dark:text-gray-300",children:n+1}),e.jsx("div",{className:`flex-shrink-0 w-12 h-8 rounded ${J.find(s=>s.id===t.color)?.header||"bg-gray-500"}`}),e.jsx("div",{className:"flex-1",children:w===t.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:m,onChange:s=>C(s.target.value),className:"w-full px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-white outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Stage name"}),e.jsx("select",{value:i,onChange:s=>l(s.target.value),className:"w-full px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-white outline-none focus:ring-2 focus:ring-purple-500",children:J.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}):e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.isCustom&&e.jsx("span",{className:"text-purple-600",children:"Custom • "}),t.isTerminal&&e.jsx("span",{children:"Terminal Stage"})]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:w===t.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:O,className:"px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Save"}),e.jsx("button",{onClick:()=>o(null),className:"px-3 py-1.5 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-200 rounded hover:bg-gray-400 dark:hover:bg-gray-500 text-sm",children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{o(t.id),C(t.name),l(t.color)},className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",title:"Edit stage",children:e.jsx(V,{size:16,className:"text-gray-600 dark:text-gray-400"})}),t.isCustom&&e.jsx("button",{onClick:()=>I(t.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Remove stage",children:e.jsx(me,{size:16,className:"text-red-600"})})]})})]},t.id))}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:[e.jsx("strong",{children:"Tip:"})," Click Edit to rename stages or change colors. Custom stages can be removed."]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(ie,{size:20,className:"text-purple-600"}),"Column Transparency"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:T,onChange:t=>M(Number(t.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-purple-600"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Opaque (0%)"}),e.jsxs("span",{className:"font-medium text-purple-600",children:[T,"% Transparent"]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Transparent (100%)"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Adjust transparency to see the background through the columns. Higher values make columns more transparent."})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(H,{size:20,className:"text-purple-600"}),"Custom Background"]}),e.jsxs("div",{className:"space-y-3",children:[y&&d==="custom"&&e.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-gray-300 dark:border-gray-600",children:[e.jsx("img",{src:y,alt:"Custom background",className:"w-full h-40 object-cover"}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsxs("button",{onClick:()=>_(!0),className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg flex items-center gap-1 text-sm hover:bg-blue-700 shadow-lg",disabled:E,children:[e.jsx(xe,{size:14}),"Edit with AI"]}),e.jsx("button",{onClick:r,className:"px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 shadow-lg",disabled:E,children:"Remove"})]})]}),e.jsxs("label",{className:"cursor-pointer block",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:a,className:"hidden",disabled:E}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-purple-500 dark:hover:border-purple-400 transition-colors bg-gray-50 dark:bg-gray-900/50",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mx-auto mb-2 text-gray-400",size:32}),e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Upload Custom Background"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Recommended: 1920x1080px • PNG, JPG"})]})})]})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-6 flex justify-end",children:e.jsx("button",{onClick:N,className:"px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Done"})})]}),U&&y&&e.jsx($.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:e.jsx("div",{className:"text-white",children:"Loading AI Editor..."})}),children:e.jsx(je,{userId:u,currentPhoto:y,onSave:t=>{g(t),_(!1)},onUseTemp:t=>{p(t)},onClose:()=>_(!1),onError:(t,n)=>{console.error(t,n),alert(`${t}: ${n}`)},savePath:`pipeline-backgrounds/${u}/ai_edited_${Date.now()}.png`})})]})},Ne=({application:d,candidateName:x,candidateEmail:b,onViewResume:y,onQuickAction:u,onDragStart:c,matchScore:k})=>{const[v,g]=$.useState(!1),N=$.useRef(null);h.useEffect(()=>{const o=m=>{N.current&&!N.current.contains(m.target)&&g(!1)};return v&&document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[v]);const j=o=>{if(!o)return"N/A";const m=o.toDate?o.toDate():new Date(o),i=new Date().getTime()-m.getTime(),l=Math.floor(i/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:m.toLocaleDateString()},S=o=>o?e.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(m=>e.jsx(ye,{size:12,className:m<=o?"text-yellow-400 fill-yellow-400":"text-gray-300"},m))}):null,w=o=>o?o>=80?"bg-green-100 text-green-700":o>=60?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700":"bg-gray-100 text-gray-600";return e.jsxs("div",{draggable:!0,onDragStart:c,onDoubleClick:y,className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-3 cursor-grab active:cursor-grabbing hover:shadow-md transition-all group select-none",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold",children:x.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 dark:text-white truncate max-w-[120px]",children:x}),b&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-[120px]",children:b})]})]}),e.jsxs("div",{className:"relative",ref:N,children:[e.jsx("button",{onClick:()=>g(!v),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(pe,{size:14,className:"text-gray-500"})}),v&&e.jsxs("div",{className:"absolute right-0 top-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-10 min-w-[140px]",children:[e.jsxs("button",{onClick:()=>{y(),g(!1)},className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(ue,{size:14})," View Resume"]}),e.jsxs("button",{onClick:()=>{u("email"),g(!1)},className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(he,{size:14})," Send Email"]}),e.jsxs("button",{onClick:()=>{u("schedule"),g(!1)},className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(be,{size:14})," Schedule"]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 my-1"}),e.jsxs("button",{onClick:()=>{u("advance"),g(!1)},className:"w-full text-left px-3 py-1.5 text-sm text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 flex items-center gap-2",children:[e.jsx(le,{size:14})," Advance"]}),e.jsxs("button",{onClick:()=>{u("reject"),g(!1)},className:"w-full text-left px-3 py-1.5 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[e.jsx(de,{size:14})," Reject"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[k&&e.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${w(k)}`,children:[k,"% Match"]}),S(d.rating)]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{size:12}),e.jsx("span",{children:j(d.appliedAt)})]}),e.jsxs("button",{onClick:y,className:"flex items-center gap-1 text-primary-600 hover:text-primary-700",children:[e.jsx(oe,{size:12}),"Resume"]})]})]})},Se=({stage:d,applications:x,candidateNames:b,onViewResume:y,onUpdateStatus:u,onDragOver:c,onDrop:k,isDropTarget:v,transparency:g,onEmailAction:N,onScheduleAction:j,onEditStage:S,onRemoveStage:w})=>{const m=(i=>{const l={blue:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",header:"bg-blue-500"},purple:{bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-700",header:"bg-purple-500"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-700",header:"bg-indigo-500"},orange:{bg:"bg-orange-50",border:"border-orange-200",text:"text-orange-700",header:"bg-orange-500"},pink:{bg:"bg-pink-50",border:"border-pink-200",text:"text-pink-700",header:"bg-pink-500"},emerald:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",header:"bg-emerald-500"},green:{bg:"bg-green-50",border:"border-green-200",text:"text-green-700",header:"bg-green-500"},red:{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",header:"bg-red-500"}};return l[i]||l.blue})(d.color),C=(i,l)=>{if(l==="advance"){const T=q.find(D=>D.order===d.order+1);T&&u(i.id,T.id)}else l==="reject"?u(i.id,"rejected"):l==="email"?N(i):l==="schedule"&&j(i)};return e.jsxs("div",{className:`flex-1 min-w-[280px] max-w-[320px] rounded-xl overflow-hidden transition-all flex flex-col ${v?"ring-2 ring-primary-500 ring-offset-2":""}`,onDragOver:c,onDrop:i=>k(i,d.id),children:[e.jsx("div",{className:`${m.header} px-4 py-3 flex items-center justify-between`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-white",children:d.name}),e.jsx("span",{className:"bg-white/20 text-white text-xs px-2 py-0.5 rounded-full",children:x.length})]})}),e.jsx("div",{className:`${m.bg} dark:bg-gray-900 p-3 flex-1 overflow-y-auto space-y-3`,style:{backgroundColor:g>0?`rgba(255, 255, 255, ${1-g/100})`:void 0,backdropFilter:g>20?"blur(10px)":void 0},children:x.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400 dark:text-gray-600",children:[e.jsx(ne,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No candidates"})]}):x.map(i=>e.jsx(Ne,{application:i,candidateName:b[i.applicantUserId]||"Unknown",onViewResume:()=>y(i),onQuickAction:l=>C(i,l),onDragStart:l=>{l.dataTransfer.setData("application/json",JSON.stringify({appId:i.id,fromStage:d.id}))},matchScore:i.matchAnalysis?.matchPercentage},i.id))})]})},Be=({applications:d,candidateNames:x,candidateEmails:b,onViewResume:y,onUpdateStatus:u,userId:c})=>{const[k,v]=h.useState(null),[g,N]=h.useState(!1),[j,S]=h.useState("none"),[w,o]=h.useState(q),[m,C]=h.useState(0),[i,l]=h.useState();h.useEffect(()=>{c&&(async()=>{try{const r=await ve(c);r&&(r.backgroundTheme&&S(r.backgroundTheme),r.customStages&&r.customStages.length>0&&o(r.customStages),r.customBackgroundUrl&&l(r.customBackgroundUrl),C(r.columnTransparency??0))}catch(r){console.error("Failed to load pipeline settings:",r)}})()},[c]);const T=a=>({submitted:"new",reviewing:"screening",shortlisted:"phone_screen",interviewing:"interview",accepted:"hired"})[a]||a,D=$.useMemo(()=>{const a={};return w.forEach(r=>{a[r.id]=[]}),d.forEach(r=>{const p=T(r.status||"new");a[p]?a[p].push(r):a.new?.push(r)}),a},[d,w]),E=(a,r)=>{a.preventDefault(),v(r)},R=()=>{v(null)},U=(a,r)=>{a.preventDefault(),v(null);try{const p=JSON.parse(a.dataTransfer.getData("application/json")),{appId:t,fromStage:n}=p;n!==r&&u(t,r)}catch(p){console.error("Failed to process drop:",p)}},_=async a=>{if(S(a),a!=="none"&&m===0){C(70);try{await P(c,{backgroundTheme:a,columnTransparency:70})}catch(r){console.error("Failed to save settings:",r)}}else try{await P(c,{backgroundTheme:a})}catch(r){console.error("Failed to save background theme:",r)}},A=async a=>{o(a);try{await P(c,{customStages:a})}catch(r){console.error("Failed to save custom stages:",r)}},I=async a=>{C(a);try{await P(c,{columnTransparency:a})}catch(r){console.error("Failed to save transparency:",r)}},F=async a=>{l(a||void 0);try{await P(c,{customBackgroundUrl:a||void 0})}catch(r){console.error("Failed to save custom background:",r)}},O=(a,r)=>{if(a==="none")return{};let p="";if(a==="custom"&&r)p=r;else if(a!=="custom")p=`/backgrounds/pipeline_bg_${a}.png`;else return{};return{backgroundImage:`url(${p})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},M=w.filter(a=>!a.isTerminal||D[a.id]?.length>0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors shadow-sm",children:[e.jsx(K,{size:18}),e.jsx("span",{className:"font-medium",children:"Pipeline Settings"})]})}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 px-2 h-full min-h-[calc(100vh-300px)] rounded-lg transition-all duration-300",style:O(j,i),onDragLeave:R,children:M.map(a=>e.jsx(Se,{stage:a,applications:D[a.id]||[],candidateNames:x,onViewResume:y,onUpdateStatus:u,onDragOver:r=>E(r,a.id),onDrop:U,isDropTarget:k===a.id,transparency:m,onEmailAction:r=>{const p=x[r.applicantUserId]||"Candidate",t=b[r.applicantUserId];if(!t){alert("No email found for this candidate");return}const n=encodeURIComponent("Interview Invitation"),s=encodeURIComponent(`Dear ${p},

We are pleased to invite you for an interview for the position you applied for.

We look forward to speaking with you.

Best regards`),f=`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(t)}&su=${n}&body=${s}`;console.log("Opening Gmail web client:",f),window.open(f,"_blank")},onScheduleAction:r=>{const p=x[r.applicantUserId]||"Candidate",t=b[r.applicantUserId];if(!t){alert("No email found for this candidate");return}const n=new Date,s=new Date(n);s.setDate(s.getDate()+1),s.setHours(10,0,0,0);const f=new Date(s);f.setHours(11,0,0,0);const z=Q=>Q.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",X=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(`Interview with ${p}`)}&dates=${z(s)}/${z(f)}&details=${encodeURIComponent("Interview scheduled via CareerVivid")}&add=${encodeURIComponent(t)}`;window.open(X,"_blank")}},a.id))}),g&&e.jsx(ke,{currentBackground:j,currentStages:w,currentTransparency:m,customBackgroundUrl:i,userId:c,onBackgroundChange:_,onStagesChange:A,onTransparencyChange:I,onCustomBackgroundChange:F,onClose:()=>N(!1)})]})};export{Be as default};
