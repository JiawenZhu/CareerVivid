const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/eye-off-BT8a98df.js","assets/main-Bi0Ei0w3.js"])))=>i.map(i=>d[i]);
import{r as n,j as e,a as J,C as Q,_ as A,b as v,p as X,L as Z,c as ee,d as te,T as D,e as F,f as z,g as j,h as M,t as _,k as ae,l as re,m as se,q as oe,n as ie,w as B,o as ne}from"./main-Bi0Ei0w3.js";import{u as le}from"./useTranslation-B90S8UVY.js";import{A as ce}from"./arrow-left-TCHtPuDE.js";import{M as de}from"./mail-TURoK-Rd.js";import{L as ue}from"./lock-U6skUTSX.js";import{E as me}from"./eye-off-BT8a98df.js";import{E as he}from"./eye-Ks_VpovG.js";const ke=()=>{const{t:r}=le(),[N,W]=n.useState(""),[S,q]=n.useState(""),[w,V]=n.useState(!1),[P,c]=n.useState(""),[T,L]=n.useState(""),[g,d]=n.useState(!1),[C,U]=n.useState(0),R=[r("auth.loading_secure"),r("auth.loading_process"),r("auth.loading_ready"),r("auth.loading_moment")];n.useEffect(()=>{let a;return g&&(U(0),a=window.setInterval(()=>{U(t=>t>=R.length-1?t:t+1)},1800)),()=>clearInterval(a)},[g]);const E=a=>{switch(a.code){case"auth/email-already-in-use":c(r("auth.error_exists"));break;case"auth/weak-password":c(r("auth.error_weak"));break;case"auth/popup-closed-by-user":break;case"auth/account-exists-with-different-credential":c(r("auth.error_diff_cred"));break;default:c(a.message.replace("Firebase: ",""));break}};n.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("ref");t&&localStorage.setItem("careervivid_referral",t)},[]);const b=()=>localStorage.getItem("careervivid_referral")||void 0,I=async a=>{try{const t=oe(ie(j,"users"),B("referralCode","==",a),B("role","==","academic_partner")),s=await ne(t);if(!s.empty)return s.docs[0].id}catch(t){console.error("Error looking up referral code:",t)}return null},$=async a=>{a.preventDefault(),d(!0),c(""),L("");try{const t=await ee(v,N,S),s={url:window.location.href.split("#")[0]};await te(t.user,s);const i=b();let u,o=!1;i&&(u=await I(i),u&&(o=!0));const l=o?D.fromDate(new Date(Date.now()+720*60*60*1e3)):void 0,h=new URLSearchParams(window.location.search).get("source");await F(z(j,"users",t.user.uid),{uid:t.user.uid,email:t.user.email,createdAt:M(),promotions:{},status:"active",...i?{referredBy:i}:{},...u?{academicPartnerId:u}:{},...h?{source:h}:{},...o?{plan:"pro_sprint",expiresAt:l}:{}}),_(t.user.uid,"sign_in",{signup:!0});const x=new URLSearchParams(window.location.search).get("redirect");x&&(window.location.href=decodeURIComponent(x))}catch(t){E(t),d(!1)}},O=async()=>{d(!0),c(""),L("");try{const t=(await ae(v,re)).user,s=z(j,"users",t.uid);if((await se(s)).exists())_(t.uid,"sign_in",{provider:"google"});else{const l=b();let m,h=!1;l&&(m=await I(l),m&&(h=!0));const p=h?D.fromDate(new Date(Date.now()+720*60*60*1e3)):void 0,f=new URLSearchParams(window.location.search).get("source");await F(s,{uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,createdAt:M(),promotions:{},status:"active",...l?{referredBy:l}:{},...m?{academicPartnerId:m}:{},...f?{source:f}:{},...h?{plan:"pro_sprint",expiresAt:p}:{}}),_(t.uid,"sign_in",{signup:!0,provider:"google"})}const o=new URLSearchParams(window.location.search).get("redirect");o&&(window.location.href=decodeURIComponent(o))}catch(a){E(a),d(!1)}},G=()=>e.jsxs("div",{className:"fixed inset-0 bg-white/80 dark:bg-gray-950/80 backdrop-blur-sm z-50 flex flex-col items-center justify-center text-center p-4 animate-fade-in",children:[e.jsx(Z,{className:"w-16 h-16 text-primary-600 animate-spin mx-auto"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-6",children:r("auth.please_wait")}),e.jsx("div",{className:"h-6 mt-2",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400 animate-fade-in font-medium",children:R[C]},C)})]}),H=()=>{d(!0);const a=Math.random().toString(36).substring(7);localStorage.setItem("tiktok_node_auth_state",a),new URLSearchParams(window.location.search).get("source")==="bio-link"&&localStorage.setItem("tiktok_auth_context","bio-link");const s="aw1crl350g7yvps2",i=`${window.location.origin}/signup`,o=`https://www.tiktok.com/v2/auth/authorize/?client_key=${s}&response_type=code&scope=user.info.basic,user.info.profile,user.info.stats,video.list&redirect_uri=${encodeURIComponent(i)}&state=${a}`;window.location.href=o};n.useEffect(()=>{const a=new URLSearchParams(window.location.search),t=a.get("code"),s=a.get("state"),i=localStorage.getItem("tiktok_node_auth_state");t&&s&&i&&s===i&&(async()=>{d(!0);try{const{getFunctions:o,httpsCallable:l}=await A(async()=>{const{getFunctions:y,httpsCallable:k}=await import("./eye-off-BT8a98df.js").then(Y=>Y.b);return{getFunctions:y,httpsCallable:k}},__vite__mapDeps([0,1])),m=o(),p=await l(m,"authWithTikTok")({code:t,redirectUri:`${window.location.origin}/signup`}),{token:x}=p.data,{signInWithCustomToken:f}=await A(async()=>{const{signInWithCustomToken:y}=await import("./eye-off-BT8a98df.js").then(k=>k.i);return{signInWithCustomToken:y}},__vite__mapDeps([0,1]));await f(v,x),localStorage.removeItem("tiktok_node_auth_state"),X("/dashboard")}catch(o){console.error("TikTok Auth Failed:",o),c("TikTok Sign Up failed. Please try again."),d(!1)}})()},[]);const K=new URLSearchParams(window.location.search).get("source")==="bio-link"||localStorage.getItem("tiktok_auth_context")==="bio-link";return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-950 px-4 relative overflow-hidden font-sans",children:[e.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full max-w-7xl pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-96 h-96 bg-primary-400/20 rounded-full blur-3xl mix-blend-multiply dark:mix-blend-screen opacity-50"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-purple-400/20 rounded-full blur-3xl mix-blend-multiply dark:mix-blend-screen opacity-50"})]}),g&&e.jsx(G,{}),e.jsxs("a",{href:new URLSearchParams(window.location.search).get("source")==="bio-link"?"/bio-links":"/",className:"absolute top-8 left-8 z-20 flex items-center gap-2 text-sm font-semibold text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors",children:[e.jsx(ce,{size:18}),r("auth.back_home")]}),e.jsx("div",{className:"w-full max-w-md relative z-10",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl shadow-2xl shadow-gray-200/50 dark:shadow-none border border-gray-100 dark:border-gray-800 p-8 sm:p-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx(J,{className:"h-10 w-10 mx-auto mb-6"}),new URLSearchParams(window.location.search).get("source")==="bio-link"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Create your Bio-Link Account"}),e.jsx("p",{className:"mt-3 text-gray-500 dark:text-gray-400",children:"Sign up to claim your unique URL and start sharing."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:r("auth.create_account")}),e.jsx("p",{className:"mt-3 text-gray-500 dark:text-gray-400",children:r("auth.start_building")})]}),b()&&e.jsx("div",{className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-yellow-100 to-yellow-50 dark:from-yellow-900/30 dark:to-yellow-800/20 rounded-full",children:e.jsx("span",{className:"text-sm font-semibold text-yellow-800 dark:text-yellow-300",children:"ðŸŽ Referral code applied! You'll get 1-Month Free Premium (300 AI credits/month)"})})]}),e.jsxs("form",{className:"space-y-5",onSubmit:$,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:r("auth.email_label")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(de,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"block w-full pl-11 pr-4 py-3.5 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all text-sm font-medium",placeholder:r("auth.email_placeholder"),value:N,onChange:a=>W(a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:r("auth.password_label")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(ue,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:w?"text":"password",required:!0,className:"block w-full pl-11 pr-11 py-3.5 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all text-sm font-medium",placeholder:r("auth.password_placeholder"),value:S,onChange:a=>q(a.target.value)}),e.jsx("button",{type:"button",onClick:()=>V(!w),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:w?e.jsx(me,{size:20}):e.jsx(he,{size:20})})]})]}),P&&e.jsx("div",{className:"p-3 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center font-medium",children:P})}),T&&e.jsx("div",{className:"p-3 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-100 dark:border-green-800",children:e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 text-center font-medium",children:T})}),e.jsx("button",{type:"submit",disabled:g,className:"w-full flex justify-center py-3.5 px-4 border border-transparent rounded-xl shadow-lg shadow-primary-500/20 text-sm font-bold text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-70 disabled:cursor-not-allowed transition-all transform hover:-translate-y-0.5",children:r("auth.create_account_btn")})]}),e.jsxs("div",{className:"my-8 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:e.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-800"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-white dark:bg-gray-900 text-gray-500 font-medium",children:r("auth.or_continue_with")})})]}),e.jsxs("div",{className:"space-y-3",children:[K&&e.jsxs("button",{onClick:H,disabled:g,className:"w-full flex items-center justify-center gap-3 py-3.5 px-4 rounded-xl shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] bg-[#FE2C55] text-white text-sm font-black uppercase border-2 border-black hover:translate-y-[2px] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all",children:[e.jsx("svg",{className:"w-5 h-5 fill-current",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M448 209.91a210.06 210.06 0 0 1-122.77-39.25V349.38A162.55 162.55 0 1 1 185 188.31V278.2a74.62 74.62 0 1 0 52.23 71.18V0l88 0a121.18 121.18 0 0 0 1.86 22.17h0A122.18 122.18 0 0 0 381 102.39a121.43 121.43 0 0 0 67 20.14z"})}),"Continue with TikTok"]}),e.jsxs("button",{onClick:O,disabled:g,className:"w-full flex items-center justify-center gap-3 py-3.5 px-4 border border-gray-200 dark:border-gray-700 rounded-xl shadow-sm bg-white dark:bg-gray-800 text-sm font-bold text-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-all",children:[e.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 381.5 512 244 512 111.8 512 0 398.2 0 256S111.8 0 244 0c71.2 0 130.9 27.8 176.9 72.9l-63.1 61.3C294.3 93.6 270.3 80 244 80 158.4 80 90 148.2 90 233.9s68.4 153.9 154 153.9c75.5 0 120.9-42.3 124.9-97.9H244v-77.3h236.1c2.4 12.7 3.9 26.1 3.9 40.2z"})}),r("auth.google")]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r("auth.already_have_account")," ",e.jsxs("a",{href:"/signin",className:"font-bold text-primary-600 hover:text-primary-700 transition-colors inline-flex items-center gap-1",children:[r("auth.log_in")," ",e.jsx(Q,{size:14})]})]})})]})})]})};export{ke as default};
